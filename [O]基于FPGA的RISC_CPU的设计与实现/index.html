<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>【O】基于FPGA的RISC_CPU的设计与实现 | MengZeATY</title>
  <meta name="description" content="基于FPGA的RISC_CPU的设计与实现">
<meta name="keywords" content="mengze,梦泽,Verilog,FPGA,RISC,CPU">
<meta property="og:type" content="article">
<meta property="og:title" content="【O】基于FPGA的RISC_CPU的设计与实现">
<meta property="og:url" content="https://mengze.top/[O]基于FPGA的RISC_CPU的设计与实现/index.html">
<meta property="og:site_name" content="Meng Ze">
<meta property="og:description" content="基于FPGA的RISC_CPU的设计与实现">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/11.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/12.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/13.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/21.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/22.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/31.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/32.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/33.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/34.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/35.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/36.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/37.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/41.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/42.png">
<meta property="og:updated_time" content="2020-08-02T06:37:28.850Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【O】基于FPGA的RISC_CPU的设计与实现">
<meta name="twitter:description" content="基于FPGA的RISC_CPU的设计与实现">
<meta name="twitter:image" content="https://mengze.top/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/11.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://mengze.top/[O]基于FPGA的RISC_CPU的设计与实现/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Meng Ze" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/MZ_White.png" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css">
  
  
  
    <link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet">
  
  
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://mengze.top">
          <img class="img-circle img-rotate" src="/images/head.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">MengZeATY</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Dream Founder &amp; Creator</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Qingdao, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-emotion">
          <a href="/[S]心情随笔/">
            
            <i class="icon icon-jiaju"></i>
            
            <span class="menu-title">随笔</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-essay">
          <a href="/[S]手记编程设计/">
            
            <i class="icon icon-time"></i>
            
            <span class="menu-title">手记</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tools">
          <a href="/[O]小工具集/">
            
            <i class="icon icon-plus"></i>
            
            <span class="menu-title">工具</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-resume">
          <a href="/sourcefile/Resume/resume.html">
            
            <i class="icon icon-starfish"></i>
            
            <span class="menu-title">简历</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-more"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/AaronTYin" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/6148427895" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <b>　　网站全面改版进行中，自此所有内容的首发均放于本站，更新动态发布于微博-<a href="https://weibo.com/7489247069" target="_blank" style="color:darkorchid;">MengZeATY</a>，视频依托于BiliBili-<a href="https://space.bilibili.com/270805824/" target="_blank" style="color:darkorchid;">MengZeATY</a>，感谢大家的支持和等待，mengze.top即将开启新的征程，希望为大家带来更加完善的精彩。</b>
            </div>
        </div>
    </div>
</div>

    
      

    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FPGA/">FPGA</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web开发/">Web开发</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/书影感评/">书影感评</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图影设计/">图影设计</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基本学识/">基本学识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生物医学/">生物医学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/站内页面/">站内页面</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程算法/">编程算法</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自然科学/">自然科学</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语言积累/">语言积累</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔短文/">随笔短文</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/FPGA/" style="font-size: 13.63px;">FPGA</a> <a href="/tags/Web开发/" style="font-size: 13.63px;">Web开发</a> <a href="/tags/书影感评/" style="font-size: 13.38px;">书影感评</a> <a href="/tags/图影设计/" style="font-size: 14px;">图影设计</a> <a href="/tags/基本学识/" style="font-size: 13px;">基本学识</a> <a href="/tags/嵌入式/" style="font-size: 13.25px;">嵌入式</a> <a href="/tags/生物医学/" style="font-size: 13.13px;">生物医学</a> <a href="/tags/站内页面/" style="font-size: 13.63px;">站内页面</a> <a href="/tags/编程算法/" style="font-size: 13.88px;">编程算法</a> <a href="/tags/自然科学/" style="font-size: 13.75px;">自然科学</a> <a href="/tags/语言积累/" style="font-size: 13.5px;">语言积累</a> <a href="/tags/随笔短文/" style="font-size: 13.25px;">随笔短文</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/">2026</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">50</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-A"><span class="toc-number">1.</span> <span class="toc-text">Part A</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、实验目的"><span class="toc-number">1.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、实验内容"><span class="toc-number">1.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、实验环境"><span class="toc-number">1.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、实验步骤"><span class="toc-number">1.4.</span> <span class="toc-text">四、实验步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-B"><span class="toc-number">2.</span> <span class="toc-text">Part B</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、实验目的-1"><span class="toc-number">2.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、实验内容-1"><span class="toc-number">2.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、实验环境-1"><span class="toc-number">2.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、实验步骤-1"><span class="toc-number">2.4.</span> <span class="toc-text">四、实验步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-C"><span class="toc-number">3.</span> <span class="toc-text">Part C</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、实验目的-2"><span class="toc-number">3.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、实验内容-2"><span class="toc-number">3.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、实验环境-2"><span class="toc-number">3.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、实验步骤-2"><span class="toc-number">3.4.</span> <span class="toc-text">四、实验步骤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-D"><span class="toc-number">4.</span> <span class="toc-text">Part D</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、实验目的-3"><span class="toc-number">4.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、实验内容-3"><span class="toc-number">4.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、实验环境-3"><span class="toc-number">4.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、实验步骤-3"><span class="toc-number">4.4.</span> <span class="toc-text">四、实验步骤</span></a></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-[O]基于FPGA的RISC_CPU的设计与实现" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      【O】基于FPGA的RISC_CPU的设计与实现
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/[O]基于FPGA的RISC_CPU的设计与实现/" class="article-date">
	  <time datetime="2017-11-05T16:00:00.000Z" itemprop="datePublished">2017-11-06</time>
	</a>
</span>
        
        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/FPGA/">FPGA</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/[O]基于FPGA的RISC_CPU的设计与实现/#comments" class="article-comment-link">评论</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 7.5k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 42(分)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <hr>
<a id="more"></a>
<p>　　<a href="https://github.com/AaronTYin/0-HDL-ComputerForm_lab" target="_blank" rel="external">Github：0-HDL-ComputerForm_lab</a></p>
<h2 id="Part-A"><a href="#Part-A" class="headerlink" title="Part A"></a>Part A</h2><h3 id="一、实验目的"><a href="#一、实验目的" class="headerlink" title="一、实验目的"></a>一、实验目的</h3><p>　　理解并掌握运算器的基本电路结构及其设计方法，学会使用Verilog HDL对电路进行行为建模、结构建模以及仿真测试。</p>
<h3 id="二、实验内容"><a href="#二、实验内容" class="headerlink" title="二、实验内容"></a>二、实验内容</h3><p>　　利用Verilog HDL设计一个运算器模型，并进行仿真测试。要求该运算器的字长为32位，能够实现加法、减法、逻辑与、逻辑或四种运算，并产生N(结果为负)、Z(结果为零)、V(结果溢出)、C(进位)四个标志位。要求采用层次化的建模方法，即先搭建低层模块，然后再逐级搭建高层模块。</p>
<h3 id="三、实验环境"><a href="#三、实验环境" class="headerlink" title="三、实验环境"></a>三、实验环境</h3><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h3 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h3><p><strong>1、电路结构设计</strong><br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/11.png" alt=""><br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/12.png" alt=""><br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/13.png" alt=""><br><strong>2、建立Verilog模型</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> fadd(a,b,s,ci,co);</div><div class="line"><span class="keyword">input</span> a,b,ci;</div><div class="line"><span class="keyword">output</span> s,co;</div><div class="line"><span class="keyword">reg</span> s,co;</div><div class="line"><span class="keyword">always</span> @ (a <span class="keyword">or</span> b <span class="keyword">or</span> ci)</div><div class="line"><span class="keyword">begin</span> </div><div class="line">s&lt;=(a&amp;~b&amp;~ci)|(~a&amp;b&amp;~ci)|(~a&amp;~b&amp;ci)|(a&amp;b&amp;ci);</div><div class="line">co&lt;=(a&amp;b)|(a&amp;ci)|(b&amp;ci);</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> add(a,b,sub,s,c,v,n);</div><div class="line"><span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>]a;</div><div class="line"><span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>]b;</div><div class="line"><span class="keyword">input</span> sub;</div><div class="line"><span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>]s;</div><div class="line"><span class="keyword">output</span> c,v,n;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]b;</div><div class="line"><span class="keyword">wire</span> c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19,c20,c21,c22,c23,c24,c25,c26,c27,c28,c29,c30,c31;</div><div class="line">fadd f0(a[<span class="number">0</span>],b[<span class="number">0</span>]^sub,s[<span class="number">0</span>],sub,c1);</div><div class="line">fadd f1(a[<span class="number">1</span>],b[<span class="number">1</span>]^sub,s[<span class="number">1</span>],c1,c2);</div><div class="line">fadd f2(a[<span class="number">2</span>],b[<span class="number">2</span>]^sub,s[<span class="number">2</span>],c2,c3);</div><div class="line">fadd f3(a[<span class="number">3</span>],b[<span class="number">3</span>]^sub,s[<span class="number">3</span>],c3,c4);</div><div class="line">fadd f4(a[<span class="number">4</span>],b[<span class="number">4</span>]^sub,s[<span class="number">4</span>],c4,c5);</div><div class="line">fadd f5(a[<span class="number">5</span>],b[<span class="number">5</span>]^sub,s[<span class="number">5</span>],c5,c6);</div><div class="line">fadd f6(a[<span class="number">6</span>],b[<span class="number">6</span>]^sub,s[<span class="number">6</span>],c6,c7);</div><div class="line">fadd f7(a[<span class="number">7</span>],b[<span class="number">7</span>]^sub,s[<span class="number">7</span>],c7,c8);</div><div class="line">fadd f8(a[<span class="number">8</span>],b[<span class="number">8</span>]^sub,s[<span class="number">8</span>],c8,c9);</div><div class="line">fadd f9(a[<span class="number">9</span>],b[<span class="number">9</span>]^sub,s[<span class="number">9</span>],c9,c10);</div><div class="line">fadd f10(a[<span class="number">10</span>],b[<span class="number">10</span>]^sub,s[<span class="number">10</span>],c10,c11);</div><div class="line">fadd f11(a[<span class="number">11</span>],b[<span class="number">11</span>]^sub,s[<span class="number">11</span>],c11,c12);</div><div class="line">fadd f12(a[<span class="number">12</span>],b[<span class="number">12</span>]^sub,s[<span class="number">12</span>],c12,c13);</div><div class="line">fadd f13(a[<span class="number">13</span>],b[<span class="number">13</span>]^sub,s[<span class="number">13</span>],c13,c14);</div><div class="line">fadd f14(a[<span class="number">14</span>],b[<span class="number">14</span>]^sub,s[<span class="number">14</span>],c14,c15);</div><div class="line">fadd f15(a[<span class="number">15</span>],b[<span class="number">15</span>]^sub,s[<span class="number">15</span>],c15,c16);</div><div class="line">fadd f16(a[<span class="number">16</span>],b[<span class="number">16</span>]^sub,s[<span class="number">16</span>],c16,c17);</div><div class="line">fadd f17(a[<span class="number">17</span>],b[<span class="number">17</span>]^sub,s[<span class="number">17</span>],c17,c18);</div><div class="line">fadd f18(a[<span class="number">18</span>],b[<span class="number">18</span>]^sub,s[<span class="number">18</span>],c18,c19);</div><div class="line">fadd f19(a[<span class="number">19</span>],b[<span class="number">19</span>]^sub,s[<span class="number">19</span>],c19,c20);</div><div class="line">fadd f20(a[<span class="number">20</span>],b[<span class="number">20</span>]^sub,s[<span class="number">20</span>],c20,c21);</div><div class="line">fadd f21(a[<span class="number">21</span>],b[<span class="number">21</span>]^sub,s[<span class="number">21</span>],c21,c22);</div><div class="line">fadd f22(a[<span class="number">22</span>],b[<span class="number">22</span>]^sub,s[<span class="number">22</span>],c22,c23);</div><div class="line">fadd f23(a[<span class="number">23</span>],b[<span class="number">23</span>]^sub,s[<span class="number">23</span>],c23,c24);</div><div class="line">fadd f24(a[<span class="number">24</span>],b[<span class="number">24</span>]^sub,s[<span class="number">24</span>],c24,c25);</div><div class="line">fadd f25(a[<span class="number">25</span>],b[<span class="number">25</span>]^sub,s[<span class="number">25</span>],c25,c26);</div><div class="line">fadd f26(a[<span class="number">26</span>],b[<span class="number">26</span>]^sub,s[<span class="number">26</span>],c26,c27);</div><div class="line">fadd f27(a[<span class="number">27</span>],b[<span class="number">27</span>]^sub,s[<span class="number">27</span>],c27,c28);</div><div class="line">fadd f28(a[<span class="number">28</span>],b[<span class="number">28</span>]^sub,s[<span class="number">28</span>],c28,c29);</div><div class="line">fadd f29(a[<span class="number">29</span>],b[<span class="number">29</span>]^sub,s[<span class="number">29</span>],c29,c30);</div><div class="line">fadd f30(a[<span class="number">30</span>],b[<span class="number">30</span>]^sub,s[<span class="number">30</span>],c30,c31);</div><div class="line">fadd f31(a[<span class="number">31</span>],b[<span class="number">31</span>]^sub,s[<span class="number">31</span>],c31,c);</div><div class="line"><span class="keyword">assign</span> n=s[<span class="number">31</span>];</div><div class="line"><span class="keyword">assign</span> v=c^c31;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_32(f,a,b,s);</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>] f;</div><div class="line"><span class="keyword">input</span>[<span class="number">31</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> s;</div><div class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] f;</div><div class="line"><span class="keyword">always</span> @(s <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line"><span class="keyword">case</span>(s)</div><div class="line"><span class="number">1'd0</span>: f=a;</div><div class="line"><span class="number">1'd1</span>: f=b;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> ALU(op,a,b,s,n,v,c,z);</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>]op;</div><div class="line"><span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>]a,b;</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>]s;</div><div class="line"><span class="keyword">output</span> n,v,c,z;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]d,e,f,s1;</div><div class="line"><span class="keyword">assign</span> d=a&amp;b;</div><div class="line"><span class="keyword">assign</span> e=a|b;</div><div class="line">mux21_32 u0(f,d,e,op[<span class="number">0</span>]);</div><div class="line">add u2(a,b,op[<span class="number">0</span>],s1,c,v,n);</div><div class="line">mux21_32 u1(s,f,s1,op[<span class="number">1</span>]);</div><div class="line"><span class="keyword">assign</span> z=~(|s);</div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> ALUtest;</div><div class="line"><span class="keyword">reg</span> clk;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>]op;</div><div class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>]a,b;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]s;</div><div class="line"><span class="keyword">wire</span> n,v,c,z;</div><div class="line"><span class="comment">//op=00 AND;</span></div><div class="line"><span class="comment">//op=01 OR;</span></div><div class="line"><span class="comment">//op=10 ADD;</span></div><div class="line"><span class="comment">//op=11 SUB;</span></div><div class="line">ALU A(op,a,b,s,n,v,c,z);</div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"><span class="keyword">initial</span></div><div class="line">  <span class="keyword">begin</span></div><div class="line">#<span class="number">20</span>  a=<span class="number">32'b0100_0101_0100_0000_0010_0010_0101_0001</span>;</div><div class="line">     b=<span class="number">32'b1010_0101_0010_0000_0100_0010_0011_0010</span>;</div><div class="line">     op=<span class="number">2'b00</span>;</div><div class="line">#<span class="number">100</span> a=<span class="number">32'b0100_0101_0100_0000_0010_0010_0101_0001</span>;</div><div class="line">     b=<span class="number">32'b1010_0101_0010_0000_0100_0010_0011_0010</span>;</div><div class="line">     op=<span class="number">2'b01</span>;</div><div class="line">#<span class="number">100</span> a=<span class="number">32'b0100_0101_0100_0000_0010_0010_0101_0001</span>;</div><div class="line">     b=<span class="number">32'b1010_0101_0010_0000_0100_0010_0011_0010</span>;</div><div class="line">     op=<span class="number">2'b10</span>;</div><div class="line">#<span class="number">100</span> a=<span class="number">32'b0100_0101_0100_0000_0010_0010_0101_0001</span>;</div><div class="line">     b=<span class="number">32'b1010_0101_0010_0000_0100_0010_0011_0010</span>;</div><div class="line">     op=<span class="number">2'b11</span>;</div><div class="line">#<span class="number">100</span> a=<span class="number">32'b0111_1011_1101_1110_1111_1111_1111_1111</span>;</div><div class="line">     b=<span class="number">32'b0111_1011_1101_1110_1111_1111_1111_1111</span>;</div><div class="line">     op=<span class="number">2'b11</span>;</div><div class="line">#<span class="number">100</span> a=<span class="number">32'd15</span>;</div><div class="line">     b=<span class="number">32'd9</span>;</div><div class="line">     op=<span class="number">2'b11</span>;</div><div class="line">#<span class="number">100</span> a=<span class="number">32'd9</span>;</div><div class="line">     b=<span class="number">32'd15</span>;</div><div class="line">     op=<span class="number">2'b11</span>;</div><div class="line">#<span class="number">100</span> <span class="built_in">$stop</span>;</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p>注意：测试的完备性。</p>
<p><strong>4、将设计文件和测试文件输入Modesim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="Part-B"><a href="#Part-B" class="headerlink" title="Part B"></a>Part B</h2><h3 id="一、实验目的-1"><a href="#一、实验目的-1" class="headerlink" title="一、实验目的"></a>一、实验目的</h3><p>　　理解并掌握寄存器堆的基本电路结构及其设计方法，学会使用Verilog HDL对电路进行行为建模、结构建模以及仿真测试。</p>
<h3 id="二、实验内容-1"><a href="#二、实验内容-1" class="headerlink" title="二、实验内容"></a>二、实验内容</h3><p>　　利用Verilog HDL设计一个寄存器堆模型，并进行仿真测试。要求该寄存器堆具有32个32位的寄存器，并具有2个读端口和1个写端口。要求采用层次化的建模方法，即先搭建低层模块，然后再逐级搭建高层模块。</p>
<h3 id="三、实验环境-1"><a href="#三、实验环境-1" class="headerlink" title="三、实验环境"></a>三、实验环境</h3><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h3 id="四、实验步骤-1"><a href="#四、实验步骤-1" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h3><p><strong>1、电路结构设计</strong><br>寄存器堆外框图：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/21.png" alt=""><br>寄存器堆内部结构图：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/22.png" alt=""><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> registerfile(Q1,Q2,DI,clk,reset,writeen,AD,A1,A2);</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>] Q1,Q2;</div><div class="line"><span class="keyword">input</span>[<span class="number">31</span>:<span class="number">0</span>] DI;</div><div class="line"><span class="keyword">input</span> clk,reset,writeen;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] AD,A1,A2;</div><div class="line"></div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] decoderout;</div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] regen;</div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31;</div><div class="line"></div><div class="line">decoder dec0(decoderout,AD);</div><div class="line"></div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">0</span>]=decoderout[<span class="number">0</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">1</span>]=decoderout[<span class="number">1</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">2</span>]=decoderout[<span class="number">2</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">3</span>]=decoderout[<span class="number">3</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">4</span>]=decoderout[<span class="number">4</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">5</span>]=decoderout[<span class="number">5</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">6</span>]=decoderout[<span class="number">6</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">7</span>]=decoderout[<span class="number">7</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">8</span>]=decoderout[<span class="number">8</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">9</span>]=decoderout[<span class="number">9</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">10</span>]=decoderout[<span class="number">10</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">11</span>]=decoderout[<span class="number">11</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">12</span>]=decoderout[<span class="number">12</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">13</span>]=decoderout[<span class="number">13</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">14</span>]=decoderout[<span class="number">14</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">15</span>]=decoderout[<span class="number">15</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">16</span>]=decoderout[<span class="number">16</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">17</span>]=decoderout[<span class="number">17</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">18</span>]=decoderout[<span class="number">18</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">19</span>]=decoderout[<span class="number">19</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">20</span>]=decoderout[<span class="number">20</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">21</span>]=decoderout[<span class="number">21</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">22</span>]=decoderout[<span class="number">22</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">23</span>]=decoderout[<span class="number">23</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">24</span>]=decoderout[<span class="number">24</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">25</span>]=decoderout[<span class="number">25</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">26</span>]=decoderout[<span class="number">26</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">27</span>]=decoderout[<span class="number">27</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">28</span>]=decoderout[<span class="number">28</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">29</span>]=decoderout[<span class="number">29</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">30</span>]=decoderout[<span class="number">30</span>] &amp; writeen;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">31</span>]=decoderout[<span class="number">31</span>] &amp; writeen;</div><div class="line"></div><div class="line">register reg0(q0,DI,clk,reset,regen[<span class="number">0</span>]);</div><div class="line">register reg1(q1,DI,clk,reset,regen[<span class="number">1</span>]);</div><div class="line">register reg2(q2,DI,clk,reset,regen[<span class="number">2</span>]);</div><div class="line">register reg3(q3,DI,clk,reset,regen[<span class="number">3</span>]);</div><div class="line">register reg4(q4,DI,clk,reset,regen[<span class="number">4</span>]);</div><div class="line">register reg5(q5,DI,clk,reset,regen[<span class="number">5</span>]);</div><div class="line">register reg6(q6,DI,clk,reset,regen[<span class="number">6</span>]);</div><div class="line">register reg7(q7,DI,clk,reset,regen[<span class="number">7</span>]);</div><div class="line">register reg8(q8,DI,clk,reset,regen[<span class="number">8</span>]);</div><div class="line">register reg9(q9,DI,clk,reset,regen[<span class="number">9</span>]);</div><div class="line">register reg10(q10,DI,clk,reset,regen[<span class="number">10</span>]);</div><div class="line">register reg11(q11,DI,clk,reset,regen[<span class="number">11</span>]);</div><div class="line">register reg12(q12,DI,clk,reset,regen[<span class="number">12</span>]);</div><div class="line">register reg13(q13,DI,clk,reset,regen[<span class="number">13</span>]);</div><div class="line">register reg14(q14,DI,clk,reset,regen[<span class="number">14</span>]);</div><div class="line">register reg15(q15,DI,clk,reset,regen[<span class="number">15</span>]);</div><div class="line">register reg16(q16,DI,clk,reset,regen[<span class="number">16</span>]);</div><div class="line">register reg17(q17,DI,clk,reset,regen[<span class="number">17</span>]);</div><div class="line">register reg18(q18,DI,clk,reset,regen[<span class="number">18</span>]);</div><div class="line">register reg19(q19,DI,clk,reset,regen[<span class="number">19</span>]);</div><div class="line">register reg20(q20,DI,clk,reset,regen[<span class="number">20</span>]);</div><div class="line">register reg21(q21,DI,clk,reset,regen[<span class="number">21</span>]);</div><div class="line">register reg22(q22,DI,clk,reset,regen[<span class="number">22</span>]);</div><div class="line">register reg23(q23,DI,clk,reset,regen[<span class="number">23</span>]);</div><div class="line">register reg24(q24,DI,clk,reset,regen[<span class="number">24</span>]);</div><div class="line">register reg25(q25,DI,clk,reset,regen[<span class="number">25</span>]);</div><div class="line">register reg26(q26,DI,clk,reset,regen[<span class="number">26</span>]);</div><div class="line">register reg27(q27,DI,clk,reset,regen[<span class="number">27</span>]);</div><div class="line">register reg28(q28,DI,clk,reset,regen[<span class="number">28</span>]);</div><div class="line">register reg29(q29,DI,clk,reset,regen[<span class="number">29</span>]);</div><div class="line">register reg30(q30,DI,clk,reset,regen[<span class="number">30</span>]);</div><div class="line">register reg31(q31,DI,clk,reset,regen[<span class="number">31</span>]);</div><div class="line"></div><div class="line">mux_32 mux0(Q1,q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31,A1);</div><div class="line">mux_32 mux1(Q2,q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31,A2);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> decoder(decoderout,waddr);</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>] decoderout;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] waddr;</div><div class="line"></div><div class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] decoderout;</div><div class="line"><span class="keyword">always</span> @ (waddr)</div><div class="line"><span class="keyword">case</span>(waddr)</div><div class="line"><span class="number">5'd0</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0000_0001</span>;</div><div class="line"><span class="number">5'd1</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0000_0010</span>;</div><div class="line"><span class="number">5'd2</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0000_0100</span>;</div><div class="line"><span class="number">5'd3</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0000_1000</span>;</div><div class="line"><span class="number">5'd4</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0001_0000</span>;</div><div class="line"><span class="number">5'd5</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0010_0000</span>;</div><div class="line"><span class="number">5'd6</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_0100_0000</span>;</div><div class="line"><span class="number">5'd7</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0000_1000_0000</span>;</div><div class="line"><span class="number">5'd8</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0001_0000_0000</span>;</div><div class="line"><span class="number">5'd9</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0010_0000_0000</span>;</div><div class="line"><span class="number">5'd10</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_0100_0000_0000</span>;</div><div class="line"><span class="number">5'd11</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0000_1000_0000_0000</span>;</div><div class="line"><span class="number">5'd12</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0001_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd13</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0010_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd14</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_0100_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd15</span>: decoderout=<span class="number">32'b0000_0000_0000_0000_1000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd16</span>: decoderout=<span class="number">32'b0000_0000_0000_0001_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd17</span>: decoderout=<span class="number">32'b0000_0000_0000_0010_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd18</span>: decoderout=<span class="number">32'b0000_0000_0000_0100_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd19</span>: decoderout=<span class="number">32'b0000_0000_0000_1000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd20</span>: decoderout=<span class="number">32'b0000_0000_0001_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd21</span>: decoderout=<span class="number">32'b0000_0000_0010_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd22</span>: decoderout=<span class="number">32'b0000_0000_0100_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd23</span>: decoderout=<span class="number">32'b0000_0000_1000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd24</span>: decoderout=<span class="number">32'b0000_0001_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd25</span>: decoderout=<span class="number">32'b0000_0010_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd26</span>: decoderout=<span class="number">32'b0000_0100_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd27</span>: decoderout=<span class="number">32'b0000_1000_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd28</span>: decoderout=<span class="number">32'b0001_0000_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd29</span>: decoderout=<span class="number">32'b0010_0000_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd30</span>: decoderout=<span class="number">32'b0100_0000_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="number">5'd31</span>: decoderout=<span class="number">32'b1000_0000_0000_0000_0000_0000_0000_0000</span>;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> register(q,data,clk,reset,en);</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>] q;</div><div class="line"><span class="keyword">input</span>[<span class="number">31</span>:<span class="number">0</span>] data;</div><div class="line"><span class="keyword">input</span> clk,reset,en;</div><div class="line"></div><div class="line">dff u0(q[<span class="number">0</span>],data[<span class="number">0</span>],clk,reset,en);</div><div class="line">dff u1(q[<span class="number">1</span>],data[<span class="number">1</span>],clk,reset,en);</div><div class="line">dff u2(q[<span class="number">2</span>],data[<span class="number">2</span>],clk,reset,en);</div><div class="line">dff u3(q[<span class="number">3</span>],data[<span class="number">3</span>],clk,reset,en);</div><div class="line">dff u4(q[<span class="number">4</span>],data[<span class="number">4</span>],clk,reset,en);</div><div class="line">dff u5(q[<span class="number">5</span>],data[<span class="number">5</span>],clk,reset,en);</div><div class="line">dff u6(q[<span class="number">6</span>],data[<span class="number">6</span>],clk,reset,en);</div><div class="line">dff u7(q[<span class="number">7</span>],data[<span class="number">7</span>],clk,reset,en);</div><div class="line">dff u8(q[<span class="number">8</span>],data[<span class="number">8</span>],clk,reset,en);</div><div class="line">dff u9(q[<span class="number">9</span>],data[<span class="number">9</span>],clk,reset,en);</div><div class="line">dff u10(q[<span class="number">10</span>],data[<span class="number">10</span>],clk,reset,en);</div><div class="line">dff u11(q[<span class="number">11</span>],data[<span class="number">11</span>],clk,reset,en);</div><div class="line">dff u12(q[<span class="number">12</span>],data[<span class="number">12</span>],clk,reset,en);</div><div class="line">dff u13(q[<span class="number">13</span>],data[<span class="number">13</span>],clk,reset,en);</div><div class="line">dff u14(q[<span class="number">14</span>],data[<span class="number">14</span>],clk,reset,en);</div><div class="line">dff u15(q[<span class="number">15</span>],data[<span class="number">15</span>],clk,reset,en);</div><div class="line">dff u16(q[<span class="number">16</span>],data[<span class="number">16</span>],clk,reset,en);</div><div class="line">dff u17(q[<span class="number">17</span>],data[<span class="number">17</span>],clk,reset,en);</div><div class="line">dff u18(q[<span class="number">18</span>],data[<span class="number">18</span>],clk,reset,en);</div><div class="line">dff u19(q[<span class="number">19</span>],data[<span class="number">19</span>],clk,reset,en);</div><div class="line">dff u20(q[<span class="number">20</span>],data[<span class="number">20</span>],clk,reset,en);</div><div class="line">dff u21(q[<span class="number">21</span>],data[<span class="number">21</span>],clk,reset,en);</div><div class="line">dff u22(q[<span class="number">22</span>],data[<span class="number">22</span>],clk,reset,en);</div><div class="line">dff u23(q[<span class="number">23</span>],data[<span class="number">23</span>],clk,reset,en);</div><div class="line">dff u24(q[<span class="number">24</span>],data[<span class="number">24</span>],clk,reset,en);</div><div class="line">dff u25(q[<span class="number">25</span>],data[<span class="number">25</span>],clk,reset,en);</div><div class="line">dff u26(q[<span class="number">26</span>],data[<span class="number">26</span>],clk,reset,en);</div><div class="line">dff u27(q[<span class="number">27</span>],data[<span class="number">27</span>],clk,reset,en);</div><div class="line">dff u28(q[<span class="number">28</span>],data[<span class="number">28</span>],clk,reset,en);</div><div class="line">dff u29(q[<span class="number">29</span>],data[<span class="number">29</span>],clk,reset,en);</div><div class="line">dff u30(q[<span class="number">30</span>],data[<span class="number">30</span>],clk,reset,en);</div><div class="line">dff u31(q[<span class="number">31</span>],data[<span class="number">31</span>],clk,reset,en);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> dff(q,data,clk,reset,en);</div><div class="line"><span class="keyword">output</span> q;</div><div class="line"><span class="keyword">input</span> data,clk,reset,en;</div><div class="line"></div><div class="line"><span class="keyword">reg</span> q;</div><div class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span> (reset)</div><div class="line">            q=<span class="number">0</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (en)</div><div class="line">                    q=data;</div><div class="line">                <span class="keyword">else</span> </div><div class="line">                    q=q;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux_32(q,q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31,raddr);</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>] q;</div><div class="line"><span class="keyword">input</span>[<span class="number">31</span>:<span class="number">0</span>] q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] raddr;</div><div class="line"></div><div class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] q;</div><div class="line"><span class="keyword">always</span> @(raddr <span class="keyword">or</span> q0 <span class="keyword">or</span> q1 <span class="keyword">or</span> q2 <span class="keyword">or</span> q3 <span class="keyword">or</span> q4 <span class="keyword">or</span> q5 <span class="keyword">or</span> q6 <span class="keyword">or</span> q7 <span class="keyword">or</span> q8 <span class="keyword">or</span> q9 <span class="keyword">or</span> q10 <span class="keyword">or</span> q11 <span class="keyword">or</span> q12 <span class="keyword">or</span> q13 <span class="keyword">or</span> q14 <span class="keyword">or</span> q15 <span class="keyword">or</span> q16 <span class="keyword">or</span> q17 <span class="keyword">or</span> q18 <span class="keyword">or</span> q19 <span class="keyword">or</span> q20 <span class="keyword">or</span> q21 <span class="keyword">or</span> q22 <span class="keyword">or</span> q23 <span class="keyword">or</span> q24 <span class="keyword">or</span> q25 <span class="keyword">or</span> q26 <span class="keyword">or</span> q27 <span class="keyword">or</span> q28 <span class="keyword">or</span> q29 <span class="keyword">or</span> q30 <span class="keyword">or</span> q31)</div><div class="line"><span class="keyword">case</span>(raddr)</div><div class="line"><span class="number">5'd0</span>: q=q0;</div><div class="line"><span class="number">5'd1</span>: q=q1;</div><div class="line"><span class="number">5'd2</span>: q=q2;</div><div class="line"><span class="number">5'd3</span>: q=q3;</div><div class="line"><span class="number">5'd4</span>: q=q4;</div><div class="line"><span class="number">5'd5</span>: q=q5;</div><div class="line"><span class="number">5'd6</span>: q=q6;</div><div class="line"><span class="number">5'd7</span>: q=q7;</div><div class="line"><span class="number">5'd8</span>: q=q8;</div><div class="line"><span class="number">5'd9</span>: q=q9;</div><div class="line"><span class="number">5'd10</span>: q=q10;</div><div class="line"><span class="number">5'd11</span>: q=q11;</div><div class="line"><span class="number">5'd12</span>: q=q12;</div><div class="line"><span class="number">5'd13</span>: q=q13;</div><div class="line"><span class="number">5'd14</span>: q=q14;</div><div class="line"><span class="number">5'd15</span>: q=q15;</div><div class="line"><span class="number">5'd16</span>: q=q16;</div><div class="line"><span class="number">5'd17</span>: q=q17;</div><div class="line"><span class="number">5'd18</span>: q=q18;</div><div class="line"><span class="number">5'd19</span>: q=q19;</div><div class="line"><span class="number">5'd20</span>: q=q20;</div><div class="line"><span class="number">5'd21</span>: q=q21;</div><div class="line"><span class="number">5'd22</span>: q=q22;</div><div class="line"><span class="number">5'd23</span>: q=q23;</div><div class="line"><span class="number">5'd24</span>: q=q24;</div><div class="line"><span class="number">5'd25</span>: q=q25;</div><div class="line"><span class="number">5'd26</span>: q=q26;</div><div class="line"><span class="number">5'd27</span>: q=q27;</div><div class="line"><span class="number">5'd28</span>: q=q28;</div><div class="line"><span class="number">5'd29</span>: q=q29;</div><div class="line"><span class="number">5'd30</span>: q=q30;</div><div class="line"><span class="number">5'd31</span>: q=q31;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> rftest;</div><div class="line"></div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]q11,q22;</div><div class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>]data;</div><div class="line"><span class="keyword">reg</span> [<span class="number">4</span>:<span class="number">0</span>]waddr;</div><div class="line"><span class="keyword">reg</span> [<span class="number">4</span>:<span class="number">0</span>]raddr1,raddr2;</div><div class="line"><span class="keyword">reg</span> clk,reset,we;</div><div class="line"></div><div class="line">registerfile r(q11,q22,data,clk,reset,we,waddr,raddr1,raddr2);</div><div class="line"></div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk=~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">   <span class="keyword">begin</span> </div><div class="line">     clk=<span class="number">0</span>;</div><div class="line">     reset=<span class="number">1</span>;</div><div class="line">     we=<span class="number">0</span>;</div><div class="line">#<span class="number">120</span> reset=<span class="number">0</span>;</div><div class="line">     data=<span class="number">32'd1</span>;</div><div class="line">     we=<span class="number">1</span>;</div><div class="line">     waddr=<span class="number">5'd0</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd2</span>;</div><div class="line">     waddr=<span class="number">5'd1</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd3</span>;</div><div class="line">     waddr=<span class="number">5'd2</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd4</span>;</div><div class="line">     waddr=<span class="number">5'd3</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd5</span>;</div><div class="line">     waddr=<span class="number">5'd4</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd6</span>;</div><div class="line">     waddr=<span class="number">5'd5</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd7</span>;</div><div class="line">     waddr=<span class="number">5'd6</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd8</span>;</div><div class="line">     waddr=<span class="number">5'd7</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd9</span>;</div><div class="line">     waddr=<span class="number">5'd8</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd10</span>;</div><div class="line">     waddr=<span class="number">5'd9</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd11</span>;</div><div class="line">     waddr=<span class="number">5'd10</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd12</span>;</div><div class="line">     waddr=<span class="number">5'd11</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd13</span>;</div><div class="line">     waddr=<span class="number">5'd12</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd14</span>;</div><div class="line">     waddr=<span class="number">5'd13</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd15</span>;</div><div class="line">     waddr=<span class="number">5'd14</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd16</span>;</div><div class="line">     waddr=<span class="number">5'd15</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd17</span>;</div><div class="line">     waddr=<span class="number">5'd16</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd18</span>;</div><div class="line">     waddr=<span class="number">5'd17</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd19</span>;</div><div class="line">     waddr=<span class="number">5'd18</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd20</span>;</div><div class="line">     waddr=<span class="number">5'd19</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd21</span>;</div><div class="line">     waddr=<span class="number">5'd20</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd22</span>;</div><div class="line">     waddr=<span class="number">5'd21</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd23</span>;</div><div class="line">     waddr=<span class="number">5'd22</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd24</span>;</div><div class="line">     waddr=<span class="number">5'd23</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd25</span>;</div><div class="line">     waddr=<span class="number">5'd24</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd26</span>;</div><div class="line">     waddr=<span class="number">5'd25</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd27</span>;</div><div class="line">    waddr=<span class="number">5'd26</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd28</span>;</div><div class="line">     waddr=<span class="number">5'd27</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd29</span>;</div><div class="line">     waddr=<span class="number">5'd28</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd30</span>;</div><div class="line">     waddr=<span class="number">5'd29</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd31</span>;</div><div class="line">     waddr=<span class="number">5'd30</span>;</div><div class="line">#<span class="number">100</span> data=<span class="number">32'd32</span>;</div><div class="line">     waddr=<span class="number">5'd31</span>;</div><div class="line"></div><div class="line">#<span class="number">100</span> we=<span class="number">0</span>;</div><div class="line">     raddr1=<span class="number">5'd0</span>;</div><div class="line">raddr2=<span class="number">5'd1</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd1</span>;</div><div class="line">     raddr2=<span class="number">5'd2</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd2</span>;</div><div class="line">     raddr2=<span class="number">5'd3</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd3</span>;</div><div class="line">     raddr2=<span class="number">5'd4</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd4</span>;</div><div class="line">     raddr2=<span class="number">5'd5</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd5</span>;</div><div class="line">     raddr2=<span class="number">5'd6</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd6</span>;</div><div class="line">     raddr2=<span class="number">5'd7</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd7</span>;</div><div class="line">     raddr2=<span class="number">5'd8</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd8</span>;</div><div class="line">     raddr2=<span class="number">5'd9</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd9</span>;</div><div class="line">     raddr2=<span class="number">5'd10</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd10</span>;</div><div class="line">     raddr2=<span class="number">5'd11</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd11</span>;</div><div class="line">     raddr2=<span class="number">5'd12</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd12</span>;</div><div class="line">     raddr2=<span class="number">5'd13</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd13</span>;</div><div class="line">     raddr2=<span class="number">5'd14</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd14</span>;</div><div class="line">     raddr2=<span class="number">5'd15</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd15</span>;</div><div class="line">     raddr2=<span class="number">5'd16</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd16</span>;</div><div class="line">     raddr2=<span class="number">5'd17</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd17</span>;</div><div class="line">     raddr2=<span class="number">5'd18</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd18</span>;</div><div class="line">     raddr2=<span class="number">5'd19</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd19</span>;</div><div class="line">     raddr2=<span class="number">5'd20</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd20</span>;</div><div class="line">     raddr2=<span class="number">5'd21</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd21</span>;</div><div class="line">     raddr2=<span class="number">5'd22</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd22</span>;</div><div class="line">     raddr2=<span class="number">5'd23</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd23</span>;</div><div class="line">     raddr2=<span class="number">5'd24</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd24</span>;</div><div class="line">     raddr2=<span class="number">5'd25</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd25</span>;</div><div class="line">     raddr2=<span class="number">5'd26</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd26</span>;</div><div class="line">     raddr2=<span class="number">5'd27</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd27</span>;</div><div class="line">     raddr2=<span class="number">5'd28</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd28</span>;</div><div class="line">     raddr2=<span class="number">5'd29</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd29</span>;</div><div class="line">     raddr2=<span class="number">5'd30</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd30</span>;</div><div class="line">     raddr2=<span class="number">5'd31</span>;</div><div class="line">#<span class="number">100</span> raddr1=<span class="number">5'd31</span>;</div><div class="line">     raddr2=<span class="number">5'd0</span>;</div><div class="line"></div><div class="line">#<span class="number">200</span> <span class="built_in">$stop</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p>注意：测试的完备性。</p>
<p><strong>4、将设计文件和测试文件输入Modesim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="Part-C"><a href="#Part-C" class="headerlink" title="Part C"></a>Part C</h2><h3 id="一、实验目的-2"><a href="#一、实验目的-2" class="headerlink" title="一、实验目的"></a>一、实验目的</h3><p>　　理解并掌握CPU控制器的基本电路结构及其设计方法，学会使用Verilog HDL对电路进行行为建模、结构建模以及仿真测试。</p>
<h3 id="二、实验内容-2"><a href="#二、实验内容-2" class="headerlink" title="二、实验内容"></a>二、实验内容</h3><p>　　利用Verilog HDL设计一个多周期处理机控制器，并进行仿真测试。要求该处理机能够实现下列指令系统：</p>
<p><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/31.png" alt=""><br>要求把指令的执行分为以下5个步骤，每个步骤用一个时钟周期。<br>　　1、取指令及PC+1周期<br>　　2、指令译码、读寄存器及转移周期<br>　　3、ALU执行或者存储器地址计算周期<br>　　4、ALU指令结束周期或者存储器访问周期<br>　　5、写回周期</p>
<p>该多周期处理机的数据路径如下：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/32.png" alt=""><br>该多周期处理机的数据路径所需要的控制信号定义如下：<br>　　WRITEPC：PC写使能信号，为1时，CLK上升沿把PC输入端的数据写入PC；<br>　　SELLDST：存储器地址输入选择，为1时，选ALU计算出的地址，为0选PC；<br>　　WRITEMEM：写存储器使能信号，由store指令产生；<br>　　WRITEIR：IR写使能信号，为1时，CLK上升沿把由PC访问到的指令写入IR；<br>　　SELLOAD：寄存器堆数据输入选择，为1时选存储器输出，为0选ALU输出；<br>　　SELST：执行store指令时，从寄存器堆Q2端口读出寄存器rd的内容；<br>　　WRITEREG：写寄存器堆使能信号；<br>　　SELALUA：ALU A输入端选择，0选寄存器RS1,1选PC;<br>　　SELALUB：ALU B输入端选择，00选寄存器RS2,01选立即数IM，10选1，11选偏移量;<br>　　ALUOP：ALU操作控制码；<br>　　WRITEZERO：写标志寄存器ZERO的使能信号；</p>
<h3 id="三、实验环境-2"><a href="#三、实验环境-2" class="headerlink" title="三、实验环境"></a>三、实验环境</h3><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h3 id="四、实验步骤-2"><a href="#四、实验步骤-2" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h3><p><strong>1、电路结构设计与逻辑设计</strong></p>
<p>电路结构图：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/33.png" alt=""><br>状态转移图：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/34.png" alt=""><br>状态转移表：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/35.png" alt=""><br>其中：<br>　　RR=and+or+add+sub(寄存器-寄存器操作);<br>　　RI=andi+ori+addi+subi(寄存器-立即数操作);<br>　　BR=branch+bne+beq(转移指令)；X=任意。</p>
<p>根据上述状态转移表，可以得到下一状态产生电路的逻辑表达式：<br>　　D0=S0+S1<em>RI+S1</em>store+S3+S5;<br>　　D1=S1<em>RR+S1</em>RI+S2+S3+S8;<br>　　D2=S1<em>load+S1</em>store+S2+S3;<br>　　D3=S4+S5+S8;</p>
<p>控制信号取值表：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/36.png" alt=""><br>根据上述控制信号取值表，可以得到控制信号产生电路的逻辑表达式：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/37.png" alt=""><br><strong>2、建立Verilog模型</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span>   control(clk,start,zero,opcode,writepc,selldst,writemem,writeir,</div><div class="line">selload,selst,writereg,selalua,selalub,aluop,writezero);</div><div class="line"></div><div class="line"><span class="keyword">input</span>   clk,start,zero;</div><div class="line"><span class="keyword">input</span>  [<span class="number">5</span>:<span class="number">0</span>]  opcode;</div><div class="line"><span class="keyword">output</span>  writepc,selldst,writemem,writeir,selload,selst,</div><div class="line">writereg,selalua,writezero;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>]  selalub,aluop;</div><div class="line"></div><div class="line"><span class="keyword">reg</span>  [<span class="number">3</span>:<span class="number">0</span>] q;</div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] d;</div><div class="line"><span class="keyword">wire</span>  zero;</div><div class="line"></div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(start)</div><div class="line">            q&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            q&lt;=d;</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> d[<span class="number">0</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">0</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;opcode[<span class="number">0</span>]))|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> d[<span class="number">1</span>]=((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">0</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">0</span>]))|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> d[<span class="number">2</span>]=((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;~opcode[<span class="number">0</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;opcode[<span class="number">0</span>]))|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> d[<span class="number">3</span>]=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"></div><div class="line"><span class="keyword">assign</span> writepc=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;((opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;~opcode[<span class="number">0</span>])|(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;opcode[<span class="number">1</span>]&amp;~opcode[<span class="number">0</span>]&amp;~zero)|(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;opcode[<span class="number">1</span>]&amp;opcode[<span class="number">0</span>]&amp;zero)));</div><div class="line"><span class="keyword">assign</span> selldst=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writemem=q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> writeir=~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> selload=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selst=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writereg=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selalua=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selalub[<span class="number">1</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selalub[<span class="number">0</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writezero=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> aluop[<span class="number">1</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> aluop[<span class="number">0</span>]=((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]));</div><div class="line"></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> controltest;</div><div class="line"></div><div class="line"><span class="keyword">reg</span> clk,rst,zero;</div><div class="line"><span class="keyword">reg</span> [<span class="number">5</span>:<span class="number">0</span>] opcode;</div><div class="line"><span class="keyword">wire</span> writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,writezero;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] selalub,aluop;</div><div class="line"></div><div class="line">control  con(clk,rst,zero,opcode,writepc,selldst,writemem,writeir,selload,</div><div class="line">selst,writereg,selalua,selalub,aluop,writezero);</div><div class="line"></div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk=~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">  <span class="keyword">begin</span></div><div class="line">    clk=<span class="number">1</span>;</div><div class="line">    rst=<span class="number">0</span>;</div><div class="line">#<span class="number">20</span> rst=<span class="number">1</span>;</div><div class="line">#<span class="number">100</span> rst=<span class="number">0</span>;<span class="comment">//IF</span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd0</span>;<span class="comment">//ID-- and rd,rs1,rs2     </span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd1</span>;<span class="comment">//ID-- andi rd,rs1,imme</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd2</span>;<span class="comment">//ID-- or rd,rs1,rs2</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd3</span>;<span class="comment">//ID-- ori rd,rs1,imme</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd4</span>;<span class="comment">//ID-- add rd,rs1,rs2</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd5</span>;<span class="comment">//ID-- addi rd,rs1,imme</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd6</span>;<span class="comment">//ID-- sub rd,rs1,rs2</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd7</span>;<span class="comment">//ID-- subi rd,rs1,imme</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd8</span>;<span class="comment">//ID-- load rd,rs1,imme</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//MEM</span></div><div class="line">#<span class="number">100</span><span class="comment">//WB</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd9</span>;<span class="comment">//ID-- store rd,rs1,imme</span></div><div class="line">#<span class="number">100</span><span class="comment">//EXE</span></div><div class="line">#<span class="number">100</span><span class="comment">//MEM</span></div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd10</span>;<span class="comment">//ID-- bne disp</span></div><div class="line">     zero=<span class="number">1</span>;</div><div class="line">     </div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd10</span>;<span class="comment">//ID-- bne disp</span></div><div class="line">     zero=<span class="number">0</span>;</div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd11</span>;<span class="comment">//ID-- beq disp</span></div><div class="line">     zero=<span class="number">1</span>;</div><div class="line">     </div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd11</span>;<span class="comment">//ID-- beq disp</span></div><div class="line">     zero=<span class="number">0</span>;</div><div class="line"></div><div class="line">#<span class="number">100</span><span class="comment">//IF     </span></div><div class="line">#<span class="number">100</span> opcode=<span class="number">6'd12</span>;<span class="comment">//ID-- branch disp</span></div><div class="line">     </div><div class="line"></div><div class="line">#<span class="number">100</span> <span class="built_in">$stop</span>;</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p>注意：测试的完备性。</p>
<p><strong>4、将设计文件和测试文件输入Modesim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="Part-D"><a href="#Part-D" class="headerlink" title="Part D"></a>Part D</h2><h3 id="一、实验目的-3"><a href="#一、实验目的-3" class="headerlink" title="一、实验目的"></a>一、实验目的</h3><p>　　理解并掌握CPU的基本电路结构及其设计方法，学会使用Verilog HDL对电路进行行为建模、结构建模以及仿真测试。</p>
<h3 id="二、实验内容-3"><a href="#二、实验内容-3" class="headerlink" title="二、实验内容"></a>二、实验内容</h3><p>　　利用Verilog HDL设计一个简单的CPU模型，并进行仿真测试。<br>　　要求该处理机能够实现下列指令系统：<br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/41.png" alt=""><br>要求把指令的执行分为以下5个步骤，每个步骤用一个时钟周期。<br>　　1、取指令及PC+1周期<br>　　2、指令译码、读寄存器及转移周期<br>　　3、ALU执行或者存储器地址计算周期<br>　　4、ALU指令结束周期或者存储器访问周期<br>　　5、写回周期</p>
<h3 id="三、实验环境-3"><a href="#三、实验环境-3" class="headerlink" title="三、实验环境"></a>三、实验环境</h3><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h3 id="四、实验步骤-3"><a href="#四、实验步骤-3" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h3><p><strong>1、电路结构设计与逻辑设计</strong><br><img src="/sourcefile/[O]基于FPGA的RISC_CPU的设计与实现/42.png" alt=""><br><strong>2、建立Verilog模型</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> TOP(clk,rst,start,memwe,memin,memaddr,zero,n,v,c,dataout);</div><div class="line"><span class="keyword">input</span> clk,rst,start,memwe;</div><div class="line"><span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>]memin;</div><div class="line"><span class="keyword">input</span> [<span class="number">4</span>:<span class="number">0</span>]memaddr;</div><div class="line"><span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>]dataout;</div><div class="line"><span class="keyword">output</span> n,v,c,zero;</div><div class="line"><span class="keyword">wire</span> clk,rst;</div><div class="line"><span class="keyword">wire</span> writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,writezero;</div><div class="line"><span class="keyword">wire</span> [<span class="number">5</span>:<span class="number">0</span>]opcode;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>]aluop,selalub;</div><div class="line"><span class="keyword">wire</span> zero;</div><div class="line">datapath u0(writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,selalub,aluop,writezero,clk,rst,memin,memaddr,memwe,zero,n,v,c,opcode,dataout);</div><div class="line">control u1(clk,start,zero,opcode,writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,selalub,aluop,writezero);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> datapath(writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,selalub,aluop,writezero,clk,rst,memin,memaddr,memwe,zero,n,v,c,opcode,dataout);</div><div class="line"><span class="keyword">input</span> writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,writezero,clk,rst,memwe;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] selalub,aluop;</div><div class="line"><span class="keyword">input</span> [<span class="number">4</span>:<span class="number">0</span>]memaddr;</div><div class="line"><span class="keyword">input</span> [<span class="number">31</span>:<span class="number">0</span>]memin;</div><div class="line"><span class="keyword">output</span> zero,n,v,c;</div><div class="line"><span class="keyword">output</span> [<span class="number">5</span>:<span class="number">0</span>]opcode;</div><div class="line"><span class="keyword">output</span> [<span class="number">31</span>:<span class="number">0</span>]dataout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">4</span>:<span class="number">0</span>]pcout,address,memaddr,mux3out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]memin,mux4out,mux5out,imme,disp;</div><div class="line"><span class="keyword">wire</span> memwe,zero1;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>]dataout,Q1,datain,irout,f,aluout;</div><div class="line">pc pc1(pcout,aluout[<span class="number">4</span>:<span class="number">0</span>],writepc,clk,rst);</div><div class="line">mux21_5 mux1(address,pcout,aluout[<span class="number">4</span>:<span class="number">0</span>],selldst);</div><div class="line">memory mem(dataout,datain,address,writemem,memin,memaddr,memwe,clk,rst);</div><div class="line"><span class="comment">//memin,memaddr,memweÊÇÎªÁËÔÚ¼Ä´æÆ÷ÖÐÊäÈëÊý¾Ý¶øÓÃ</span></div><div class="line">ir ir1(irout,dataout,clk,rst,writeir);</div><div class="line">mux21_32 mux2(f,aluout,dataout,selload);</div><div class="line">mux21_5  mux3(mux3out,irout[<span class="number">4</span>:<span class="number">0</span>],irout[<span class="number">25</span>:<span class="number">21</span>],selst);</div><div class="line">registerfile registerfile(Q1,datain,f,clk,rst,writereg,irout[<span class="number">25</span>:<span class="number">21</span>],irout[<span class="number">20</span>:<span class="number">16</span>],mux3out);</div><div class="line">mux21_32 mux4(mux4out,Q1,&#123;<span class="number">27'b0</span>,pcout&#125;,selalua);</div><div class="line"><span class="keyword">assign</span> imme=&#123;irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>],irout[<span class="number">15</span>:<span class="number">0</span>]&#125;;</div><div class="line"><span class="keyword">assign</span> disp=&#123;irout[<span class="number">25</span>],irout[<span class="number">25</span>],irout[<span class="number">25</span>],irout[<span class="number">25</span>],irout[<span class="number">25</span>],irout[<span class="number">25</span>],irout[<span class="number">25</span>:<span class="number">0</span>]&#125;;</div><div class="line">mux41_32 mux5(mux5out,datain,imme,<span class="number">32'd1</span>,disp,selalub);</div><div class="line">ALU alu1(aluop,mux4out,mux5out,aluout,n,v,c,zero1);</div><div class="line">dff  zeroflag(zero,zero1,clk,rst,writezero);</div><div class="line"><span class="keyword">assign</span> opcode=irout[<span class="number">31</span>:<span class="number">26</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span>   control(clk,start,zero,opcode,writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,selalub,aluop,writezero);</div><div class="line"></div><div class="line"><span class="keyword">input</span> clk,start,zero;</div><div class="line"><span class="keyword">input</span> [<span class="number">5</span>:<span class="number">0</span>] opcode;</div><div class="line"><span class="keyword">output</span> writepc,selldst,writemem,writeir,selload,selst,writereg,selalua,writezero;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] selalub,aluop;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">3</span>:<span class="number">0</span>]q;</div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>]d;</div><div class="line"><span class="keyword">wire</span>  zero;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(start)</div><div class="line">            q&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            q&lt;=d;</div><div class="line">    <span class="keyword">end</span> </div><div class="line"><span class="keyword">assign</span> d[<span class="number">0</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">0</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;opcode[<span class="number">0</span>]))|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> d[<span class="number">1</span>]=((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">0</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">0</span>]))|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> d[<span class="number">2</span>]=((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;~opcode[<span class="number">0</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;opcode[<span class="number">0</span>]))|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> d[<span class="number">3</span>]=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writepc=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;((opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]&amp;~opcode[<span class="number">1</span>]&amp;~opcode[<span class="number">0</span>])|(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;opcode[<span class="number">1</span>]&amp;~opcode[<span class="number">0</span>]&amp;~zero)|(opcode[<span class="number">3</span>]&amp;~opcode[<span class="number">2</span>]&amp;opcode[<span class="number">1</span>]&amp;opcode[<span class="number">0</span>]&amp;zero)));</div><div class="line"><span class="keyword">assign</span> selldst=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writemem=q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> writeir=~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> selload=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selst=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writereg=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selalua=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selalub[<span class="number">1</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> selalub[<span class="number">0</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> writezero=(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> aluop[<span class="number">1</span>]=(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">2</span>]))|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;~q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])|(q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>]);</div><div class="line"><span class="keyword">assign</span> aluop[<span class="number">0</span>]=((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">1</span>]))|((~q[<span class="number">3</span>]&amp;~q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">1</span>]))|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;~q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">1</span>]))|((~q[<span class="number">3</span>]&amp;q[<span class="number">2</span>]&amp;q[<span class="number">1</span>]&amp;q[<span class="number">0</span>])&amp;(~opcode[<span class="number">3</span>]&amp;opcode[<span class="number">1</span>]));</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> memory(dataout,datain,address,we,memin,memaddr,memwe,clk,reset);</div><div class="line"><span class="keyword">output</span>[<span class="number">31</span>:<span class="number">0</span>] dataout;</div><div class="line"><span class="keyword">input</span>[<span class="number">31</span>:<span class="number">0</span>] datain,memin;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] address,memaddr;</div><div class="line"><span class="keyword">input</span> clk,reset,we,memwe;</div><div class="line"><span class="keyword">wire</span> we1;</div><div class="line"><span class="keyword">wire</span>[<span class="number">4</span>:<span class="number">0</span>] address1;</div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] decoderout;</div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] regen;</div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] datain1;</div><div class="line"><span class="keyword">wire</span>[<span class="number">31</span>:<span class="number">0</span>] q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31;</div><div class="line"><span class="keyword">assign</span> address1=memwe?memaddr:address;</div><div class="line"><span class="keyword">assign</span> datain1=memwe? memin:datain;</div><div class="line">decoder dec0(decoderout,address1);</div><div class="line"><span class="keyword">assign</span> we1=we | memwe;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">0</span>]=decoderout[<span class="number">0</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">1</span>]=decoderout[<span class="number">1</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">2</span>]=decoderout[<span class="number">2</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">3</span>]=decoderout[<span class="number">3</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">4</span>]=decoderout[<span class="number">4</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">5</span>]=decoderout[<span class="number">5</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">6</span>]=decoderout[<span class="number">6</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">7</span>]=decoderout[<span class="number">7</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">8</span>]=decoderout[<span class="number">8</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">9</span>]=decoderout[<span class="number">9</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">10</span>]=decoderout[<span class="number">10</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">11</span>]=decoderout[<span class="number">11</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">12</span>]=decoderout[<span class="number">12</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">13</span>]=decoderout[<span class="number">13</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">14</span>]=decoderout[<span class="number">14</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">15</span>]=decoderout[<span class="number">15</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">16</span>]=decoderout[<span class="number">16</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">17</span>]=decoderout[<span class="number">17</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">18</span>]=decoderout[<span class="number">18</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">19</span>]=decoderout[<span class="number">19</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">20</span>]=decoderout[<span class="number">20</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">21</span>]=decoderout[<span class="number">21</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">22</span>]=decoderout[<span class="number">22</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">23</span>]=decoderout[<span class="number">23</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">24</span>]=decoderout[<span class="number">24</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">25</span>]=decoderout[<span class="number">25</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">26</span>]=decoderout[<span class="number">26</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">27</span>]=decoderout[<span class="number">27</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">28</span>]=decoderout[<span class="number">28</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">29</span>]=decoderout[<span class="number">29</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">30</span>]=decoderout[<span class="number">30</span>] &amp; we1;</div><div class="line"><span class="keyword">assign</span>  regen[<span class="number">31</span>]=decoderout[<span class="number">31</span>] &amp; we1;</div><div class="line">register reg0(q0,datain1,clk,reset,regen[<span class="number">0</span>]);</div><div class="line">register reg1(q1,datain1,clk,reset,regen[<span class="number">1</span>]);</div><div class="line">register reg2(q2,datain1,clk,reset,regen[<span class="number">2</span>]);</div><div class="line">register reg3(q3,datain1,clk,reset,regen[<span class="number">3</span>]);</div><div class="line">register reg4(q4,datain1,clk,reset,regen[<span class="number">4</span>]);</div><div class="line">register reg5(q5,datain1,clk,reset,regen[<span class="number">5</span>]);</div><div class="line">register reg6(q6,datain1,clk,reset,regen[<span class="number">6</span>]);</div><div class="line">register reg7(q7,datain1,clk,reset,regen[<span class="number">7</span>]);</div><div class="line">register reg8(q8,datain1,clk,reset,regen[<span class="number">8</span>]);</div><div class="line">register reg9(q9,datain1,clk,reset,regen[<span class="number">9</span>]);</div><div class="line">register reg10(q10,datain1,clk,reset,regen[<span class="number">10</span>]);</div><div class="line">register reg11(q11,datain1,clk,reset,regen[<span class="number">11</span>]);</div><div class="line">register reg12(q12,datain1,clk,reset,regen[<span class="number">12</span>]);</div><div class="line">register reg13(q13,datain1,clk,reset,regen[<span class="number">13</span>]);</div><div class="line">register reg14(q14,datain1,clk,reset,regen[<span class="number">14</span>]);</div><div class="line">register reg15(q15,datain1,clk,reset,regen[<span class="number">15</span>]);</div><div class="line">register reg16(q16,datain1,clk,reset,regen[<span class="number">16</span>]);</div><div class="line">register reg17(q17,datain1,clk,reset,regen[<span class="number">17</span>]);</div><div class="line">register reg18(q18,datain1,clk,reset,regen[<span class="number">18</span>]);</div><div class="line">register reg19(q19,datain1,clk,reset,regen[<span class="number">19</span>]);</div><div class="line">register reg20(q20,datain1,clk,reset,regen[<span class="number">20</span>]);</div><div class="line">register reg21(q21,datain1,clk,reset,regen[<span class="number">21</span>]);</div><div class="line">register reg22(q22,datain1,clk,reset,regen[<span class="number">22</span>]);</div><div class="line">register reg23(q23,datain1,clk,reset,regen[<span class="number">23</span>]);</div><div class="line">register reg24(q24,datain1,clk,reset,regen[<span class="number">24</span>]);</div><div class="line">register reg25(q25,datain1,clk,reset,regen[<span class="number">25</span>]);</div><div class="line">register reg26(q26,datain1,clk,reset,regen[<span class="number">26</span>]);</div><div class="line">register reg27(q27,datain1,clk,reset,regen[<span class="number">27</span>]);</div><div class="line">register reg28(q28,datain1,clk,reset,regen[<span class="number">28</span>]);</div><div class="line">register reg29(q29,datain1,clk,reset,regen[<span class="number">29</span>]);</div><div class="line">register reg30(q30,datain1,clk,reset,regen[<span class="number">30</span>]);</div><div class="line">register reg31(q31,datain1,clk,reset,regen[<span class="number">31</span>]);</div><div class="line">mux_32 mux0(dataout,q0,q1,q2,q3,q4,q5,q6,q7,q8,q9,q10,q11,q12,q13,q14,q15,q16,q17,q18,q19,q20,q21,q22,q23,q24,q25,q26,q27,q28,q29,q30,q31,address);</div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> TOP_test;</div><div class="line"><span class="keyword">reg</span> clk,rst,start,memwe;</div><div class="line"><span class="keyword">reg</span> [<span class="number">31</span>:<span class="number">0</span>] memin;</div><div class="line"><span class="keyword">reg</span> [<span class="number">4</span>:<span class="number">0</span>] memaddr;</div><div class="line"><span class="keyword">wire</span> zero,n,v,c;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] dataout;</div><div class="line">TOP u(clk,rst,start,memwe,memin,memaddr,zero,n,v,c,dataout);</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk=~clk;</div><div class="line"><span class="keyword">initial</span></div><div class="line">  <span class="keyword">begin</span></div><div class="line">     clk=<span class="number">1</span>;</div><div class="line">     rst=<span class="number">0</span>;</div><div class="line">     start=<span class="number">0</span>;</div><div class="line">#<span class="number">20</span>  rst=<span class="number">1</span>;<span class="comment">//test reset       </span></div><div class="line">#<span class="number">100</span> rst=<span class="number">0</span>; <span class="comment">//load instruction and data to memory.</span></div><div class="line">     memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'b001000_00000_11111_0000000000010000</span>; <span class="comment">//load r0,r31,16</span></div><div class="line">     memaddr=<span class="number">5'd0</span>;</div><div class="line">#<span class="number">100</span> memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'b001001_00000_11111_0000000000010001</span>; <span class="comment">//store r0,r31,17</span></div><div class="line">     memaddr=<span class="number">5'd1</span>;</div><div class="line">#<span class="number">100</span> memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'b001000_00001_11111_0000000000010001</span>; <span class="comment">//load r1,r31,17</span></div><div class="line">     memaddr=<span class="number">5'd2</span>;</div><div class="line">#<span class="number">100</span> memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'b000001_00010_00000_0101010101010101</span>;</div><div class="line"><span class="comment">//andi r2,r0,16'b0101010101010101</span></div><div class="line">     memaddr=<span class="number">5'd3</span>;</div><div class="line">#<span class="number">100</span> memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'b000101_00011_00010_0000000000001011</span>;</div><div class="line"><span class="comment">//addi r3,r2,16'b0000000000001011</span></div><div class="line">     memaddr=<span class="number">5'd4</span>;</div><div class="line">#<span class="number">100</span> memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'b001100_11111111111111111111111011</span>;</div><div class="line"><span class="comment">//branch -5</span></div><div class="line">     memaddr=<span class="number">5'd5</span>;     </div><div class="line">#<span class="number">100</span> memwe=<span class="number">1</span>;</div><div class="line">     memin=<span class="number">32'hFFFF_FFFF</span>;</div><div class="line"><span class="comment">//load data to memory </span></div><div class="line">     memaddr=<span class="number">5'd16</span>;</div><div class="line"><span class="comment">//start to execuit instructions.</span></div><div class="line">#<span class="number">100</span> memwe=<span class="number">0</span>;</div><div class="line">     start=<span class="number">1</span>;</div><div class="line">#<span class="number">100</span> start=<span class="number">0</span>;</div><div class="line">#<span class="number">10000</span> <span class="built_in">$stop</span>;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p>注意：测试的完备性。</p>
<p><strong>4、将设计文件和测试文件输入Modesim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://mengze.top/[O]基于FPGA的RISC_CPU的设计与实现/" title="【O】基于FPGA的RISC_CPU的设计与实现" target="_blank" rel="external">https://mengze.top/[O]基于FPGA的RISC_CPU的设计与实现/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本站所有文章除特别声明外，均遵循 <u><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a></u> 及 <u><a href="https://mengze.top/MZ-ATY_VCJS/" target="_blank" rel="external">MZ-ATY VCJS</a></u> 协议。转载请附上原文出处链接和本声明。
    </li>
  </ul>
</blockquote>

    </div>
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/[K]MarkDown常用语法_转/" title="【K】MarkDown常用语法_转"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/[O]MengZe初代博客A1/" title="【O】MengZe初代博客A1"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,qzone,wechat,douban,linkedin" data-mobile-sites="weibo,qq,qzone,wechat,douban,linkedin"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
    
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/AaronTYin" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/6148427895" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
        
        &copy; 2017-2020 <a href="https://mengze.top">MengZeATY</a>
        
        <div class="publishby">
            <p>Theme <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a> by <a href="https://github.com/cofess" target="_blank"> cofess </a><br>
            Hosted by <a href="https://pages.coding.me" style="font-weight: bold" rel="external nofollow">Coding Pages</a></p>
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.min.js"></script>
<script src="/js/application.js"></script>

    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>





   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   


  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    $('article img').not('[hidden]').not('.panel-body img').each(function() {
      var $image = $(this);
      var imageCaption = $image.attr('alt');
      var $imageWrapLink = $image.parent('a');
      if ($imageWrapLink.length < 1) {
        var src = this.getAttribute('src');
        var idx = src.lastIndexOf('?');
        if (idx != -1) {
          src = src.substring(0, idx);
        }
        $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
      }
      $imageWrapLink.attr('data-fancybox', 'images');
      if (imageCaption) {
        $imageWrapLink.attr('data-caption', imageCaption);
      }
    });
    $().fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
    });
  });
  </script>





</body>
</html>