<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>【O】VLSI设计之AES密码处理器 | MengZeATY</title>
  <meta name="description" content="VLSI设计之AES密码处理器">
<meta name="keywords" content="mengze,梦泽,Verilog,VLSI,AES,密码,FPAG">
<meta property="og:type" content="article">
<meta property="og:title" content="【O】VLSI设计之AES密码处理器">
<meta property="og:url" content="https://mengze.top/[O]VLSI设计之AES密码处理器/index.html">
<meta property="og:site_name" content="Meng Ze">
<meta property="og:description" content="VLSI设计之AES密码处理器">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/11.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/12.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/13.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/14.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/15.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/16.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/17.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/18.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/19.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/20.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/21.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/22.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/23.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/24.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/25.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/26.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/27.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/28.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/29.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/30.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/31.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/32.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/33.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/34.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/35.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/36.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/37.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/221.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/222.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/223.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/224.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/331.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/332.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/333.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/334.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/333.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/333.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/333.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/333.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/333.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/335.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/336.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/337.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/338.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/339.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/3310.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/3311.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/3312.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/3313.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/3314.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/551.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/552.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/553.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/554.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/555.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/556.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/557.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/558.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/559.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/5510.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/5511.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/5512.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/5513.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/5514.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/5515.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/661.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/662.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/663.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/664.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/665.png">
<meta property="og:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/771.png">
<meta property="og:updated_time" content="2020-08-02T09:37:26.859Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【O】VLSI设计之AES密码处理器">
<meta name="twitter:description" content="VLSI设计之AES密码处理器">
<meta name="twitter:image" content="https://mengze.top/sourcefile/[O]VLSI设计之AES密码处理器/11.png">
  <!-- Canonical links -->
  <link rel="canonical" href="https://mengze.top/[O]VLSI设计之AES密码处理器/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Meng Ze" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/MZ_White.png" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css">
  
  
  
    <link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet">
  
  
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://mengze.top">
          <img class="img-circle img-rotate" src="/images/head.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">MengZeATY</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Dream Founder &amp; Creator</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Qingdao, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-emotion">
          <a href="/[S]心情随笔/">
            
            <i class="icon icon-jiaju"></i>
            
            <span class="menu-title">随笔</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-essay">
          <a href="/[S]手记编程设计/">
            
            <i class="icon icon-time"></i>
            
            <span class="menu-title">手记</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tools">
          <a href="/[O]小工具集/">
            
            <i class="icon icon-plus"></i>
            
            <span class="menu-title">工具</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-resume">
          <a href="/sourcefile/Resume/resume.html">
            
            <i class="icon icon-starfish"></i>
            
            <span class="menu-title">简历</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-more"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/AaronTYin" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/6148427895" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <b>　　网站全面改版进行中，自此所有内容的首发均放于本站，更新动态发布于微博-<a href="https://weibo.com/7489247069" target="_blank" style="color:darkorchid;">MengZeATY</a>，视频依托于BiliBili-<a href="https://space.bilibili.com/270805824/" target="_blank" style="color:darkorchid;">MengZeATY</a>，感谢大家的支持和等待，mengze.top即将开启新的征程，希望为大家带来更加完善的精彩。</b>
            </div>
        </div>
    </div>
</div>

    
      

    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/FPGA/">FPGA</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web开发/">Web开发</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/书影感评/">书影感评</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图影设计/">图影设计</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基本学识/">基本学识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生物医学/">生物医学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/站内页面/">站内页面</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程算法/">编程算法</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自然科学/">自然科学</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/语言积累/">语言积累</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔短文/">随笔短文</a><span class="tag-list-count">3</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/FPGA/" style="font-size: 13.63px;">FPGA</a> <a href="/tags/Web开发/" style="font-size: 13.63px;">Web开发</a> <a href="/tags/书影感评/" style="font-size: 13.38px;">书影感评</a> <a href="/tags/图影设计/" style="font-size: 14px;">图影设计</a> <a href="/tags/基本学识/" style="font-size: 13px;">基本学识</a> <a href="/tags/嵌入式/" style="font-size: 13.25px;">嵌入式</a> <a href="/tags/生物医学/" style="font-size: 13.13px;">生物医学</a> <a href="/tags/站内页面/" style="font-size: 13.63px;">站内页面</a> <a href="/tags/编程算法/" style="font-size: 13.88px;">编程算法</a> <a href="/tags/自然科学/" style="font-size: 13.75px;">自然科学</a> <a href="/tags/语言积累/" style="font-size: 13.5px;">语言积累</a> <a href="/tags/随笔短文/" style="font-size: 13.25px;">随笔短文</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/">2026</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">17</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">50</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">21</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/">2016</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#AES密码处理器体系结构设计"><span class="toc-number">1.</span> <span class="toc-text">AES密码处理器体系结构设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实验目的"><span class="toc-number">1.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实验内容"><span class="toc-number">1.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、实验环境"><span class="toc-number">1.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、实验步骤"><span class="toc-number">1.4.</span> <span class="toc-text">四、实验步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、AES算法学习和分析"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、AES算法学习和分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-AES的加密过程"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">1.1 AES的加密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-AES的解密过程"><span class="toc-number">1.4.1.2.</span> <span class="toc-text">1.2 AES的解密过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-AES的密钥扩展过程"><span class="toc-number">1.4.1.3.</span> <span class="toc-text">1.3 AES的密钥扩展过程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、AES密码处理器的体系结构设计"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、AES密码处理器的体系结构设计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-AES密码处理器框图及外部信号说明"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">2.1 AES密码处理器框图及外部信号说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-AES密码处理器体系结构"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">2.2 AES密码处理器体系结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3密钥扩展子模块体系结构"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">2.3密钥扩展子模块体系结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4加密-解密子模块体系结构"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">2.4加密/解密子模块体系结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5控制子模块体系结构"><span class="toc-number">1.4.2.5.</span> <span class="toc-text">2.5控制子模块体系结构</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、实验总结"><span class="toc-number">1.5.</span> <span class="toc-text">五、实验总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES密码处理器密钥扩展模块设计与仿真"><span class="toc-number">2.</span> <span class="toc-text">AES密码处理器密钥扩展模块设计与仿真</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实验目的-1"><span class="toc-number">2.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实验内容-1"><span class="toc-number">2.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、实验环境-1"><span class="toc-number">2.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、实验步骤-1"><span class="toc-number">2.4.</span> <span class="toc-text">四、实验步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、实验结果"><span class="toc-number">2.5.</span> <span class="toc-text">五、实验结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、实验结论"><span class="toc-number">2.6.</span> <span class="toc-text">六、实验结论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES密码处理器加密-解密模块设计与仿真"><span class="toc-number">3.</span> <span class="toc-text">AES密码处理器加密/解密模块设计与仿真</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实验目的-2"><span class="toc-number">3.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实验内容-2"><span class="toc-number">3.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、实验环境-2"><span class="toc-number">3.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、实验步骤-2"><span class="toc-number">3.4.</span> <span class="toc-text">四、实验步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、实验结果-1"><span class="toc-number">3.5.</span> <span class="toc-text">五、实验结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、实验结论-1"><span class="toc-number">3.6.</span> <span class="toc-text">六、实验结论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES密码处理器控制模块的设计与仿真"><span class="toc-number">4.</span> <span class="toc-text">AES密码处理器控制模块的设计与仿真</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实验目的-3"><span class="toc-number">4.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实验内容-3"><span class="toc-number">4.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、实验环境-3"><span class="toc-number">4.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、实验步骤-3"><span class="toc-number">4.4.</span> <span class="toc-text">四、实验步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、实验结果-2"><span class="toc-number">4.5.</span> <span class="toc-text">五、实验结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、实验结论-2"><span class="toc-number">4.6.</span> <span class="toc-text">六、实验结论</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES密码处理器的系统集成与仿真"><span class="toc-number">5.</span> <span class="toc-text">AES密码处理器的系统集成与仿真</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实验目的-4"><span class="toc-number">5.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实验内容-4"><span class="toc-number">5.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、实验环境-4"><span class="toc-number">5.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、实验步骤-4"><span class="toc-number">5.4.</span> <span class="toc-text">四、实验步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、实验结果-3"><span class="toc-number">5.5.</span> <span class="toc-text">五、实验结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、实验结论-3"><span class="toc-number">5.6.</span> <span class="toc-text">六、实验结论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七、推荐测试数据"><span class="toc-number">5.7.</span> <span class="toc-text">七、推荐测试数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES密码处理器综合优化与仿真分析"><span class="toc-number">6.</span> <span class="toc-text">AES密码处理器综合优化与仿真分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#一、实验目的-5"><span class="toc-number">6.1.</span> <span class="toc-text">一、实验目的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二、实验内容-5"><span class="toc-number">6.2.</span> <span class="toc-text">二、实验内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三、实验环境-5"><span class="toc-number">6.3.</span> <span class="toc-text">三、实验环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四、实验步骤-5"><span class="toc-number">6.4.</span> <span class="toc-text">四、实验步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五、实验结果-4"><span class="toc-number">6.5.</span> <span class="toc-text">五、实验结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六、实验结论-4"><span class="toc-number">6.6.</span> <span class="toc-text">六、实验结论</span></a></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-[O]VLSI设计之AES密码处理器" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      【O】VLSI设计之AES密码处理器
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/[O]VLSI设计之AES密码处理器/" class="article-date">
	  <time datetime="2018-06-05T16:00:00.000Z" itemprop="datePublished">2018-06-06</time>
	</a>
</span>
        
        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/FPGA/">FPGA</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/[O]VLSI设计之AES密码处理器/#comments" class="article-comment-link">评论</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 32.3k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 176(分)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <hr>
<a id="more"></a>
<p>　　<a href="https://github.com/AaronTYin/0-HDL-VLSI_lab" target="_blank" rel="external">Github：0-HDL-VLSI_lab</a></p>
<blockquote>
<p>　　本文整理自青岛科技大学信息学院集成专业或微电子学院曲老师讲课实验，本着学术分享的精神发布此文，请勿用于商业用途，具体声明见文末，若侵删。</p>
</blockquote>
<h1 id="AES密码处理器体系结构设计"><a href="#AES密码处理器体系结构设计" class="headerlink" title="AES密码处理器体系结构设计"></a>AES密码处理器体系结构设计</h1><h2 id="一、实验目的"><a href="#一、实验目的" class="headerlink" title="一、实验目的"></a>一、实验目的</h2><p>　　理解并掌握AES算法的细节，提出一个AES 密码处理器的体系结构设计方案。</p>
<h2 id="二、实验内容"><a href="#二、实验内容" class="headerlink" title="二、实验内容"></a>二、实验内容</h2><p>　　1、学习AES算法，理解并掌握AES算法的原理、结构、流程及其需要的基本运算。<br>　　2、在对算法进行深入分析的基础上，提出一个AES密码处理器的体系结构设计方案。方案中应该包括以下内容：AES密码处理器外部信号说明、AES密码处理器由哪些子模块构成、各个子模块的功能说明、各子模块之间的相互关系与信号连接，各个子模块如何协调配合完成加/解密的原理和机制。除用语言描述之外，还要求用图和表格加以说明。</p>
<h2 id="三、实验环境"><a href="#三、实验环境" class="headerlink" title="三、实验环境"></a>三、实验环境</h2><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h2 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h2><h3 id="1、AES算法学习和分析"><a href="#1、AES算法学习和分析" class="headerlink" title="1、AES算法学习和分析"></a>1、AES算法学习和分析</h3><h4 id="1-1-AES的加密过程"><a href="#1-1-AES的加密过程" class="headerlink" title="1.1 AES的加密过程"></a>1.1 AES的加密过程</h4><p>　　AES的加密过程可以用下面的伪语言代码描述：<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Cipher(plaintext,ciphertext,CiperKey) &#123;</div><div class="line">    <span class="comment">//初始化</span></div><div class="line">    State = plaintext；</div><div class="line">    KeyExpansion(CipherKey, ExpandedKey)；</div><div class="line">    <span class="comment">//生成扩展密钥ExpandedKey</span></div><div class="line">    AddRoundKey(State, ExpandedKey)；</div><div class="line">    <span class="comment">//前Nr – 1轮</span></div><div class="line">    <span class="keyword">for</span>(r=<span class="number">1</span>;r&lt;Nr;r++)&#123;</div><div class="line">        SubBytes(State)；</div><div class="line">        ShiftRow(State)；</div><div class="line">        MixColumn(State)；</div><div class="line">        AddRoundKey(State, ExpandedKey)；</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//最后一轮</span></div><div class="line">    SubBytes(State)；</div><div class="line">    ShiftRow(State)；</div><div class="line">    AddRoundKey(State, ExpandedKey)；</div><div class="line">    Ciphertext = state；</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>　　其中plaintext是输入明文，可以定义成plaintext[4×Nb]数组；ciphertext是输出密文，可以定义成ciphertext[4×Nb]数组；CipherKey是加密密钥，可以定义成CipherKey[4×Nk]数组；圈密钥ExpandedKey可表示成w[Nb×(Nr+1)]数组；State是状态，整个加密过程都是针对State进行的。</p>
<p><strong>(1)S盒变换 SubBytes()</strong><br>　　S盒变换又称字节替代变换，是一个针对字节的非线性、可逆变换。它将状态中的每一个字节进行非线性变换转换为另一个字节，作用在状态上每个字节的变换可以表示为SubBytes(state)。可以将变换SubBytes()对各种可能字节的变换结果排成一个表，如表2-3所示，该表称为AES的S盒。通过查表可以直接得到SubBytes()的输出，这样可以加快程序执行的速度。如果状态中的一个字节为xy，则S盒中第x行第y列的字节就是SubBytes()的输出。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/11.png" alt=""><br><strong>(2)行移位变换 ShiftRows()</strong><br>　　行移位是将状态阵列的各行进行循环移位，不同状态行的位移量不同。第0行不移位，保持不变，第1行移动C1个字节，第2行移动C2个字节，第3行移动C3个字节。C1，C2，C3值依赖于分组长度Nb的大小。位移量C1、C2和C3与分组长度Nb有关，如下表：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/12.png" alt=""><br>　　在AES加密标准中Nb=4。</p>
<p><strong>(3)列混合变换MixColumns()</strong><br>　　列混合变换是对一个状态逐列进行变换，它将一个状态的每一列视为有限域GF(2<sup>8</sup>)上的一个多项式。<br>　　令<img src="/sourcefile/[O]VLSI设计之AES密码处理器/13.png" alt=""><img src="/sourcefile/[O]VLSI设计之AES密码处理器/14.png" alt=""><br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/15.png" alt=""><img src="/sourcefile/[O]VLSI设计之AES密码处理器/16.png" alt=""></p>
<!--s<sub>c</sub>(x)=s<sub>3c</sub>x<sup>3</sup>+s<sub>2c</sub>x<sup>2</sup>+s<sub>1c</sub>x+s<sub>0c</sub>
　　s<sup>'</sup><sub>c</sub>(x)=s<sup>'</sup><sub>3c</sub>x<sup>3</sup>+s<sup>'</sup><sub>2c</sub>x<sup>2</sup>+s<sup>'</sup><sub>1c</sub>x+s<sup>'</sup><sub>0c</sub>-->
<p>　　则<img src="/sourcefile/[O]VLSI设计之AES密码处理器/17.png" alt=""><img src="/sourcefile/[O]VLSI设计之AES密码处理器/18.png" alt=""><br>　　其中，<img src="/sourcefile/[O]VLSI设计之AES密码处理器/19.png" alt="">，是AES选择的一个逆元多项式，<img src="/sourcefile/[O]VLSI设计之AES密码处理器/20.png" alt="">表示模<img src="/sourcefile/[O]VLSI设计之AES密码处理器/21.png" alt="">乘法。<br>　　将<img src="/sourcefile/[O]VLSI设计之AES密码处理器/22.png" alt="">表示为矩阵乘法：<br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/23.png" alt="">（2-3）<br>　　相乘之后每一列的结果如下：<br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/24.png" alt=""><br><strong>(4)轮密钥加AddRoundKey()变换</strong><br>　　轮密钥加是将轮密钥简单地与状态矩阵进行逐比特异或运算。每个轮密钥由密钥扩展算法得到，轮密钥的长度为Nb个字。轮密钥按顺序取自扩展密钥ExpandedKey，扩展密钥是由原始密钥经过扩展后得到的，扩展密钥的长度为Nb(Nr+1)个字。</p>
<h4 id="1-2-AES的解密过程"><a href="#1-2-AES的解密过程" class="headerlink" title="1.2 AES的解密过程"></a>1.2 AES的解密过程</h4><p>　　AES解密过程是加密过程的逆过程，可用伪代码描述为：<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">InvCipher(<span class="keyword">byte</span> in[<span class="number">4</span>*<span class="number">4</span>],<span class="keyword">byte</span> out[<span class="number">4</span>*<span class="number">4</span>],word w[<span class="number">4</span>*(Nr+<span class="number">1</span>)])</div><div class="line">  Begin</div><div class="line">    Byte state[<span class="number">4</span>,<span class="number">4</span>]</div><div class="line">    State=in</div><div class="line">    AddRoundKey(state, w[Nr*<span class="number">4</span>，(Nr+<span class="number">1</span>)*<span class="number">4</span>-<span class="number">1</span>])</div><div class="line">    For round= Nr-<span class="number">1</span> step -<span class="number">1</span> to <span class="number">1</span></div><div class="line">      InvShiftRows(state)</div><div class="line">      InvSubBytes(state)</div><div class="line">      AddRoundKey(state,w[round*<span class="number">4</span>,(round+<span class="number">1</span>)*<span class="number">4</span>-<span class="number">1</span>])</div><div class="line">      InvMixColumns(state)</div><div class="line">    End <span class="keyword">for</span></div><div class="line">    InvShiftRows(state)</div><div class="line">    InvSubBytes(state)</div><div class="line">    AddRoundKey(state, w[<span class="number">0</span>,<span class="number">3</span>])</div><div class="line">    Out=state</div><div class="line">  End</div></pre></td></tr></table></figure></p>
<p><strong>(1) 逆字节变换（InvSubBytes）</strong><br>　　逆字节替换InvSubBytes是字节替换SubBytes的逆变换,它与SubBytes变换的运算过程刚好相反，通过如下两步实现：首先进行与SubBytes相同的仿射变换的逆变换，最后求其逆。<br>　　同样的，InvSubBytes也可以用S盒查找表的方式实现，该查找表被称为逆S盒，如表2-3所示。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/25.png" alt=""><br><strong>(2) 逆行移位变换（InvShiftRows）</strong><br>　　逆行移位变换InvShiftRows是行移位变换ShiftRows的逆过程。即状态矩阵的后3行依次左循环移动3，2，1个字节，如下图所示。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/26.png" alt=""><br><strong>(3) 逆列混合变换（InvMixColumns）</strong><br>　　逆列混合变换InvMixColumns与列混合变换MixColumns相似，只是固定多项式变为a(x)的逆a-1(x) ，则a-1(x)= {0b}x3+{0d}x2+{09}x+{0e}。<br>　　同样基于以上的状态转换，解密运算的InvMixColumns可以表示为式2-3。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/27.png" alt=""></p>
<h4 id="1-3-AES的密钥扩展过程"><a href="#1-3-AES的密钥扩展过程" class="headerlink" title="1.3 AES的密钥扩展过程"></a>1.3 AES的密钥扩展过程</h4><p>　　AES算法得到初始密钥K后，首先经过一个密钥扩展过程以产生所有的轮密钥。密钥扩展共产生Nb ( Nr+1 )个字，算法初始需要一个Nb个字的集合，接着每个轮操作都需要Nb个字的密钥数据。最终的密钥流程共包含了一个4字节字的线性数组，用[w<sub>i</sub>]表示，<img src="/sourcefile/[O]VLSI设计之AES密码处理器/28.png" alt="">。<br>　　扩展密钥程序涉及RotWord()、SubWord()和Rcon()模块。它们的工作方式如下：<br>　　(1) 位置变换RotWord()：把一个4字节的输入序列（a0，a1，a2，a3）循环左移一个字节后输出。例如将（a0，a1，a2，a3）循环左移一个字节后输出为（a1，a2，a3，a0）。<br>　　(2) SubWord()：把一个4字节的输入序列（a0，a1，a2，a3）的每一个字节进行S盒变换，然后作为输出。<br>　　(3) 变换Rcon[]：Rcon[]是一个10个字节的常量数组，Rcon[i]是一个32比特字符串（x<sup>i-1</sup>,00,00,00）。这里x=(02)，x<sup>i-1</sup>是x=(02)的（i-1）次幂的十六进制表示，即 x<sup>0</sup>=(01),x=(02),x<sup>i</sup>={02}·x<sup>i-1</sup>。这里“·”表示有限域GF(2<sup>8</sup>)中的乘法。<br>　　密钥扩展前Nk个字就是外部密钥CipherKey，以后的字w[i]等于它前一个字w[i-1]与前Nk个字w[i-Nk]的异或，w[i] =w[i-Nk]⊕SubWord(RotWord(w[i-1]))⊕Rcon[i/Nk]。<br>　　输入密钥扩展的整个过程可以用下面的程序段描述：<br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">KeyExpansion(<span class="keyword">byte</span> key[<span class="number">4</span>*NK]，word w[Nb*(Nr+<span class="number">1</span>)]，Nk)</div><div class="line"><span class="keyword">begin</span></div><div class="line">  word  temp</div><div class="line">   i=<span class="number">0</span></div><div class="line">   <span class="keyword">while</span> (i &lt; Nk)</div><div class="line">          w[i]=word(key[<span class="number">4</span> * i]，]key[<span class="number">4</span> * i+<span class="number">1</span>]，key[<span class="number">4</span> * i+<span class="number">2</span>]，key[<span class="number">4</span> * i+<span class="number">3</span>]</div><div class="line">          i = i+<span class="number">1</span></div><div class="line">        <span class="keyword">end</span> <span class="keyword">while</span></div><div class="line">        i = Nk</div><div class="line">        <span class="keyword">while</span> (i &lt; Nb * (Nr+<span class="number">1</span>))</div><div class="line">             temp = w[i - <span class="number">1</span>]</div><div class="line">             <span class="keyword">if</span> ( i mod Nk = <span class="number">0</span> )</div><div class="line">               temp = Subword(Rotword(temp)) <span class="keyword">xor</span> Rcon[i/Nk]</div><div class="line">             <span class="keyword">else</span> <span class="keyword">if</span> (Nk &gt; <span class="number">6</span> <span class="keyword">and</span> i mod Nk = <span class="number">4</span>)</div><div class="line">             temp = Subword (temp)</div><div class="line">             <span class="keyword">end</span> <span class="keyword">if</span></div><div class="line">             w [i] = w[i - Nk] <span class="keyword">xor</span> temp</div><div class="line">             i = i +<span class="number">1</span></div><div class="line">           <span class="keyword">end</span> <span class="keyword">while</span></div><div class="line">        <span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<h3 id="2、AES密码处理器的体系结构设计"><a href="#2、AES密码处理器的体系结构设计" class="headerlink" title="2、AES密码处理器的体系结构设计"></a>2、AES密码处理器的体系结构设计</h3><h4 id="2-1-AES密码处理器框图及外部信号说明"><a href="#2-1-AES密码处理器框图及外部信号说明" class="headerlink" title="2.1 AES密码处理器框图及外部信号说明"></a>2.1 AES密码处理器框图及外部信号说明</h4><p><img src="/sourcefile/[O]VLSI设计之AES密码处理器/29.png" alt=""><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/30.png" alt=""></p>
<h4 id="2-2-AES密码处理器体系结构"><a href="#2-2-AES密码处理器体系结构" class="headerlink" title="2.2 AES密码处理器体系结构"></a>2.2 AES密码处理器体系结构</h4><p>　　AES模块包括明/密文和密钥寄存器、密钥扩展、加/解密运算、控制等多个子模块，其系统结构图如下图所示。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/31.png" alt=""><br>　　明文/密文/密钥寄存器是一个128位的寄存器，用于保存从外部输入的明文/密文/密钥。为了与USB接口芯片的数据总线宽度相匹配，其输入数据宽度定为16位，为了提高AES模块内部的处理速度，同时为了与AES分组长度相匹配，其输出数据的宽度定为128位。<br>　　其详细功能描述如下：在时钟信号clk的上升沿，若寄存器写使能信号write有效，则将输入数据总线din上的16位数据写入明文/密文/密钥寄存器的高16位，同时将寄存器原来的数据右移16位放入寄存器的低112位。若寄存器写使能信号write无效，则寄存器保持原来的数据不变。由此可见，1个128位的数据需要经过8个时钟周期，通过8次写操作才能装入寄存器。</p>
<h4 id="2-3密钥扩展子模块体系结构"><a href="#2-3密钥扩展子模块体系结构" class="headerlink" title="2.3密钥扩展子模块体系结构"></a>2.3密钥扩展子模块体系结构</h4><p>　　电路结构如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/32.png" alt=""><br>　　密钥扩展模块的外部信号如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/33.png" alt=""><br>　　密钥扩展模块由1个128位的轮密钥寄存器rndkreg、1个11*128的轮密钥寄存器堆rndkrf、1个轮常数产生模块rcon、1个字节代替模块subword、1个32位的循环左移移位器rotword、1个128位的二选一选通器MUX以及5个32位异或器构成。<br>　　其电路工作原理如下：<br>　　在进行密钥扩展之前，首先令复位信号rst=1,以便使轮常数产生模块输出第1个轮常数。<br>　　然后，在第1个时钟周期，通过选通器选择种子密钥key作为第1个子密钥，并在本周期结束时的时钟上升沿，将其同时保存到轮密钥寄存器rndkreg和轮密钥寄存器堆rndkrf。<br>　　在第2个时钟周期，对保存在轮密钥寄存器rndkreg中的第1个子密钥先后进行循环左移、字节代替变换、异或、选通操作得到第2个子密钥，并在本周期结束时的时钟上升沿，将其同时保存到轮密钥寄存器rndkreg和轮密钥寄存器堆rndkrf。<br>　　重复第2个时钟周期的操作10次，就可以得到AES第1-10轮迭代所需要的轮密钥。<br>　　这样，经过11个时钟周期之后，AES加密/解密所需的全部11个子密钥就都产生出来了，并且被保存在轮密钥寄存器堆rndkrf中。<br>　　其中，循环左移运算实现对一个32位的数据循环左移8位，在电路实现时通过硬件连线即可实现，无须设计专门的移位电路。<br>　　字节代替变换由4个8*8 S盒实现，S盒采用查表方式实现。为了充分利用cyclone FPGA中的RAM资源，减少LE（逻辑单元）的使用数量，我们利用cyclone FPGA中的RAM构建了一个8*8的ROM作为S盒，该ROM共有256个的存储单元，每个存储单元存储一个字节，这256个字节就是实现S盒变换的查找表。该ROM可以利用quartus II的megafunction工具自动生成，但需要注意的是该ROM的地址要经寄存器锁存以后才能进入ROM，因此在地址有效的下一个周期才能在ROM的输出端口得到读出的数据。<br>　　二选一选通器MUX用于选择外部输入的种子密钥或者内部逻辑产生的数据作为子密钥。<br>　　轮密钥寄存器rndkreg是1个128位的寄存器，用于暂时保存当前产生的子密钥，以便产生下一个子密钥时使用。<br>　　轮密钥寄存器堆rndkrf共有11个128位的存储单元，用于保存密钥扩展以后的全部11个子密钥，供AES加密/解密使用。<br>　　轮常数产生模块rcon由1个8位寄存器和轮常数产生逻辑构成，当复位时，寄存器输出第一个轮常数，当轮常数寄存器写使能信号rconen有效时，将由轮常数产生逻辑产生的下一个轮常数写入轮常数寄存器。</p>
<h4 id="2-4加密-解密子模块体系结构"><a href="#2-4加密-解密子模块体系结构" class="headerlink" title="2.4加密/解密子模块体系结构"></a>2.4加密/解密子模块体系结构</h4><p>　　电路结构图：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/34.png" alt=""><br>　　AES加密/解密模块的外部信号如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/35.png" alt=""><br>　　AES加密算法和解密算法所使用的变换大多相同或相似，因此其电路结构也非常类似，有很多资源可以共享。为了减少电路规模，我们采用一套电路分时实现AES加密和解密。<br>　　AES加密过程由一个初始密钥加(异或)变换和十个轮变换构成，其中除第10个轮变换外，每个轮变换都是一样的，都是由字节代替(S盒变换)、行移位、列混合、密钥加4个子变换组成，第10个轮变换由字节代替、行移位、密钥加3个子变换组成，不包括列混合变换。<br>　　为了进一步减少电路的规模，我们仅实现一个轮变换的电路，用循环迭代的方式实现十轮变换。<br>　　AES加密/解密模块的工作原理如下：<br>　　（1）加密流程：首先将S盒配置为加密S盒，即在使能信号wrsben和地址信号wrsbaddr的控制下，通过S盒配置数据端口sbdata将加密S盒配置数据写入16个S盒sbox0~sbox15。然后实现初始密钥加变换，即在选择信号keyadsel的控制下，通过四选一选通器选择外部输入明文数据intxt，与初始子密钥roundkey进行异或操作，并在选择信号reginsel的控制下，通过二选一选通器将异或操作的结果e0~e15保存到S盒的输入寄存器。接下来进行第一轮加密变换，即初始密钥加变换的结果经sbox0~sbox15完成S盒变换后，在选择信号mixsel的控制下，通过二选一选通器进入byte0203模块，完成02乘字节和03乘字节运算，然后进行（5）式中前4项的异或运算，得结果c0~c15, 在选择信号keyadsel的控制下，通过四选一选通器选择c0~c15与第一轮子密钥进行异或操作，从而得到第一轮加密变换的结果e0~e15，并将其保存到S盒的输入寄存器，作为下一轮加密变换的输入数据。依次类推，可以完成第1-9轮加密变换。最后进行第10轮加密变换，即第9轮加密变换变换的结果经sbox0~sbox15完成S盒变换后，在选择信号keyadsel的控制下，通过四选一选通器选择恰当的S盒输出与第10轮子密钥进行异或操作，即可得到密文，最后将其保存到结果寄存器resultreg。初始密钥加变换和每轮加密变换都在一个周期内完成，因此上述加密过程共需要11个时钟周期。<br>　　（2）解密流程：首先将S盒配置为解密S盒，配置过程与加密S盒配置过程一样，只是配置数据不同。然后实现初始密钥加变换，即在选择信号keyadsel的控制下，通过四选一选通器选择外部输入密文数据intxt，与初始子密钥roundkey进行异或操作，并在选择信号reginsel的控制下，通过二选一选通器将异或操作的结果e0~e15保存到S盒的输入寄存器。接下来进行第一轮解密变换，即初始密钥加变换的结果经sbox0~sbox15完成逆S盒变换后，再与第一轮子密钥进行异或操作，然后在选择信号mixsel的控制下，通过二选一选通器进入byte0203模块和byte9bde模块，完成进行逆列混合变换所需要的字节乘法运算（即09乘字节、0b乘字节、0d乘字节和0e乘字节），然后通过一系列异或运算得列混合变换的结果g0~g15, 在选择信号reginsel的控制下，通过二选一选通器选择g0~g15输出，从而得到第一轮解密变换的结果h，并将其保存到S盒的输入寄存器，作为下一轮解密变换的输入数据。依次类推，可以完成第1-9轮解密变换。最后进行第10轮解密变换，即第9轮加密变换变换的结果经sbox0~sbox15完成逆S盒变换后，在选择信号keyadsel的控制下，通过四选一选通器选择恰当的S盒输出与第10轮子密钥进行异或操作，即可得到明文，最后将其保存到结果寄存器resultreg。初始密钥加变换和每轮解密变换都在一个周期内完成，因此上述解密过程共需要11个时钟周期。需要注意的是，解密过程使用的子密钥与加密过程使用的子密钥相同，但使用顺序恰好相反。</p>
<h4 id="2-5控制子模块体系结构"><a href="#2-5控制子模块体系结构" class="headerlink" title="2.5控制子模块体系结构"></a>2.5控制子模块体系结构</h4><p>　AES控制模块由密钥扩展状态机、加密状态机、解密状态机以及其它少量组合逻辑构成。<br>　　其中密钥扩展状态机用于控制密钥扩展过程的执行，加密状态机用于控制加密过程的执行，解密状态机用于控制解密过程的执行。<br>　　AES控制模块的电路结构图如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/36.png" alt=""><br>　　AES控制模块的外部信号表：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/37.png" alt=""></p>
<h2 id="五、实验总结"><a href="#五、实验总结" class="headerlink" title="五、实验总结"></a>五、实验总结</h2><p>　　通过这次实验，理解并掌握了AES算法的细节，提出了一个AES 密码处理器的体系结构设计方案，建立了RTL Verilog模型，进行了功能仿真、综合、布局布线、静态时序分析及时序仿真。<br>　　通过学习在算法上了解了AES加密算法，在各模块设计上用伪代码进行设计，最后用Verilog硬件描述语言进行详细设计</p>
<h1 id="AES密码处理器密钥扩展模块设计与仿真"><a href="#AES密码处理器密钥扩展模块设计与仿真" class="headerlink" title="AES密码处理器密钥扩展模块设计与仿真"></a>AES密码处理器密钥扩展模块设计与仿真</h1><h2 id="一、实验目的-1"><a href="#一、实验目的-1" class="headerlink" title="一、实验目的"></a>一、实验目的</h2><p>　　掌握AES密码处理器的密钥扩展模块的设计方法。</p>
<h2 id="二、实验内容-1"><a href="#二、实验内容-1" class="headerlink" title="二、实验内容"></a>二、实验内容</h2><p>　　1、利用Verilog HDL设计AES密码处理器的密钥扩展模块。<br>　　2、利用Modelsim仿真软件对所设计AES密码处理器的密钥扩展模块进行功能仿真。</p>
<h2 id="三、实验环境-1"><a href="#三、实验环境-1" class="headerlink" title="三、实验环境"></a>三、实验环境</h2><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h2 id="四、实验步骤-1"><a href="#四、实验步骤-1" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h2><p><strong>1、电路结构设计</strong><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/221.png" alt=""><br>　　密钥扩展模块的外部信号如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/222.png" alt=""><br>　　密钥扩展模块由1个128位的轮密钥寄存器rndkreg、1个11*128的轮密钥寄存器堆rndkrf、1个轮常数产生模块rcon、1个字节代替模块subword、1个32位的循环左移移位器rotword、1个128位的二选一选通器MUX以及5个32位异或器构成。<br>　　其电路工作原理如下：<br>　　在进行密钥扩展之前，首先令复位信号rst=1,以便使轮常数产生模块输出第1个轮常数。<br>　　然后，在第1个时钟周期，通过选通器选择种子密钥key作为第1个子密钥，并在本周期结束时的时钟上升沿，将其同时保存到轮密钥寄存器rndkreg和轮密钥寄存器堆rndkrf。<br>　　在第2个时钟周期，对保存在轮密钥寄存器rndkreg中的第1个子密钥先后进行循环左移、字节代替变换、异或、选通操作得到第2个子密钥，并在本周期结束时的时钟上升沿，将其同时保存到轮密钥寄存器rndkreg和轮密钥寄存器堆rndkrf。<br>　　重复第2个时钟周期的操作10次，就可以得到AES第1-10轮迭代所需要的轮密钥。<br>　　这样，经过11个时钟周期之后，AES加密/解密所需的全部11个子密钥就都产生出来了，并且被保存在轮密钥寄存器堆rndkrf中。<br>　　其中，循环左移运算实现对一个32位的数据循环左移8位，在电路实现时通过硬件连线即可实现，无须设计专门的移位电路。<br>　　字节代替变换由4个8*8 S盒实现，S盒采用查表方式实现。为了充分利用cyclone FPGA中的RAM资源，减少LE（逻辑单元）的使用数量，我们利用cyclone FPGA中的RAM构建了一个8*8的ROM作为S盒，该ROM共有256个的存储单元，每个存储单元存储一个字节，这256个字节就是实现S盒变换的查找表。该ROM可以利用quartus II的megafunction工具自动生成，但需要注意的是该ROM的地址要经寄存器锁存以后才能进入ROM，因此在地址有效的下一个周期才能在ROM的输出端口得到读出的数据。<br>　　二选一选通器MUX用于选择外部输入的种子密钥或者内部逻辑产生的数据作为子密钥。<br>　　轮密钥寄存器rndkreg是1个128位的寄存器，用于暂时保存当前产生的子密钥，以便产生下一个子密钥时使用。<br>　　轮密钥寄存器堆rndkrf共有11个128位的存储单元，用于保存密钥扩展以后的全部11个子密钥，供AES加密/解密使用。<br>　　轮常数产生模块rcon由1个8位寄存器和轮常数产生逻辑构成，当复位时，寄存器输出第一个轮常数，当轮常数寄存器写使能信号rconen有效时，将由轮常数产生逻辑产生的下一个轮常数写入轮常数寄存器。<br><strong>2、建立Verilog模型</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> keyexp(clk,rst,keysel,rndkren,wrrndkrf,addr,rconen,key,rndkrfout);</div><div class="line"><span class="keyword">output</span>[<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">input</span> clk,rst,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">input</span>[<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">input</span>[<span class="number">127</span>:<span class="number">0</span>] key;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] rndkey,rndkrout,rndkrfout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w4,w5,w6,w7,rotword,subword,xorrcon;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"></div><div class="line"><span class="keyword">assign</span> rndkey=(keysel==<span class="number">0</span>) ? key:&#123;w4,w5,w6,w7&#125;;</div><div class="line">reg_128 rndkreg(clk,rndkren,rndkey,rndkrout);</div><div class="line">rndkrf rndkrf(clk,wrrndkrf,addr,rndkey,rndkrfout);</div><div class="line"></div><div class="line"><span class="keyword">assign</span> rotword=&#123;rndkrout[<span class="number">23</span>:<span class="number">0</span>],rndkrout[<span class="number">31</span>:<span class="number">24</span>]&#125;;</div><div class="line">sbox_mux sbox0(rotword[<span class="number">31</span>:<span class="number">24</span>],subword[<span class="number">31</span>:<span class="number">24</span>]);</div><div class="line">sbox_mux sbox1(rotword[<span class="number">23</span>:<span class="number">16</span>],subword[<span class="number">23</span>:<span class="number">16</span>]);</div><div class="line">sbox_mux sbox2(rotword[<span class="number">15</span>:<span class="number">8</span>],subword[<span class="number">15</span>:<span class="number">8</span>]);</div><div class="line">sbox_mux sbox3(rotword[<span class="number">7</span>:<span class="number">0</span>],subword[<span class="number">7</span>:<span class="number">0</span>]);</div><div class="line"></div><div class="line">rcon rcon(clk,rst,rconen,rconout);</div><div class="line"><span class="keyword">assign</span> xorrcon=subword^&#123;rconout,<span class="number">24'h000000</span>&#125;;</div><div class="line"><span class="keyword">assign</span> w4=xorrcon^rndkrout[<span class="number">127</span>:<span class="number">96</span>];</div><div class="line"><span class="keyword">assign</span> w5=w4^rndkrout[<span class="number">95</span>:<span class="number">64</span>];</div><div class="line"><span class="keyword">assign</span> w6=w5^rndkrout[<span class="number">63</span>:<span class="number">32</span>];</div><div class="line"><span class="keyword">assign</span> w7=w6^rndkrout[<span class="number">31</span>:<span class="number">0</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> reg_128(clk,write,din,dout);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">input</span>  clk,write;</div><div class="line"><span class="keyword">input</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">          <span class="keyword">if</span>(write)</div><div class="line">            dout&lt;=din;</div><div class="line">          <span class="keyword">else</span></div><div class="line">            dout&lt;=dout;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> rcon(clk,rst,write,rconout);</div><div class="line"><span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"><span class="keyword">input</span>  clk,rst,write;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">  <span class="keyword">begin</span></div><div class="line">  <span class="keyword">if</span>(rst)</div><div class="line">    rconout&lt;=<span class="number">8'h01</span>;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(write)</div><div class="line">     rconout&lt;=(rconout[<span class="number">7</span>]==<span class="number">0</span>)? (rconout&lt;&lt;<span class="number">1</span>):((rconout&lt;&lt;<span class="number">1</span>)^&#123;<span class="number">8'h1b</span>&#125;);</div><div class="line">  <span class="keyword">else</span></div><div class="line">     rconout&lt;=rconout;</div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> rndkrf(clk,wrrndkrf,addr,rndkey,rndkrfout);</div><div class="line"><span class="keyword">input</span> clk,wrrndkrf;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] rndkey;</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">reg</span> [<span class="number">10</span>:<span class="number">0</span>] decout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">10</span>:<span class="number">0</span>] write_reg;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] reg0out,reg1out,reg2out,reg3out,reg4out,reg5out,reg6out,reg7out,reg8out,reg9out,reg10out;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">always</span> @ (addr)</div><div class="line">  <span class="keyword">case</span>(addr)</div><div class="line">    <span class="number">4'd0</span>: decout=<span class="number">11'b000_0000_0001</span>;</div><div class="line">    <span class="number">4'd1</span>: decout=<span class="number">11'b000_0000_0010</span>;</div><div class="line">    <span class="number">4'd2</span>: decout=<span class="number">11'b000_0000_0100</span>;</div><div class="line">    <span class="number">4'd3</span>: decout=<span class="number">11'b000_0000_1000</span>;</div><div class="line">    <span class="number">4'd4</span>: decout=<span class="number">11'b000_0001_0000</span>;</div><div class="line">    <span class="number">4'd5</span>: decout=<span class="number">11'b000_0010_0000</span>;</div><div class="line">    <span class="number">4'd6</span>: decout=<span class="number">11'b000_0100_0000</span>;</div><div class="line">    <span class="number">4'd7</span>: decout=<span class="number">11'b000_1000_0000</span>;</div><div class="line">    <span class="number">4'd8</span>: decout=<span class="number">11'b001_0000_0000</span>;</div><div class="line">    <span class="number">4'd9</span>: decout=<span class="number">11'b010_0000_0000</span>;</div><div class="line">    <span class="number">4'd10</span>: decout=<span class="number">11'b100_0000_0000</span>;</div><div class="line">    <span class="keyword">default</span>: decout=<span class="number">11'b000_0000_0000</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">assign</span> write_reg=decout &amp; &#123;wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf&#125;;</div><div class="line">reg_128 reg0(clk,write_reg[<span class="number">0</span>],rndkey,reg0out);</div><div class="line">reg_128 reg1(clk,write_reg[<span class="number">1</span>],rndkey,reg1out);</div><div class="line">reg_128 reg2(clk,write_reg[<span class="number">2</span>],rndkey,reg2out);</div><div class="line">reg_128 reg3(clk,write_reg[<span class="number">3</span>],rndkey,reg3out);</div><div class="line">reg_128 reg4(clk,write_reg[<span class="number">4</span>],rndkey,reg4out);</div><div class="line">reg_128 reg5(clk,write_reg[<span class="number">5</span>],rndkey,reg5out);</div><div class="line">reg_128 reg6(clk,write_reg[<span class="number">6</span>],rndkey,reg6out);</div><div class="line">reg_128 reg7(clk,write_reg[<span class="number">7</span>],rndkey,reg7out);</div><div class="line">reg_128 reg8(clk,write_reg[<span class="number">8</span>],rndkey,reg8out);</div><div class="line">reg_128 reg9(clk,write_reg[<span class="number">9</span>],rndkey,reg9out);</div><div class="line">reg_128 reg10(clk,write_reg[<span class="number">10</span>],rndkey,reg10out);</div><div class="line"><span class="keyword">always</span> @(addr <span class="keyword">or</span> reg0out <span class="keyword">or</span> reg1out <span class="keyword">or</span> reg2out <span class="keyword">or</span> reg3out <span class="keyword">or</span> reg4out <span class="keyword">or</span> reg5out <span class="keyword">or</span> reg6out <span class="keyword">or</span> reg7out <span class="keyword">or</span> reg8out <span class="keyword">or</span> reg9out <span class="keyword">or</span> reg10out)</div><div class="line">  <span class="keyword">case</span>(addr)</div><div class="line">    <span class="number">4'd0</span>: rndkrfout=reg0out;</div><div class="line">    <span class="number">4'd1</span>: rndkrfout=reg1out;</div><div class="line">    <span class="number">4'd2</span>: rndkrfout=reg2out;</div><div class="line">    <span class="number">4'd3</span>: rndkrfout=reg3out;</div><div class="line">    <span class="number">4'd4</span>: rndkrfout=reg4out;</div><div class="line">    <span class="number">4'd5</span>: rndkrfout=reg5out;</div><div class="line">    <span class="number">4'd6</span>: rndkrfout=reg6out;</div><div class="line">    <span class="number">4'd7</span>: rndkrfout=reg7out;</div><div class="line">    <span class="number">4'd8</span>: rndkrfout=reg8out;</div><div class="line">    <span class="number">4'd9</span>: rndkrfout=reg9out;</div><div class="line">    <span class="number">4'd10</span>: rndkrfout=reg10out;</div><div class="line">    <span class="keyword">default</span>: rndkrfout=reg10out;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> sbox_mux(in,out);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] out;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] in;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] out;</div><div class="line"><span class="keyword">always</span>@(in)</div><div class="line">  <span class="keyword">case</span>(in)</div><div class="line">    <span class="number">8'h00</span>: out=<span class="number">8'h63</span>;</div><div class="line">    <span class="number">8'h01</span>: out=<span class="number">8'h7c</span>;</div><div class="line">    <span class="number">8'h02</span>: out=<span class="number">8'h77</span>;</div><div class="line">    <span class="number">8'h03</span>: out=<span class="number">8'h7b</span>;</div><div class="line">    <span class="number">8'h04</span>: out=<span class="number">8'hf2</span>;</div><div class="line">    <span class="number">8'h05</span>: out=<span class="number">8'h6b</span>;</div><div class="line">    <span class="number">8'h06</span>: out=<span class="number">8'h6f</span>;</div><div class="line">    <span class="number">8'h07</span>: out=<span class="number">8'hc5</span>;</div><div class="line">    <span class="number">8'h08</span>: out=<span class="number">8'h30</span>;</div><div class="line">    <span class="number">8'h09</span>: out=<span class="number">8'h01</span>;</div><div class="line">    <span class="number">8'h0a</span>: out=<span class="number">8'h67</span>;</div><div class="line">    <span class="number">8'h0b</span>: out=<span class="number">8'h2b</span>;</div><div class="line">    <span class="number">8'h0c</span>: out=<span class="number">8'hfe</span>;</div><div class="line">    <span class="number">8'h0d</span>: out=<span class="number">8'hd7</span>;</div><div class="line">    <span class="number">8'h0e</span>: out=<span class="number">8'hab</span>;</div><div class="line">    <span class="number">8'h0f</span>: out=<span class="number">8'h76</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h10</span>: out=<span class="number">8'hca</span>;</div><div class="line">    <span class="number">8'h11</span>: out=<span class="number">8'h82</span>;</div><div class="line">    <span class="number">8'h12</span>: out=<span class="number">8'hc9</span>;</div><div class="line">    <span class="number">8'h13</span>: out=<span class="number">8'h7d</span>;</div><div class="line">    <span class="number">8'h14</span>: out=<span class="number">8'hfa</span>;</div><div class="line">    <span class="number">8'h15</span>: out=<span class="number">8'h59</span>;</div><div class="line">    <span class="number">8'h16</span>: out=<span class="number">8'h47</span>;</div><div class="line">    <span class="number">8'h17</span>: out=<span class="number">8'hf0</span>;</div><div class="line">    <span class="number">8'h18</span>: out=<span class="number">8'had</span>;</div><div class="line">    <span class="number">8'h19</span>: out=<span class="number">8'hd4</span>;</div><div class="line">    <span class="number">8'h1a</span>: out=<span class="number">8'ha2</span>;</div><div class="line">    <span class="number">8'h1b</span>: out=<span class="number">8'haf</span>;</div><div class="line">    <span class="number">8'h1c</span>: out=<span class="number">8'h9c</span>;</div><div class="line">    <span class="number">8'h1d</span>: out=<span class="number">8'ha4</span>;</div><div class="line">    <span class="number">8'h1e</span>: out=<span class="number">8'h72</span>;</div><div class="line">    <span class="number">8'h1f</span>: out=<span class="number">8'hc0</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h20</span>: out=<span class="number">8'hb7</span>;</div><div class="line">    <span class="number">8'h21</span>: out=<span class="number">8'hfd</span>;</div><div class="line">    <span class="number">8'h22</span>: out=<span class="number">8'h93</span>;</div><div class="line">    <span class="number">8'h23</span>: out=<span class="number">8'h26</span>;</div><div class="line">    <span class="number">8'h24</span>: out=<span class="number">8'h36</span>;</div><div class="line">    <span class="number">8'h25</span>: out=<span class="number">8'h3f</span>;</div><div class="line">    <span class="number">8'h26</span>: out=<span class="number">8'hf7</span>;</div><div class="line">    <span class="number">8'h27</span>: out=<span class="number">8'hcc</span>;</div><div class="line">    <span class="number">8'h28</span>: out=<span class="number">8'h34</span>;</div><div class="line">    <span class="number">8'h29</span>: out=<span class="number">8'ha5</span>;</div><div class="line">    <span class="number">8'h2a</span>: out=<span class="number">8'he5</span>;</div><div class="line">    <span class="number">8'h2b</span>: out=<span class="number">8'hf1</span>;</div><div class="line">    <span class="number">8'h2c</span>: out=<span class="number">8'h71</span>;</div><div class="line">    <span class="number">8'h2d</span>: out=<span class="number">8'hd8</span>;</div><div class="line">    <span class="number">8'h2e</span>: out=<span class="number">8'h31</span>;</div><div class="line">    <span class="number">8'h2f</span>: out=<span class="number">8'h15</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h30</span>: out=<span class="number">8'h04</span>;</div><div class="line">    <span class="number">8'h31</span>: out=<span class="number">8'hc7</span>;</div><div class="line">    <span class="number">8'h32</span>: out=<span class="number">8'h23</span>;</div><div class="line">    <span class="number">8'h33</span>: out=<span class="number">8'hc3</span>;</div><div class="line">    <span class="number">8'h34</span>: out=<span class="number">8'h18</span>;</div><div class="line">    <span class="number">8'h35</span>: out=<span class="number">8'h96</span>;</div><div class="line">    <span class="number">8'h36</span>: out=<span class="number">8'h05</span>;</div><div class="line">    <span class="number">8'h37</span>: out=<span class="number">8'h9a</span>;</div><div class="line">    <span class="number">8'h38</span>: out=<span class="number">8'h07</span>;</div><div class="line">    <span class="number">8'h39</span>: out=<span class="number">8'h12</span>;</div><div class="line">    <span class="number">8'h3a</span>: out=<span class="number">8'h80</span>;</div><div class="line">    <span class="number">8'h3b</span>: out=<span class="number">8'he2</span>;</div><div class="line">    <span class="number">8'h3c</span>: out=<span class="number">8'heb</span>;</div><div class="line">    <span class="number">8'h3d</span>: out=<span class="number">8'h27</span>;</div><div class="line">    <span class="number">8'h3e</span>: out=<span class="number">8'hb2</span>;</div><div class="line">    <span class="number">8'h3f</span>: out=<span class="number">8'h75</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h40</span>: out=<span class="number">8'h09</span>;</div><div class="line">    <span class="number">8'h41</span>: out=<span class="number">8'h83</span>;</div><div class="line">    <span class="number">8'h42</span>: out=<span class="number">8'h2c</span>;</div><div class="line">    <span class="number">8'h43</span>: out=<span class="number">8'h1a</span>;</div><div class="line">    <span class="number">8'h44</span>: out=<span class="number">8'h1b</span>;</div><div class="line">    <span class="number">8'h45</span>: out=<span class="number">8'h6e</span>;</div><div class="line">    <span class="number">8'h46</span>: out=<span class="number">8'h5a</span>;</div><div class="line">    <span class="number">8'h47</span>: out=<span class="number">8'ha0</span>;</div><div class="line">    <span class="number">8'h48</span>: out=<span class="number">8'h52</span>;</div><div class="line">    <span class="number">8'h49</span>: out=<span class="number">8'h3b</span>;</div><div class="line">    <span class="number">8'h4a</span>: out=<span class="number">8'hd6</span>;</div><div class="line">    <span class="number">8'h4b</span>: out=<span class="number">8'hb3</span>;</div><div class="line">    <span class="number">8'h4c</span>: out=<span class="number">8'h29</span>;</div><div class="line">    <span class="number">8'h4d</span>: out=<span class="number">8'he3</span>;</div><div class="line">    <span class="number">8'h4e</span>: out=<span class="number">8'h2f</span>;</div><div class="line">    <span class="number">8'h4f</span>: out=<span class="number">8'h84</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h50</span>: out=<span class="number">8'h53</span>;</div><div class="line">    <span class="number">8'h51</span>: out=<span class="number">8'hd1</span>;</div><div class="line">    <span class="number">8'h52</span>: out=<span class="number">8'h00</span>;</div><div class="line">    <span class="number">8'h53</span>: out=<span class="number">8'hed</span>;</div><div class="line">    <span class="number">8'h54</span>: out=<span class="number">8'h20</span>;</div><div class="line">    <span class="number">8'h55</span>: out=<span class="number">8'hfc</span>;</div><div class="line">    <span class="number">8'h56</span>: out=<span class="number">8'hb1</span>;</div><div class="line">    <span class="number">8'h57</span>: out=<span class="number">8'h5b</span>;</div><div class="line">    <span class="number">8'h58</span>: out=<span class="number">8'h6a</span>;</div><div class="line">    <span class="number">8'h59</span>: out=<span class="number">8'hcb</span>;</div><div class="line">    <span class="number">8'h5a</span>: out=<span class="number">8'hbe</span>;</div><div class="line">    <span class="number">8'h5b</span>: out=<span class="number">8'h39</span>;</div><div class="line">    <span class="number">8'h5c</span>: out=<span class="number">8'h4a</span>;</div><div class="line">    <span class="number">8'h5d</span>: out=<span class="number">8'h4c</span>;</div><div class="line">    <span class="number">8'h5e</span>: out=<span class="number">8'h58</span>;</div><div class="line">    <span class="number">8'h5f</span>: out=<span class="number">8'hcf</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h60</span>: out=<span class="number">8'hd0</span>;</div><div class="line">    <span class="number">8'h61</span>: out=<span class="number">8'hef</span>;</div><div class="line">    <span class="number">8'h62</span>: out=<span class="number">8'haa</span>;</div><div class="line">    <span class="number">8'h63</span>: out=<span class="number">8'hfb</span>;</div><div class="line">    <span class="number">8'h64</span>: out=<span class="number">8'h43</span>;</div><div class="line">    <span class="number">8'h65</span>: out=<span class="number">8'h4d</span>;</div><div class="line">    <span class="number">8'h66</span>: out=<span class="number">8'h33</span>;</div><div class="line">    <span class="number">8'h67</span>: out=<span class="number">8'h85</span>;</div><div class="line">    <span class="number">8'h68</span>: out=<span class="number">8'h45</span>;</div><div class="line">    <span class="number">8'h69</span>: out=<span class="number">8'hf9</span>;</div><div class="line">    <span class="number">8'h6a</span>: out=<span class="number">8'h02</span>;</div><div class="line">    <span class="number">8'h6b</span>: out=<span class="number">8'h7f</span>;</div><div class="line">    <span class="number">8'h6c</span>: out=<span class="number">8'h50</span>;</div><div class="line">    <span class="number">8'h6d</span>: out=<span class="number">8'h3c</span>;</div><div class="line">    <span class="number">8'h6e</span>: out=<span class="number">8'h9f</span>;</div><div class="line">    <span class="number">8'h6f</span>: out=<span class="number">8'ha8</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h70</span>: out=<span class="number">8'h51</span>;</div><div class="line">    <span class="number">8'h71</span>: out=<span class="number">8'ha3</span>;</div><div class="line">    <span class="number">8'h72</span>: out=<span class="number">8'h40</span>;</div><div class="line">    <span class="number">8'h73</span>: out=<span class="number">8'h8f</span>;</div><div class="line">    <span class="number">8'h74</span>: out=<span class="number">8'h92</span>;</div><div class="line">    <span class="number">8'h75</span>: out=<span class="number">8'h9d</span>;</div><div class="line">    <span class="number">8'h76</span>: out=<span class="number">8'h38</span>;</div><div class="line">    <span class="number">8'h77</span>: out=<span class="number">8'hf5</span>;</div><div class="line">    <span class="number">8'h78</span>: out=<span class="number">8'hbc</span>;</div><div class="line">    <span class="number">8'h79</span>: out=<span class="number">8'hb6</span>;</div><div class="line">    <span class="number">8'h7a</span>: out=<span class="number">8'hda</span>;</div><div class="line">    <span class="number">8'h7b</span>: out=<span class="number">8'h21</span>;</div><div class="line">    <span class="number">8'h7c</span>: out=<span class="number">8'h10</span>;</div><div class="line">    <span class="number">8'h7d</span>: out=<span class="number">8'hff</span>;</div><div class="line">    <span class="number">8'h7e</span>: out=<span class="number">8'hf3</span>;</div><div class="line">    <span class="number">8'h7f</span>: out=<span class="number">8'hd2</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h80</span>: out=<span class="number">8'hcd</span>;</div><div class="line">    <span class="number">8'h81</span>: out=<span class="number">8'h0c</span>;</div><div class="line">    <span class="number">8'h82</span>: out=<span class="number">8'h13</span>;</div><div class="line">    <span class="number">8'h83</span>: out=<span class="number">8'hec</span>;</div><div class="line">    <span class="number">8'h84</span>: out=<span class="number">8'h5f</span>;</div><div class="line">    <span class="number">8'h85</span>: out=<span class="number">8'h97</span>;</div><div class="line">    <span class="number">8'h86</span>: out=<span class="number">8'h44</span>;</div><div class="line">    <span class="number">8'h87</span>: out=<span class="number">8'h17</span>;</div><div class="line">    <span class="number">8'h88</span>: out=<span class="number">8'hc4</span>;</div><div class="line">    <span class="number">8'h89</span>: out=<span class="number">8'ha7</span>;</div><div class="line">    <span class="number">8'h8a</span>: out=<span class="number">8'h7e</span>;</div><div class="line">    <span class="number">8'h8b</span>: out=<span class="number">8'h3d</span>;</div><div class="line">    <span class="number">8'h8c</span>: out=<span class="number">8'h64</span>;</div><div class="line">    <span class="number">8'h8d</span>: out=<span class="number">8'h5d</span>;</div><div class="line">    <span class="number">8'h8e</span>: out=<span class="number">8'h19</span>;</div><div class="line">    <span class="number">8'h8f</span>: out=<span class="number">8'h73</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h90</span>: out=<span class="number">8'h60</span>;</div><div class="line">    <span class="number">8'h91</span>: out=<span class="number">8'h81</span>;</div><div class="line">    <span class="number">8'h92</span>: out=<span class="number">8'h4f</span>;</div><div class="line">    <span class="number">8'h93</span>: out=<span class="number">8'hdc</span>;</div><div class="line">    <span class="number">8'h94</span>: out=<span class="number">8'h22</span>;</div><div class="line">    <span class="number">8'h95</span>: out=<span class="number">8'h2a</span>;</div><div class="line">    <span class="number">8'h96</span>: out=<span class="number">8'h90</span>;</div><div class="line">    <span class="number">8'h97</span>: out=<span class="number">8'h88</span>;</div><div class="line">    <span class="number">8'h98</span>: out=<span class="number">8'h46</span>;</div><div class="line">    <span class="number">8'h99</span>: out=<span class="number">8'hee</span>;</div><div class="line">    <span class="number">8'h9a</span>: out=<span class="number">8'hb8</span>;</div><div class="line">      <span class="number">8'h9b</span>: out=<span class="number">8'h14</span>;</div><div class="line">    <span class="number">8'h9c</span>: out=<span class="number">8'hde</span>;</div><div class="line">    <span class="number">8'h9d</span>: out=<span class="number">8'h5e</span>;</div><div class="line">    <span class="number">8'h9e</span>: out=<span class="number">8'h0b</span>;</div><div class="line">    <span class="number">8'h9f</span>: out=<span class="number">8'hdb</span>;</div><div class="line"></div><div class="line">    <span class="number">8'ha0</span>: out=<span class="number">8'he0</span>;</div><div class="line">    <span class="number">8'ha1</span>: out=<span class="number">8'h32</span>;</div><div class="line">    <span class="number">8'ha2</span>: out=<span class="number">8'h3a</span>;</div><div class="line">    <span class="number">8'ha3</span>: out=<span class="number">8'h0a</span>;</div><div class="line">    <span class="number">8'ha4</span>: out=<span class="number">8'h49</span>;</div><div class="line">    <span class="number">8'ha5</span>: out=<span class="number">8'h06</span>;</div><div class="line">    <span class="number">8'ha6</span>: out=<span class="number">8'h24</span>;</div><div class="line">    <span class="number">8'ha7</span>: out=<span class="number">8'h5c</span>;</div><div class="line">    <span class="number">8'ha8</span>: out=<span class="number">8'hc2</span>;</div><div class="line">    <span class="number">8'ha9</span>: out=<span class="number">8'hd3</span>;</div><div class="line">    <span class="number">8'haa</span>: out=<span class="number">8'hac</span>;</div><div class="line">    <span class="number">8'hab</span>: out=<span class="number">8'h62</span>;</div><div class="line">    <span class="number">8'hac</span>: out=<span class="number">8'h91</span>;</div><div class="line">    <span class="number">8'had</span>: out=<span class="number">8'h95</span>;</div><div class="line">    <span class="number">8'hae</span>: out=<span class="number">8'he4</span>;</div><div class="line">    <span class="number">8'haf</span>: out=<span class="number">8'h79</span>;</div><div class="line"></div><div class="line">    <span class="number">8'hb0</span>: out=<span class="number">8'he7</span>;</div><div class="line">    <span class="number">8'hb1</span>: out=<span class="number">8'hc8</span>;</div><div class="line">    <span class="number">8'hb2</span>: out=<span class="number">8'h37</span>;</div><div class="line">    <span class="number">8'hb3</span>: out=<span class="number">8'h6d</span>;</div><div class="line">    <span class="number">8'hb4</span>: out=<span class="number">8'h8d</span>;</div><div class="line">    <span class="number">8'hb5</span>: out=<span class="number">8'hd5</span>;</div><div class="line">    <span class="number">8'hb6</span>: out=<span class="number">8'h4e</span>;</div><div class="line">    <span class="number">8'hb7</span>: out=<span class="number">8'ha9</span>;</div><div class="line">    <span class="number">8'hb8</span>: out=<span class="number">8'h6c</span>;</div><div class="line">    <span class="number">8'hb9</span>: out=<span class="number">8'h56</span>;</div><div class="line">    <span class="number">8'hba</span>: out=<span class="number">8'hf4</span>;</div><div class="line">    <span class="number">8'hbb</span>: out=<span class="number">8'hea</span>;</div><div class="line">    <span class="number">8'hbc</span>: out=<span class="number">8'h65</span>;</div><div class="line">    <span class="number">8'hbd</span>: out=<span class="number">8'h7a</span>;</div><div class="line">    <span class="number">8'hbe</span>: out=<span class="number">8'hae</span>;</div><div class="line">    <span class="number">8'hbf</span>: out=<span class="number">8'h08</span>;</div><div class="line"></div><div class="line">    <span class="number">8'hc0</span>: out=<span class="number">8'hba</span>;</div><div class="line">    <span class="number">8'hc1</span>: out=<span class="number">8'h78</span>;</div><div class="line">    <span class="number">8'hc2</span>: out=<span class="number">8'h25</span>;</div><div class="line">    <span class="number">8'hc3</span>: out=<span class="number">8'h2e</span>;</div><div class="line">    <span class="number">8'hc4</span>: out=<span class="number">8'h1c</span>;</div><div class="line">    <span class="number">8'hc5</span>: out=<span class="number">8'ha6</span>;</div><div class="line">    <span class="number">8'hc6</span>: out=<span class="number">8'hb4</span>;</div><div class="line">    <span class="number">8'hc7</span>: out=<span class="number">8'hc6</span>;</div><div class="line">    <span class="number">8'hc8</span>: out=<span class="number">8'he8</span>;</div><div class="line">    <span class="number">8'hc9</span>: out=<span class="number">8'hdd</span>;</div><div class="line">    <span class="number">8'hca</span>: out=<span class="number">8'h74</span>;</div><div class="line">    <span class="number">8'hcb</span>: out=<span class="number">8'h1f</span>;</div><div class="line">    <span class="number">8'hcc</span>: out=<span class="number">8'h4b</span>;</div><div class="line">    <span class="number">8'hcd</span>: out=<span class="number">8'hbd</span>;</div><div class="line">    <span class="number">8'hce</span>: out=<span class="number">8'h8b</span>;</div><div class="line">    <span class="number">8'hcf</span>: out=<span class="number">8'h8a</span>;</div><div class="line"></div><div class="line">    <span class="number">8'hd0</span>: out=<span class="number">8'h70</span>;</div><div class="line">    <span class="number">8'hd1</span>: out=<span class="number">8'h3e</span>;</div><div class="line">    <span class="number">8'hd2</span>: out=<span class="number">8'hb5</span>;</div><div class="line">    <span class="number">8'hd3</span>: out=<span class="number">8'h66</span>;</div><div class="line">    <span class="number">8'hd4</span>: out=<span class="number">8'h48</span>;</div><div class="line">    <span class="number">8'hd5</span>: out=<span class="number">8'h03</span>;</div><div class="line">    <span class="number">8'hd6</span>: out=<span class="number">8'hf6</span>;</div><div class="line">    <span class="number">8'hd7</span>: out=<span class="number">8'h0e</span>;</div><div class="line">    <span class="number">8'hd8</span>: out=<span class="number">8'h61</span>;</div><div class="line">    <span class="number">8'hd9</span>: out=<span class="number">8'h35</span>;</div><div class="line">    <span class="number">8'hda</span>: out=<span class="number">8'h57</span>;</div><div class="line">    <span class="number">8'hdb</span>: out=<span class="number">8'hb9</span>;</div><div class="line">    <span class="number">8'hdc</span>: out=<span class="number">8'h86</span>;</div><div class="line">    <span class="number">8'hdd</span>: out=<span class="number">8'hc1</span>;</div><div class="line">    <span class="number">8'hde</span>: out=<span class="number">8'h1d</span>;</div><div class="line">    <span class="number">8'hdf</span>: out=<span class="number">8'h9e</span>;</div><div class="line"></div><div class="line">    <span class="number">8'he0</span>: out=<span class="number">8'he1</span>;</div><div class="line">    <span class="number">8'he1</span>: out=<span class="number">8'hf8</span>;</div><div class="line">    <span class="number">8'he2</span>: out=<span class="number">8'h98</span>;</div><div class="line">    <span class="number">8'he3</span>: out=<span class="number">8'h11</span>;</div><div class="line">    <span class="number">8'he4</span>: out=<span class="number">8'h69</span>;</div><div class="line">    <span class="number">8'he5</span>: out=<span class="number">8'hd9</span>;</div><div class="line">    <span class="number">8'he6</span>: out=<span class="number">8'h8e</span>;</div><div class="line">    <span class="number">8'he7</span>: out=<span class="number">8'h94</span>;</div><div class="line">    <span class="number">8'he8</span>: out=<span class="number">8'h9b</span>;</div><div class="line">    <span class="number">8'he9</span>: out=<span class="number">8'h1e</span>;</div><div class="line">    <span class="number">8'hea</span>: out=<span class="number">8'h87</span>;</div><div class="line">    <span class="number">8'heb</span>: out=<span class="number">8'he9</span>;</div><div class="line">    <span class="number">8'hec</span>: out=<span class="number">8'hce</span>;</div><div class="line">    <span class="number">8'hed</span>: out=<span class="number">8'h55</span>;</div><div class="line">    <span class="number">8'hee</span>: out=<span class="number">8'h28</span>;</div><div class="line">    <span class="number">8'hef</span>: out=<span class="number">8'hdf</span>;</div><div class="line"></div><div class="line">    <span class="number">8'hf0</span>: out=<span class="number">8'h8c</span>;</div><div class="line">    <span class="number">8'hf1</span>: out=<span class="number">8'ha1</span>;</div><div class="line">    <span class="number">8'hf2</span>: out=<span class="number">8'h89</span>;</div><div class="line">    <span class="number">8'hf3</span>: out=<span class="number">8'h0d</span>;</div><div class="line">    <span class="number">8'hf4</span>: out=<span class="number">8'hbf</span>;</div><div class="line">    <span class="number">8'hf5</span>: out=<span class="number">8'he6</span>;</div><div class="line">    <span class="number">8'hf6</span>: out=<span class="number">8'h42</span>;</div><div class="line">    <span class="number">8'hf7</span>: out=<span class="number">8'h68</span>;</div><div class="line">    <span class="number">8'hf8</span>: out=<span class="number">8'h41</span>;</div><div class="line">    <span class="number">8'hf9</span>: out=<span class="number">8'h99</span>;</div><div class="line">    <span class="number">8'hfa</span>: out=<span class="number">8'h2d</span>;</div><div class="line">    <span class="number">8'hfb</span>: out=<span class="number">8'h0f</span>;</div><div class="line">    <span class="number">8'hfc</span>: out=<span class="number">8'hb0</span>;</div><div class="line">    <span class="number">8'hfd</span>: out=<span class="number">8'h54</span>;</div><div class="line">    <span class="number">8'hfe</span>: out=<span class="number">8'hbb</span>;</div><div class="line">    <span class="number">8'hff</span>: out=<span class="number">8'h16</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> keyexp_tb;</div><div class="line"><span class="keyword">wire</span>[<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">reg</span> clk,rst,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] key;</div><div class="line"></div><div class="line">keyexp  kexp(clk,rst,keysel,rndkren,wrrndkrf,addr,rconen,key,rndkrfout);</div><div class="line"></div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        #<span class="number">20</span>  rst=<span class="number">1</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             keysel=<span class="number">0</span>;</div><div class="line">             rndkren=<span class="number">1</span>;</div><div class="line">             wrrndkrf=<span class="number">1</span>;</div><div class="line">             addr=<span class="number">4'd0</span>;</div><div class="line">             rconen=<span class="number">0</span>;</div><div class="line">             key=<span class="number">128'h2b7e1516_28aed2a6_abf71588_09cf4f3c</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd1</span>;</div><div class="line">             rconen=<span class="number">1</span>;</div><div class="line">             keysel=<span class="number">1</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd2</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd3</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd4</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd5</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd6</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd7</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd8</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd9</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd10</span>;</div><div class="line"></div><div class="line">    #<span class="number">100</span> rndkren=<span class="number">0</span>;</div><div class="line">             wrrndkrf=<span class="number">0</span>;</div><div class="line">             rconen=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd0</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd1</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd2</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd3</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd4</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd5</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd6</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd7</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd8</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd9</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd10</span>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">        #<span class="number">1020</span> rst=<span class="number">1</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             keysel=<span class="number">0</span>;</div><div class="line">             rndkren=<span class="number">1</span>;</div><div class="line">             wrrndkrf=<span class="number">1</span>;</div><div class="line">             addr=<span class="number">4'd0</span>;</div><div class="line">             rconen=<span class="number">0</span>;</div><div class="line">             key=<span class="number">128'ha32bf2a3d443c60771230a2214575088</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd1</span>;</div><div class="line">             rconen=<span class="number">1</span>;</div><div class="line">             keysel=<span class="number">1</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd2</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd3</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd4</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd5</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd6</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd7</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd8</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd9</span>;</div><div class="line">    #<span class="number">100</span> addr=<span class="number">4'd10</span>;</div><div class="line"></div><div class="line">    #<span class="number">100</span> rndkren=<span class="number">0</span>;</div><div class="line">             wrrndkrf=<span class="number">0</span>;</div><div class="line">             rconen=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd0</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd1</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd2</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd3</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd4</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd5</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd6</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd7</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd8</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd9</span>;</div><div class="line">        #<span class="number">100</span> addr=<span class="number">4'd10</span>;</div><div class="line">        #<span class="number">200</span> <span class="built_in">$stop</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>4、将设计文件和测试文件输入Modelsim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="五、实验结果"><a href="#五、实验结果" class="headerlink" title="五、实验结果"></a>五、实验结果</h2><p>　　参见Modelsim中的仿真波形图,列出下列实验结果表：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/223.png" alt=""><br>　　波形图如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/224.png" alt=""></p>
<h2 id="六、实验结论"><a href="#六、实验结论" class="headerlink" title="六、实验结论"></a>六、实验结论</h2><p>　　本实验设计了AES密码处理器的密钥扩展模块的Verilog模型及其测试程序，并选择了两个不同的种子密钥对其进行了密钥扩展功能仿真，仿真结果全部正确，这说明所设计的密钥扩展模块的功能是正确的。<br>　　仿真时将两个子密钥放在同一激励快中进行同时仿真，可以比较直观的观察数值的显示及变化过程，仿真波形图将种子密钥与产生的子密钥转换为16进制显示，使得结果数据更加直观方便。</p>
<h1 id="AES密码处理器加密-解密模块设计与仿真"><a href="#AES密码处理器加密-解密模块设计与仿真" class="headerlink" title="AES密码处理器加密/解密模块设计与仿真"></a>AES密码处理器加密/解密模块设计与仿真</h1><h2 id="一、实验目的-2"><a href="#一、实验目的-2" class="headerlink" title="一、实验目的"></a>一、实验目的</h2><p>　　掌握AES密码处理器加密模块的设计思想、原理和方法。</p>
<h2 id="二、实验内容-2"><a href="#二、实验内容-2" class="headerlink" title="二、实验内容"></a>二、实验内容</h2><p>　　1、设计AES密码处理器加密/解密模块的电路结构，利用Verilog HDL建立其RTL模型。<br>　　2、利用Modelsim仿真软件对所设计的AES密码处理器加密/解密模块的Verilog RTL模型进行功能仿真。</p>
<h2 id="三、实验环境-2"><a href="#三、实验环境-2" class="headerlink" title="三、实验环境"></a>三、实验环境</h2><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h2 id="四、实验步骤-2"><a href="#四、实验步骤-2" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h2><p><strong>1、电路结构设计</strong><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/331.png" alt=""><br>　　AES加密/解密模块的外部信号如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/332.png" alt=""><br>　　AES加密算法和解密算法所使用的变换大多相同或相似，因此其电路结构也非常类似，有很多资源可以共享。为了减少电路规模，我们采用一套电路分时实现AES加密和解密。<br>　　AES加密过程由一个初始密钥加(异或)变换和十个轮变换构成，其中除第10个轮变换外，每个轮变换都是一样的，都是由字节代替(S盒变换)、行移位、列混合、密钥加4个子变换组成，第10个轮变换由字节代替、行移位、密钥加3个子变换组成，不包括列混合变换。<br>　　为了进一步减少电路的规模，我们仅实现一个轮变换的电路，用循环迭代的方式实现十轮变换。<br>　　设<img src="/sourcefile/[O]VLSI设计之AES密码处理器/333.png" alt="">表示每一轮变换的输入字节，<br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/334.png" alt=""><br>　　表示由4个输入字节构成的一个32位字，它是输入状态矩阵中的一列。<br>　　a=(a<sub>0</sub>,a<sub>1</sub>,a<sub>2</sub>,a<sub>3</sub>)表示输入状态矩阵。<br>　　令b<sub>i,j</sub><img src="/sourcefile/[O]VLSI设计之AES密码处理器/333.png" alt="">表示字节代替变换(记为  )后的字节，<br>　　c<sub>i,j</sub><img src="/sourcefile/[O]VLSI设计之AES密码处理器/333.png" alt="">表示行移位变换后的字节，<br>　　d<sub>i,j</sub><img src="/sourcefile/[O]VLSI设计之AES密码处理器/333.png" alt="">表示列混合变换后的字节，<br>　　e<sub>i,j</sub><img src="/sourcefile/[O]VLSI设计之AES密码处理器/333.png" alt="">表示每一轮变换后的输出字节，<br>　　k<sub>i,j</sub><img src="/sourcefile/[O]VLSI设计之AES密码处理器/333.png" alt="">表示每一轮变换的密钥字节。<br>　　则根据AES加密算法的描述，对于第1-9轮变换，有下列式子成立：<br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/335.png" alt=""><br>　　将（1）式代入（2）式，（2）式代入（3）式，（3）式代入（4）式，得<br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/336.png" alt=""><br>　　在上式中，分别令j=0,1,2,3，我们就得到了经过一轮变换后的所有输出字节。<br>　　对于初始密钥加变换（可以看成是第0轮变换），其输出字节与输入字节之间的函数关系为：　　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/337.png" alt=""><br>　　对于第10轮变换，其输出字节与输入字节之间的函数关系为：<br>　　<img src="/sourcefile/[O]VLSI设计之AES密码处理器/338.png" alt=""><br>　　由（5）、（6）、（7）式可以看出，AES加密过程包括字节代替（S盒）、02乘字节、03乘字节、异或共4种操作，因此只要在电路中设置相应的电路模块就可以实现加密功能。为了充分利用FPGA中的RAM资源，减少LE的资源占用，我们采用查表方式实现S盒变换。同时，为了与AES加密算法自身的并行性相匹配，我们在电路中设置了16个8*8S盒，16个02乘字节、03乘字节模块。另外，为了保存每轮加密变换的结果，在电路中还应该设置一个128位的寄存器。</p>
<p>　　加密流程：首先将S盒配置为加密S盒，即在使能信号wrsben和地址信号wrsbaddr的控制下，通过S盒配置数据端口sbdata将加密S盒配置数据写入16个S盒sbox0~sbox15。然后实现初始密钥加变换，即在选择信号keyadsel的控制下，通过四选一选通器选择外部输入明文数据intxt，与初始子密钥roundkey进行异或操作，并在选择信号reginsel的控制下，通过二选一选通器将异或操作的结果e0~e15保存到S盒的输入寄存器。接下来进行第一轮加密变换，即初始密钥加变换的结果经sbox0~sbox15完成S盒变换后，在选择信号mixsel的控制下，通过二选一选通器进入byte0203模块，完成02乘字节和03乘字节运算，然后进行（5）式中前4项的异或运算，得结果c0~c15, 在选择信号keyadsel的控制下，通过四选一选通器选择c0~c15与第一轮子密钥进行异或操作，从而得到第一轮加密变换的结果e0~e15，并将其保存到S盒的输入寄存器，作为下一轮加密变换的输入数据。依次类推，可以完成第1-9轮加密变换。最后进行第10轮加密变换，即第9轮加密变换变换的结果经sbox0~sbox15完成S盒变换后，在选择信号keyadsel的控制下，通过四选一选通器选择恰当的S盒输出与第10轮子密钥进行异或操作，即可得到密文，最后将其保存到结果寄存器resultreg。初始密钥加变换和每轮加密变换都在一个周期内完成，因此上述加密过程共需要11个时钟周期。</p>
<p>　　解密流程：首先将S盒配置为解密S盒，配置过程与加密S盒配置过程一样，只是配置数据不同。然后实现初始密钥加变换，即在选择信号keyadsel的控制下，通过四选一选通器选择外部输入密文数据intxt，与初始子密钥roundkey进行异或操作，并在选择信号reginsel的控制下，通过二选一选通器将异或操作的结果e0~e15保存到S盒的输入寄存器。接下来进行第一轮解密变换，即初始密钥加变换的结果经sbox0~sbox15完成逆S盒变换后，再与第一轮子密钥进行异或操作，然后在选择信号mixsel的控制下，通过二选一选通器进入byte0203模块和byte9bde模块，完成进行逆列混合变换所需要的字节乘法运算（即09乘字节、0b乘字节、0d乘字节和0e乘字节），然后通过一系列异或运算得列混合变换的结果g0~g15, 在选择信号reginsel的控制下，通过二选一选通器选择g0~g15输出，从而得到第一轮解密变换的结果h，并将其保存到S盒的输入寄存器，作为下一轮解密变换的输入数据。依次类推，可以完成第1-9轮解密变换。最后进行第10轮解密变换，即第9轮加密变换变换的结果经sbox0~sbox15完成逆S盒变换后，在选择信号keyadsel的控制下，通过四选一选通器选择恰当的S盒输出与第10轮子密钥进行异或操作，即可得到明文，最后将其保存到结果寄存器resultreg。初始密钥加变换和每轮解密变换都在一个周期内完成，因此上述解密过程共需要11个时钟周期。需要注意的是，解密过程使用的子密钥与加密过程使用的子密钥相同，但使用顺序恰好相反。</p>
<p><strong>2、建立Verilog模型</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> crydap(clk,wrsben,wrsbaddr,sbdata,keyadsel,mixsel,reginsel,wrregen,intxt,roundkey,outtxt);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] outtxt;</div><div class="line"><span class="keyword">input</span> clk,wrsben,wrregen,mixsel,reginsel;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] wrsbaddr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] sbdata,intxt,roundkey;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] sb0out,sb1out,sb2out,sb3out,sb4out,sb5out,sb6out,sb7out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] sb8out,sb9out,sb10out,sb11out,sb12out,sb13out,sb14out,sb15out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a0,b0,c0,a1,b1,c1,a2,b2,c2,a3,b3,c3,a4,b4,c4,a5,b5,c5;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a6,b6,c6,a7,b7,c7,a8,b8,c8,a9,b9,c9,a10,b10,c10,a11,b11,c11;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a12,b12,c12,a13,b13,c13,a14,b14,c14,a15,b15,c15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13,f14,f15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] i0,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,i14,i15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] j0,j1,j2,j3,j4,j5,j6,j7,j8,j9,j10,j11,j12,j13,j14,j15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f002,f003,f009,f00b,f00d,f00e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f102,f103,f109,f10b,f10d,f10e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f202,f203,f209,f20b,f20d,f20e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f302,f303,f309,f30b,f30d,f30e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f402,f403,f409,f40b,f40d,f40e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f502,f503,f509,f50b,f50d,f50e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f602,f603,f609,f60b,f60d,f60e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f702,f703,f709,f70b,f70d,f70e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f802,f803,f809,f80b,f80d,f80e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f902,f903,f909,f90b,f90d,f90e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1002,f1003,f1009,f100b,f100d,f100e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1102,f1103,f1109,f110b,f110d,f110e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1202,f1203,f1209,f120b,f120d,f120e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1302,f1303,f1309,f130b,f130d,f130e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1402,f1403,f1409,f140b,f140d,f140e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1502,f1503,f1509,f150b,f150d,f150e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] d,e,g,h;</div><div class="line">sbox  sbox0(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">127</span>:<span class="number">120</span>],sb0out);</div><div class="line">sbox  sbox1(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">119</span>:<span class="number">112</span>],sb1out);</div><div class="line">sbox  sbox2(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">111</span>:<span class="number">104</span>],sb2out);</div><div class="line">sbox  sbox3(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">103</span>:<span class="number">96</span>],sb3out);</div><div class="line">sbox  sbox4(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">95</span>:<span class="number">88</span>],sb4out);</div><div class="line">sbox  sbox5(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">87</span>:<span class="number">80</span>],sb5out);</div><div class="line">sbox  sbox6(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">79</span>:<span class="number">72</span>],sb6out);</div><div class="line">sbox  sbox7(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">71</span>:<span class="number">64</span>],sb7out);</div><div class="line">sbox  sbox8(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">63</span>:<span class="number">56</span>],sb8out);</div><div class="line">sbox  sbox9(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">55</span>:<span class="number">48</span>],sb9out);</div><div class="line">sbox  sbox10(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">47</span>:<span class="number">40</span>],sb10out);</div><div class="line">sbox  sbox11(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">39</span>:<span class="number">32</span>],sb11out);</div><div class="line">sbox  sbox12(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">31</span>:<span class="number">24</span>],sb12out);</div><div class="line">sbox  sbox13(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">23</span>:<span class="number">16</span>],sb13out);</div><div class="line">sbox  sbox14(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">15</span>:<span class="number">8</span>],sb14out);</div><div class="line">sbox  sbox15(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">7</span>:<span class="number">0</span>],sb15out);</div><div class="line">mux21_8  mux21_8_0(mixsel,sb0out,e0,f0);</div><div class="line">mux21_8  mux21_8_1(mixsel,sb1out,e1,f1);</div><div class="line">mux21_8  mux21_8_2(mixsel,sb2out,e2,f2);</div><div class="line">mux21_8  mux21_8_3(mixsel,sb3out,e3,f3);</div><div class="line">mux21_8  mux21_8_4(mixsel,sb4out,e4,f4);</div><div class="line">mux21_8  mux21_8_5(mixsel,sb5out,e5,f5);</div><div class="line">mux21_8  mux21_8_6(mixsel,sb6out,e6,f6);</div><div class="line">mux21_8  mux21_8_7(mixsel,sb7out,e7,f7);</div><div class="line">mux21_8  mux21_8_8(mixsel,sb8out,e8,f8);</div><div class="line">mux21_8  mux21_8_9(mixsel,sb9out,e9,f9);</div><div class="line">mux21_8  mux21_8_10(mixsel,sb10out,e10,f10);</div><div class="line">mux21_8  mux21_8_11(mixsel,sb11out,e11,f11);</div><div class="line">mux21_8  mux21_8_12(mixsel,sb12out,e12,f12);</div><div class="line">mux21_8  mux21_8_13(mixsel,sb13out,e13,f13);</div><div class="line">mux21_8  mux21_8_14(mixsel,sb14out,e14,f14);</div><div class="line">mux21_8  mux21_8_15(mixsel,sb15out,e15,f15);</div><div class="line">byte0203 byte0203_0(f0,f002,f003);</div><div class="line">byte0203 byte0203_1(f1,f102,f103);</div><div class="line">byte0203 byte0203_2(f2,f202,f203);</div><div class="line">byte0203 byte0203_3(f3,f302,f303);</div><div class="line">byte0203 byte0203_4(f4,f402,f403);</div><div class="line">byte0203 byte0203_5(f5,f502,f503);</div><div class="line">byte0203 byte0203_6(f6,f602,f603);</div><div class="line">byte0203 byte0203_7(f7,f702,f703);</div><div class="line">byte0203 byte0203_8(f8,f802,f803);</div><div class="line">byte0203 byte0203_9(f9,f902,f903);</div><div class="line">byte0203 byte0203_10(f10,f1002,f1003);</div><div class="line">byte0203 byte0203_11(f11,f1102,f1103);</div><div class="line">byte0203 byte0203_12(f12,f1202,f1203);</div><div class="line">byte0203 byte0203_13(f13,f1302,f1303);</div><div class="line">byte0203 byte0203_14(f14,f1402,f1403);</div><div class="line">byte0203 byte0203_15(f15,f1502,f1503);</div><div class="line">byte9bde byte9bde_0(f0,f002,f003,f009,f00b,f00d,f00e);</div><div class="line">byte9bde byte9bde_1(f1,f102,f103,f109,f10b,f10d,f10e);</div><div class="line">byte9bde byte9bde_2(f2,f202,f203,f209,f20b,f20d,f20e);</div><div class="line">byte9bde byte9bde_3(f3,f302,f303,f309,f30b,f30d,f30e);</div><div class="line">byte9bde byte9bde_4(f4,f402,f403,f409,f40b,f40d,f40e);</div><div class="line">byte9bde byte9bde_5(f5,f502,f503,f509,f50b,f50d,f50e);</div><div class="line">byte9bde byte9bde_6(f6,f602,f603,f609,f60b,f60d,f60e);</div><div class="line">byte9bde byte9bde_7(f7,f702,f703,f709,f70b,f70d,f70e);</div><div class="line">byte9bde byte9bde_8(f8,f802,f803,f809,f80b,f80d,f80e);</div><div class="line">byte9bde byte9bde_9(f9,f902,f903,f909,f90b,f90d,f90e);</div><div class="line">byte9bde byte9bde_10(f10,f1002,f1003,f1009,f100b,f100d,f100e);</div><div class="line">byte9bde byte9bde_11(f11,f1102,f1103,f1109,f110b,f110d,f110e);</div><div class="line">byte9bde byte9bde_12(f12,f1202,f1203,f1209,f120b,f120d,f120e);</div><div class="line">byte9bde byte9bde_13(f13,f1302,f1303,f1309,f130b,f130d,f130e);</div><div class="line">byte9bde byte9bde_14(f14,f1402,f1403,f1409,f140b,f140d,f140e);</div><div class="line">byte9bde byte9bde_15(f15,f1502,f1503,f1509,f150b,f150d,f150e);</div><div class="line"><span class="keyword">assign</span> a0=f002^f503;</div><div class="line"><span class="keyword">assign</span> b0=sb10out^sb15out;</div><div class="line"><span class="keyword">assign</span> c0=a0^b0;</div><div class="line">mux41_8  mux41_8_0(keyadsel,intxt[<span class="number">127</span>:<span class="number">120</span>],c0,sb0out,sb0out,d0);</div><div class="line"><span class="keyword">assign</span> a1=sb0out^f502;</div><div class="line"><span class="keyword">assign</span> b1=f1003^sb15out;</div><div class="line"><span class="keyword">assign</span> c1=a1^b1;</div><div class="line">mux41_8  mux41_8_1(keyadsel,intxt[<span class="number">119</span>:<span class="number">112</span>],c1,sb5out,sb13out,d1);</div><div class="line"><span class="keyword">assign</span> a2=sb0out^sb5out;</div><div class="line"><span class="keyword">assign</span> b2=f1002^f1503;</div><div class="line"><span class="keyword">assign</span> c2=a2^b2;</div><div class="line">mux41_8  mux41_8_2(keyadsel,intxt[<span class="number">111</span>:<span class="number">104</span>],c2,sb10out,sb10out,d2);</div><div class="line"><span class="keyword">assign</span> a3=f003^sb5out;</div><div class="line"><span class="keyword">assign</span> b3=sb10out^f1502;</div><div class="line"><span class="keyword">assign</span> c3=a3^b3;</div><div class="line">mux41_8  mux41_8_3(keyadsel,intxt[<span class="number">103</span>:<span class="number">96</span>],c3,sb15out,sb7out,d3);</div><div class="line"><span class="keyword">assign</span> a4=f402^f903;</div><div class="line"><span class="keyword">assign</span> b4=sb14out^sb3out;</div><div class="line"><span class="keyword">assign</span> c4=a4^b4;</div><div class="line">mux41_8  mux41_8_4(keyadsel,intxt[<span class="number">95</span>:<span class="number">88</span>],c4,sb4out,sb4out,d4);</div><div class="line"><span class="keyword">assign</span> a5=sb4out^f902;</div><div class="line"><span class="keyword">assign</span> b5=f1403^sb3out;</div><div class="line"><span class="keyword">assign</span> c5=a5^b5;</div><div class="line">mux41_8  mux41_8_5(keyadsel,intxt[<span class="number">87</span>:<span class="number">80</span>],c5,sb9out,sb1out,d5);</div><div class="line"><span class="keyword">assign</span> a6=sb4out^sb9out;</div><div class="line"><span class="keyword">assign</span> b6=f1402^f303;</div><div class="line"><span class="keyword">assign</span> c6=a6^b6;</div><div class="line">mux41_8  mux41_8_6(keyadsel,intxt[<span class="number">79</span>:<span class="number">72</span>],c6,sb14out,sb14out,d6);</div><div class="line"><span class="keyword">assign</span> a7=f403^sb9out;</div><div class="line"><span class="keyword">assign</span> b7=sb14out^f302;</div><div class="line"><span class="keyword">assign</span> c7=a7^b7;</div><div class="line">mux41_8  mux41_8_7(keyadsel,intxt[<span class="number">71</span>:<span class="number">64</span>],c7,sb3out,sb11out,d7);</div><div class="line"><span class="keyword">assign</span> a8=f802^f1303;</div><div class="line"><span class="keyword">assign</span> b8=sb2out^sb7out;</div><div class="line"><span class="keyword">assign</span> c8=a8^b8;</div><div class="line">mux41_8  mux41_8_8(keyadsel,intxt[<span class="number">63</span>:<span class="number">56</span>],c8,sb8out,sb8out,d8);</div><div class="line"><span class="keyword">assign</span> a9=sb8out^f1302;</div><div class="line"><span class="keyword">assign</span> b9=f203^sb7out;</div><div class="line"><span class="keyword">assign</span> c9=a9^b9;</div><div class="line">mux41_8  mux41_8_9(keyadsel,intxt[<span class="number">55</span>:<span class="number">48</span>],c9,sb13out,sb5out,d9);</div><div class="line"><span class="keyword">assign</span> a10=sb8out^sb13out;</div><div class="line"><span class="keyword">assign</span> b10=f202^f703;</div><div class="line"><span class="keyword">assign</span> c10=a10^b10;</div><div class="line">mux41_8  mux41_8_10(keyadsel,intxt[<span class="number">47</span>:<span class="number">40</span>],c10,sb2out,sb2out,d10);</div><div class="line"><span class="keyword">assign</span> a11=f803^sb13out;</div><div class="line"><span class="keyword">assign</span> b11=sb2out^f702;</div><div class="line"><span class="keyword">assign</span> c11=a11^b11;</div><div class="line">mux41_8  mux41_8_11(keyadsel,intxt[<span class="number">39</span>:<span class="number">32</span>],c11,sb7out,sb15out,d11);</div><div class="line"><span class="keyword">assign</span> a12=f1202^f103;</div><div class="line"><span class="keyword">assign</span> b12=sb6out^sb11out;</div><div class="line"><span class="keyword">assign</span> c12=a12^b12;</div><div class="line">mux41_8  mux41_8_12(keyadsel,intxt[<span class="number">31</span>:<span class="number">24</span>],c12,sb12out,sb12out,d12);</div><div class="line"><span class="keyword">assign</span> a13=sb12out^f102;</div><div class="line"><span class="keyword">assign</span> b13=f603^sb11out;</div><div class="line"><span class="keyword">assign</span> c13=a13^b13;</div><div class="line">mux41_8  mux41_8_13(keyadsel,intxt[<span class="number">23</span>:<span class="number">16</span>],c13,sb1out,sb9out,d13);</div><div class="line"><span class="keyword">assign</span> a14=sb12out^sb1out;</div><div class="line"><span class="keyword">assign</span> b14=f602^f1103;</div><div class="line"><span class="keyword">assign</span> c14=a14^b14;</div><div class="line">mux41_8  mux41_8_14(keyadsel,intxt[<span class="number">15</span>:<span class="number">8</span>],c14,sb6out,sb6out,d14);</div><div class="line"><span class="keyword">assign</span> a15=f1203^sb1out;</div><div class="line"><span class="keyword">assign</span> b15=sb6out^f1102;</div><div class="line"><span class="keyword">assign</span> c15=a15^b15;</div><div class="line">mux41_8  mux41_8_15(keyadsel,intxt[<span class="number">7</span>:<span class="number">0</span>],c15,sb11out,sb3out,d15);</div><div class="line"><span class="keyword">assign</span> d=&#123;d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15&#125;;</div><div class="line"><span class="keyword">assign</span> e=&#123;e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15&#125;;</div><div class="line"><span class="keyword">assign</span> g=&#123;g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15&#125;;</div><div class="line"><span class="keyword">assign</span> &#123;e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15&#125;=d^roundkey;</div><div class="line"><span class="keyword">assign</span> i0=f00e^f10b;</div><div class="line"><span class="keyword">assign</span> j0=f20d^f309;</div><div class="line"><span class="keyword">assign</span> g0=i0^j0;</div><div class="line"><span class="keyword">assign</span> i1=f009^f10e;</div><div class="line"><span class="keyword">assign</span> j1=f20b^f30d;</div><div class="line"><span class="keyword">assign</span> g1=i1^j1;</div><div class="line"><span class="keyword">assign</span> i2=f00d^f109;</div><div class="line"><span class="keyword">assign</span> j2=f20e^f30b;</div><div class="line"><span class="keyword">assign</span> g2=i2^j2;</div><div class="line"><span class="keyword">assign</span> i3=f00b^f10d;</div><div class="line"><span class="keyword">assign</span> j3=f209^f30e;</div><div class="line"><span class="keyword">assign</span> g3=i3^j3;</div><div class="line"><span class="keyword">assign</span> i4=f40e^f50b;</div><div class="line"><span class="keyword">assign</span> j4=f60d^f709;</div><div class="line"><span class="keyword">assign</span> g4=i4^j4;</div><div class="line"><span class="keyword">assign</span> i5=f409^f50e;</div><div class="line"><span class="keyword">assign</span> j5=f60b^f70d;</div><div class="line"><span class="keyword">assign</span> g5=i5^j5;</div><div class="line"><span class="keyword">assign</span> i6=f40d^f509;</div><div class="line"><span class="keyword">assign</span> j6=f60e^f70b;</div><div class="line"><span class="keyword">assign</span> g6=i6^j6;</div><div class="line"><span class="keyword">assign</span> i7=f40b^f50d;</div><div class="line"><span class="keyword">assign</span> j7=f609^f70e;</div><div class="line"><span class="keyword">assign</span> g7=i7^j7;</div><div class="line"></div><div class="line"><span class="keyword">assign</span> i8=f80e^f90b;</div><div class="line"><span class="keyword">assign</span> j8=f100d^f1109;</div><div class="line"><span class="keyword">assign</span> g8=i8^j8;</div><div class="line"><span class="keyword">assign</span> i9=f809^f90e;</div><div class="line"><span class="keyword">assign</span> j9=f100b^f110d;</div><div class="line"><span class="keyword">assign</span> g9=i9^j9;</div><div class="line"><span class="keyword">assign</span> i10=f80d^f909;</div><div class="line"><span class="keyword">assign</span> j10=f100e^f110b;</div><div class="line"><span class="keyword">assign</span> g10=i10^j10;</div><div class="line"><span class="keyword">assign</span> i11=f80b^f90d;</div><div class="line"><span class="keyword">assign</span> j11=f1009^f110e;</div><div class="line"><span class="keyword">assign</span> g11=i11^j11;</div><div class="line"><span class="keyword">assign</span> i12=f120e^f130b;</div><div class="line"><span class="keyword">assign</span> j12=f140d^f1509;</div><div class="line"><span class="keyword">assign</span> g12=i12^j12;</div><div class="line"><span class="keyword">assign</span> i13=f1209^f130e;</div><div class="line"><span class="keyword">assign</span> j13=f140b^f150d;</div><div class="line"><span class="keyword">assign</span> g13=i13^j13;</div><div class="line"><span class="keyword">assign</span> i14=f120d^f1309;</div><div class="line"><span class="keyword">assign</span> j14=f140e^f150b;</div><div class="line"><span class="keyword">assign</span> g14=i14^j14;</div><div class="line"><span class="keyword">assign</span> i15=f120b^f130d;</div><div class="line"><span class="keyword">assign</span> j15=f1409^f150e;</div><div class="line"><span class="keyword">assign</span> g15=i15^j15;</div><div class="line">mux21_128 mux21_128_0(reginsel,e,g,h);</div><div class="line">reg_128 resultreg(clk,wrregen,h,outtxt);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> sbox(clk,write,wr_addr,din,rd_addr,dout);</div><div class="line"><span class="keyword">input</span> clk;</div><div class="line"><span class="keyword">input</span> write;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] wr_addr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] rd_addr;</div><div class="line"><span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] decout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] write_reg;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] reg0out,reg1out,reg2out,reg3out,reg4out,reg5out,reg6out,reg7out,reg8out,reg9out,reg10out,reg11out,reg12out,reg13out,reg14out,reg15out;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (wr_addr)</div><div class="line">  <span class="keyword">case</span>(wr_addr)</div><div class="line">    <span class="number">4'd0</span>: decout=<span class="number">16'b0000_0000_0000_0001</span>;</div><div class="line">    <span class="number">4'd1</span>: decout=<span class="number">16'b0000_0000_0000_0010</span>;</div><div class="line">    <span class="number">4'd2</span>: decout=<span class="number">16'b0000_0000_0000_0100</span>;</div><div class="line">    <span class="number">4'd3</span>: decout=<span class="number">16'b0000_0000_0000_1000</span>;</div><div class="line">    <span class="number">4'd4</span>: decout=<span class="number">16'b0000_0000_0001_0000</span>;</div><div class="line">    <span class="number">4'd5</span>: decout=<span class="number">16'b0000_0000_0010_0000</span>;</div><div class="line">    <span class="number">4'd6</span>: decout=<span class="number">16'b0000_0000_0100_0000</span>;</div><div class="line">    <span class="number">4'd7</span>: decout=<span class="number">16'b0000_0000_1000_0000</span>;</div><div class="line">    <span class="number">4'd8</span>: decout=<span class="number">16'b0000_0001_0000_0000</span>;</div><div class="line">    <span class="number">4'd9</span>: decout=<span class="number">16'b0000_0010_0000_0000</span>;</div><div class="line">    <span class="number">4'd10</span>: decout=<span class="number">16'b0000_0100_0000_0000</span>;</div><div class="line">    <span class="number">4'd11</span>: decout=<span class="number">16'b0000_1000_0000_0000</span>;</div><div class="line">    <span class="number">4'd12</span>: decout=<span class="number">16'b0001_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd13</span>: decout=<span class="number">16'b0010_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd14</span>: decout=<span class="number">16'b0100_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd15</span>: decout=<span class="number">16'b1000_0000_0000_0000</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">assign</span> write_reg=decout &amp; &#123;write,write,write,write,write,write,write,write,write,write,write,write,write,write,write,write&#125;;</div><div class="line"></div><div class="line">reg_128 reg0(clk,write_reg[<span class="number">0</span>],din,reg0out);</div><div class="line">reg_128 reg1(clk,write_reg[<span class="number">1</span>],din,reg1out);</div><div class="line">reg_128 reg2(clk,write_reg[<span class="number">2</span>],din,reg2out);</div><div class="line">reg_128 reg3(clk,write_reg[<span class="number">3</span>],din,reg3out);</div><div class="line">reg_128 reg4(clk,write_reg[<span class="number">4</span>],din,reg4out);</div><div class="line">reg_128 reg5(clk,write_reg[<span class="number">5</span>],din,reg5out);</div><div class="line">reg_128 reg6(clk,write_reg[<span class="number">6</span>],din,reg6out);</div><div class="line">reg_128 reg7(clk,write_reg[<span class="number">7</span>],din,reg7out);</div><div class="line">reg_128 reg8(clk,write_reg[<span class="number">8</span>],din,reg8out);</div><div class="line">reg_128 reg9(clk,write_reg[<span class="number">9</span>],din,reg9out);</div><div class="line">reg_128 reg10(clk,write_reg[<span class="number">10</span>],din,reg10out);</div><div class="line">reg_128 reg11(clk,write_reg[<span class="number">11</span>],din,reg11out);</div><div class="line">reg_128 reg12(clk,write_reg[<span class="number">12</span>],din,reg12out);</div><div class="line">reg_128 reg13(clk,write_reg[<span class="number">13</span>],din,reg13out);</div><div class="line">reg_128 reg14(clk,write_reg[<span class="number">14</span>],din,reg14out);</div><div class="line">reg_128 reg15(clk,write_reg[<span class="number">15</span>],din,reg15out);</div><div class="line"><span class="keyword">always</span> @(rd_addr <span class="keyword">or</span> reg0out <span class="keyword">or</span> reg1out <span class="keyword">or</span> reg2out <span class="keyword">or</span> reg3out <span class="keyword">or</span> reg4out <span class="keyword">or</span> reg5out <span class="keyword">or</span> reg6out <span class="keyword">or</span> reg7out <span class="keyword">or</span> reg8out <span class="keyword">or</span> reg9out <span class="keyword">or</span> reg10out <span class="keyword">or</span> reg11out <span class="keyword">or</span> reg12out <span class="keyword">or</span> reg13out <span class="keyword">or</span> reg14out <span class="keyword">or</span> reg15out)</div><div class="line">  <span class="keyword">case</span>(rd_addr)</div><div class="line">    <span class="number">8'd0</span>: dout=reg0out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd1</span>: dout=reg0out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd2</span>: dout=reg0out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd3</span>: dout=reg0out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd4</span>: dout=reg0out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd5</span>: dout=reg0out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd6</span>: dout=reg0out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd7</span>: dout=reg0out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd8</span>: dout=reg0out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd9</span>: dout=reg0out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd10</span>: dout=reg0out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd11</span>: dout=reg0out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd12</span>: dout=reg0out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd13</span>: dout=reg0out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd14</span>: dout=reg0out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd15</span>: dout=reg0out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd16</span>: dout=reg1out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd17</span>: dout=reg1out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd18</span>: dout=reg1out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd19</span>: dout=reg1out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd20</span>: dout=reg1out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd21</span>: dout=reg1out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd22</span>: dout=reg1out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd23</span>: dout=reg1out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd24</span>: dout=reg1out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd25</span>: dout=reg1out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd26</span>: dout=reg1out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd27</span>: dout=reg1out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd28</span>: dout=reg1out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd29</span>: dout=reg1out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd30</span>: dout=reg1out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd31</span>: dout=reg1out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd32</span>: dout=reg2out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd33</span>: dout=reg2out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd34</span>: dout=reg2out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd35</span>: dout=reg2out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd36</span>: dout=reg2out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd37</span>: dout=reg2out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd38</span>: dout=reg2out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd39</span>: dout=reg2out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd40</span>: dout=reg2out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd41</span>: dout=reg2out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd42</span>: dout=reg2out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd43</span>: dout=reg2out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd44</span>: dout=reg2out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd45</span>: dout=reg2out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd46</span>: dout=reg2out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd47</span>: dout=reg2out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd48</span>: dout=reg3out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd49</span>: dout=reg3out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd50</span>: dout=reg3out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd51</span>: dout=reg3out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd52</span>: dout=reg3out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd53</span>: dout=reg3out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd54</span>: dout=reg3out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd55</span>: dout=reg3out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd56</span>: dout=reg3out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd57</span>: dout=reg3out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd58</span>: dout=reg3out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd59</span>: dout=reg3out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd60</span>: dout=reg3out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd61</span>: dout=reg3out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd62</span>: dout=reg3out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd63</span>: dout=reg3out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd64</span>: dout=reg4out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd65</span>: dout=reg4out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd66</span>: dout=reg4out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd67</span>: dout=reg4out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd68</span>: dout=reg4out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd69</span>: dout=reg4out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd70</span>: dout=reg4out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd71</span>: dout=reg4out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd72</span>: dout=reg4out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd73</span>: dout=reg4out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd74</span>: dout=reg4out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd75</span>: dout=reg4out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd76</span>: dout=reg4out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd77</span>: dout=reg4out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd78</span>: dout=reg4out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd79</span>: dout=reg4out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd80</span>: dout=reg5out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd81</span>: dout=reg5out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd82</span>: dout=reg5out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd83</span>: dout=reg5out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd84</span>: dout=reg5out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd85</span>: dout=reg5out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd86</span>: dout=reg5out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd87</span>: dout=reg5out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd88</span>: dout=reg5out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd89</span>: dout=reg5out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd90</span>: dout=reg5out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd91</span>: dout=reg5out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd92</span>: dout=reg5out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd93</span>: dout=reg5out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd94</span>: dout=reg5out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd95</span>: dout=reg5out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd96</span>: dout=reg6out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd97</span>: dout=reg6out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd98</span>: dout=reg6out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd99</span>: dout=reg6out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd100</span>: dout=reg6out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd101</span>: dout=reg6out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd102</span>: dout=reg6out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd103</span>: dout=reg6out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd104</span>: dout=reg6out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd105</span>: dout=reg6out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd106</span>: dout=reg6out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd107</span>: dout=reg6out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd108</span>: dout=reg6out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd109</span>: dout=reg6out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd110</span>: dout=reg6out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd111</span>: dout=reg6out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd112</span>: dout=reg7out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd113</span>: dout=reg7out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd114</span>: dout=reg7out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd115</span>: dout=reg7out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd116</span>: dout=reg7out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd117</span>: dout=reg7out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd118</span>: dout=reg7out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd119</span>: dout=reg7out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd120</span>: dout=reg7out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd121</span>: dout=reg7out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd122</span>: dout=reg7out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd123</span>: dout=reg7out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd124</span>: dout=reg7out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd125</span>: dout=reg7out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd126</span>: dout=reg7out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd127</span>: dout=reg7out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd128</span>: dout=reg8out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd129</span>: dout=reg8out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd130</span>: dout=reg8out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd131</span>: dout=reg8out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd132</span>: dout=reg8out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd133</span>: dout=reg8out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd134</span>: dout=reg8out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd135</span>: dout=reg8out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd136</span>: dout=reg8out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd137</span>: dout=reg8out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd138</span>: dout=reg8out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd139</span>: dout=reg8out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd140</span>: dout=reg8out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd141</span>: dout=reg8out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd142</span>: dout=reg8out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd143</span>: dout=reg8out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd144</span>: dout=reg9out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd145</span>: dout=reg9out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd146</span>: dout=reg9out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd147</span>: dout=reg9out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd148</span>: dout=reg9out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd149</span>: dout=reg9out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd150</span>: dout=reg9out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd151</span>: dout=reg9out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd152</span>: dout=reg9out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd153</span>: dout=reg9out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd154</span>: dout=reg9out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd155</span>: dout=reg9out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd156</span>: dout=reg9out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd157</span>: dout=reg9out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd158</span>: dout=reg9out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd159</span>: dout=reg9out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd160</span>: dout=reg10out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd161</span>: dout=reg10out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd162</span>: dout=reg10out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd163</span>: dout=reg10out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd164</span>: dout=reg10out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd165</span>: dout=reg10out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd166</span>: dout=reg10out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd167</span>: dout=reg10out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd168</span>: dout=reg10out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd169</span>: dout=reg10out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd170</span>: dout=reg10out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd171</span>: dout=reg10out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd172</span>: dout=reg10out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd173</span>: dout=reg10out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd174</span>: dout=reg10out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd175</span>: dout=reg10out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd176</span>: dout=reg11out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd177</span>: dout=reg11out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd178</span>: dout=reg11out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd179</span>: dout=reg11out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd180</span>: dout=reg11out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd181</span>: dout=reg11out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd182</span>: dout=reg11out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd183</span>: dout=reg11out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd184</span>: dout=reg11out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd185</span>: dout=reg11out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd186</span>: dout=reg11out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd187</span>: dout=reg11out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd188</span>: dout=reg11out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd189</span>: dout=reg11out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd190</span>: dout=reg11out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd191</span>: dout=reg11out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd192</span>: dout=reg12out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd193</span>: dout=reg12out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd194</span>: dout=reg12out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd195</span>: dout=reg12out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd196</span>: dout=reg12out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd197</span>: dout=reg12out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd198</span>: dout=reg12out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd199</span>: dout=reg12out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd200</span>: dout=reg12out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd201</span>: dout=reg12out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd202</span>: dout=reg12out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd203</span>: dout=reg12out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd204</span>: dout=reg12out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd205</span>: dout=reg12out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd206</span>: dout=reg12out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd207</span>: dout=reg12out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd208</span>: dout=reg13out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd209</span>: dout=reg13out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd210</span>: dout=reg13out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd211</span>: dout=reg13out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd212</span>: dout=reg13out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd213</span>: dout=reg13out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd214</span>: dout=reg13out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd215</span>: dout=reg13out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd216</span>: dout=reg13out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd217</span>: dout=reg13out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd218</span>: dout=reg13out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd219</span>: dout=reg13out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd220</span>: dout=reg13out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd221</span>: dout=reg13out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd222</span>: dout=reg13out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd223</span>: dout=reg13out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd224</span>: dout=reg14out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd225</span>: dout=reg14out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd226</span>: dout=reg14out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd227</span>: dout=reg14out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd228</span>: dout=reg14out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd229</span>: dout=reg14out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd230</span>: dout=reg14out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd231</span>: dout=reg14out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd232</span>: dout=reg14out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd233</span>: dout=reg14out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd234</span>: dout=reg14out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd235</span>: dout=reg14out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd236</span>: dout=reg14out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd237</span>: dout=reg14out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd238</span>: dout=reg14out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd239</span>: dout=reg14out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd240</span>: dout=reg15out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd241</span>: dout=reg15out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd242</span>: dout=reg15out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd243</span>: dout=reg15out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd244</span>: dout=reg15out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd245</span>: dout=reg15out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd246</span>: dout=reg15out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd247</span>: dout=reg15out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd248</span>: dout=reg15out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd249</span>: dout=reg15out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd250</span>: dout=reg15out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd251</span>: dout=reg15out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd252</span>: dout=reg15out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd253</span>: dout=reg15out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd254</span>: dout=reg15out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd255</span>: dout=reg15out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_8(sel,a,b,c);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">1'b0</span>: c=a;</div><div class="line">    <span class="number">1'b1</span>: c=b;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte0203(a,a02,a03);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a02,a03;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] b,c;</div><div class="line"><span class="keyword">assign</span> b=&#123;a[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1'b0</span>&#125;;</div><div class="line"><span class="keyword">assign</span> c=b^&#123;<span class="number">8'h1b</span>&#125;;</div><div class="line"><span class="keyword">assign</span> a02=(a[<span class="number">7</span>]==<span class="number">0</span>)? b:c;</div><div class="line"><span class="keyword">assign</span> a03=a02^a;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte9bde(a,a02,a03,a09,a0b,a0d,a0e);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a09,a0b,a0d,a0e;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,a02,a03;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a04,a08,b,c;</div><div class="line">byte02  byte02_0(a02,a04);</div><div class="line">byte02  byte02_1(a04,a08);</div><div class="line"><span class="keyword">assign</span> a09=a08^a;</div><div class="line"><span class="keyword">assign</span> a0b=a08^a03;</div><div class="line"><span class="keyword">assign</span> b=a04^a;</div><div class="line"><span class="keyword">assign</span> c=a04^a02;</div><div class="line"><span class="keyword">assign</span> a0d=a08^b;</div><div class="line"><span class="keyword">assign</span> a0e=a08^c;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte02(a,a02);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a02;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] b,c;</div><div class="line"><span class="keyword">assign</span> b=&#123;a[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1'b0</span>&#125;;</div><div class="line"><span class="keyword">assign</span> c=b^&#123;<span class="number">8'h1b</span>&#125;;</div><div class="line"><span class="keyword">assign</span> a02=(a[<span class="number">7</span>]==<span class="number">0</span>)? b:c;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux41_8(sel,a,b,c,d,e);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] e;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,b,c,d;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] e;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b <span class="keyword">or</span> c <span class="keyword">or</span> d)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">2'b00</span>: e=a;</div><div class="line">    <span class="number">2'b01</span>: e=b;</div><div class="line">    <span class="number">2'b10</span>: e=c;</div><div class="line">    <span class="number">2'b11</span>: e=d;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_128(sel,a,b,c);</div><div class="line"><span class="keyword">output</span>[<span class="number">127</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">input</span>[<span class="number">127</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">1'b0</span>: c=a;</div><div class="line">    <span class="number">1'b1</span>: c=b;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> reg_128(clk,write,din,dout);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">input</span>  clk,write;</div><div class="line"><span class="keyword">input</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line"><span class="keyword">begin</span></div><div class="line">  <span class="keyword">if</span>(write)</div><div class="line">    dout&lt;=din;</div><div class="line">  <span class="keyword">else</span></div><div class="line">    dout&lt;=dout;</div><div class="line"><span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> crydap_tb;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] outtxt;</div><div class="line"><span class="keyword">reg</span> clk,wrsben,wrregen,mixsel,reginsel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] wrsbaddr;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] sbdata,intxt,roundkey;</div><div class="line">crydap  crydap(clk,wrsben,wrsbaddr,sbdata,keyadsel,mixsel,reginsel,wrregen,intxt,roundkey,outtxt);</div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"><span class="keyword">initial</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="comment">//encryption sbox configuration.</span></div><div class="line">        #<span class="number">20</span>  wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd0</span>;</div><div class="line">             sbdata=<span class="number">128'h637c777bf26b6fc53001672bfed7ab76</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd1</span>;</div><div class="line">             sbdata=<span class="number">128'hca82c97dfa5947f0add4a2af9ca472c0</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd2</span>;</div><div class="line">             sbdata=<span class="number">128'hb7fd9326363ff7cc34a5e5f171d83115</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd3</span>;</div><div class="line">             sbdata=<span class="number">128'h04c723c31896059a071280e2eb27b275</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd4</span>;</div><div class="line">             sbdata=<span class="number">128'h09832c1a1b6e5aa0523bd6b329e32f84</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd5</span>;</div><div class="line">             sbdata=<span class="number">128'h53d100ed20fcb15b6acbbe394a4c58cf</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd6</span>;</div><div class="line">             sbdata=<span class="number">128'hd0efaafb434d338545f9027f503c9fa8</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd7</span>;</div><div class="line">             sbdata=<span class="number">128'h51a3408f929d38f5bcb6da2110fff3d2</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd8</span>;</div><div class="line">             sbdata=<span class="number">128'hcd0c13ec5f974417c4a77e3d645d1973</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd9</span>;</div><div class="line">             sbdata=<span class="number">128'h60814fdc222a908846eeb814de5e0bdb</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd10</span>;</div><div class="line">             sbdata=<span class="number">128'he0323a0a4906245cc2d3ac629195e479</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd11</span>;</div><div class="line">             sbdata=<span class="number">128'he7c8376d8dd54ea96c56f4ea657aae08</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd12</span>;</div><div class="line">             sbdata=<span class="number">128'hba78252e1ca6b4c6e8dd741f4bbd8b8a</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd13</span>;</div><div class="line">             sbdata=<span class="number">128'h703eb5664803f60e613557b986c11d9e</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd14</span>;</div><div class="line">             sbdata=<span class="number">128'he1f8981169d98e949b1e87e9ce5528df</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">1</span>;</div><div class="line">             wrsbaddr=<span class="number">4'd15</span>;</div><div class="line">             sbdata=<span class="number">128'h8ca1890dbfe6426841992d0fb054bb16</span>;</div><div class="line">        #<span class="number">100</span> wrsben=<span class="number">0</span>;</div><div class="line">        <span class="comment">//encryption.</span></div><div class="line">        #<span class="number">100</span> wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b00</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             intxt=<span class="number">128'h781278af02d47ca1bb32765a56f2bc1a</span>;<span class="comment">//3243f6a8_885a308d_313198a2_e0370734;</span></div><div class="line">             roundkey=<span class="number">128'h2b7e1516_28aed2a6_abf71588_09cf4f3c</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'ha0fafe17_88542cb1_23a33939_2a6c7605</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'hf2c295f2_7a96b943_5935807a_7359f67f</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'h3d80477d_4716fe3e_1e237e44_6d7a883b</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'hef44a541_a8525b7f_b671253b_db0bad00</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'hd4d1c6f8_7c839d87_caf2b8bc_11f915bc</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             roundkey=<span class="number">128'h6d88a37a_110b3efd_dbf98641_ca0093fd</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'h4e54f70e_5f5fc9f3_84a64fb2_4ea6dc4f</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'head27321_b58dbad2_312bf560_7f8d292f</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b01</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'hac7766f3_19fadc21_28d12941_575c006e</span>;</div><div class="line">      #<span class="number">100</span></div><div class="line">             wrregen=<span class="number">1</span>;</div><div class="line">             keyadsel=<span class="number">2'b10</span>;</div><div class="line">             mixsel=<span class="number">0</span>;</div><div class="line">             reginsel=<span class="number">0</span>;</div><div class="line">             roundkey=<span class="number">128'hd014f9a8_c9ee2589_e13f0cc8_b6630ca6</span>;</div><div class="line">      #<span class="number">100</span> wrregen=<span class="number">0</span>;</div><div class="line">        #<span class="number">200</span> <span class="built_in">$finish</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>4、将设计文件和测试文件输入Modelsim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="五、实验结果-1"><a href="#五、实验结果-1" class="headerlink" title="五、实验结果"></a>五、实验结果</h2><p><strong>加密</strong><br>　　参见Modelsim中的仿真波形图,列出下列实验结果表：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/339.png" alt=""><br>　　明文1:<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/3310.png" alt=""><br>　　明文2:<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/3311.png" alt=""></p>
<p><strong>解密</strong><br>　　参见Modelsim中的仿真波形图,列出下列实验结果表：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/3312.png" alt=""><br>　　密文1：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/3313.png" alt=""><br>　　密文2：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/3314.png" alt=""></p>
<h2 id="六、实验结论-1"><a href="#六、实验结论-1" class="headerlink" title="六、实验结论"></a>六、实验结论</h2><p>　　本实验设计了AES密码处理器加密模块的Verilog模型及其测试程序，并选择了2组不同的密钥和明文对其进行了功能仿真，仿真结果全部正确，这说明所设计的加密模块的功能是正确的。<br>　　此次实验将加密解密模块整合到一起，使用时调用加密S盒进行明文加密，使用两组明文进行测试，检测输出过程和轮密钥过程，更加直观的了解加密模块的工作原理。此次S盒与上次固定S盒不同，加密解密模块的S盒为可变动的，需要在激励块中赋值检测。</p>
<p>　　本实验设计了AES密码处理器解密模块的Verilog模型及其测试程序，并选择了2组不同的密钥和明文对其进行了功能仿真，仿真结果全部正确，这说明所设计的加密模块的功能是正确的。<br>　　本次实验所用结构体系与加密功能相同，不同的是对S盒的赋值和轮密钥的变换，解密时将加密的轮密钥反过来操作，当输入密文为上次实验结果时，输出明文应为上次实验的输入数据，中间的轮变换按照AES手册附录B进行对比，所得实验结果正确。</p>
<h1 id="AES密码处理器控制模块的设计与仿真"><a href="#AES密码处理器控制模块的设计与仿真" class="headerlink" title="AES密码处理器控制模块的设计与仿真"></a>AES密码处理器控制模块的设计与仿真</h1><h2 id="一、实验目的-3"><a href="#一、实验目的-3" class="headerlink" title="一、实验目的"></a>一、实验目的</h2><p>　　掌握AES密码处理器控制模块的设计思想、原理和方法。</p>
<h2 id="二、实验内容-3"><a href="#二、实验内容-3" class="headerlink" title="二、实验内容"></a>二、实验内容</h2><p>　　1、设计AES密码处理器控制模块的电路结构，利用Verilog HDL建立其RTL模型。<br>　　2、利用Modelsim仿真软件对所设计的AES密码处理器控制模块的Verilog RTL模型进行功能仿真。</p>
<h2 id="三、实验环境-3"><a href="#三、实验环境-3" class="headerlink" title="三、实验环境"></a>三、实验环境</h2><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h2 id="四、实验步骤-3"><a href="#四、实验步骤-3" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h2><p><strong>1、控制模块的电路结构设计</strong><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/551.png" alt=""><br>　　AES控制模块的外部信号如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/552.png" alt=""><br>　　AES控制模块由密钥扩展状态机、加密状态机、解密状态机以及其它少量组合逻辑构成。<br>　　其中密钥扩展状态机用于控制密钥扩展过程的执行，加密状态机用于控制加密过程的执行，解密状态机用于控制解密过程的执行。<br>　　密钥扩展状态机用于产生密钥扩展过程中所使用的控制信号，它由12个状态构成，其状态的划分和定义如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/553.png" alt=""><br>　　AES密钥扩展状态机的状态转移图如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/554.png" alt=""><br>　　AES密钥扩展状态机的状态转移及控制信号取值表如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/555.png" alt=""><br>　　AES加密状态机用于产生加密过程中所使用的控制信号，它由12个状态构成，其状态的划分和定义如下表所示。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/556.png" alt=""><br>　　AES加密状态机的状态转移图如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/557.png" alt=""><br>　　AES加密状态机的状态转移及控制信号取值表如下：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/558.png" alt=""><br>　　AES解密状态机用于产生解密过程中所使用的控制信号，它由12个状态构成，其状态的划分和定义如下表所示。<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/559.png" alt=""><br>　　AES解密状态机的状态转移图与加密状态机的状态转移图类似，其状态转移及控制信号取值如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/5510.png" alt=""></p>
<p><strong>2、建立控制模块的Verilog模型</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> aescontrol(clk,rst,load,address,keyexp,staenc,stadec,keyexprdy,encdecrdy,keysel,rndkren,wrrndkrf,krfaddr,rconen,wrsben,wrsbaddr,keyadsel,mixsel,reginsel,wrregen,wrpckreg);</div><div class="line"></div><div class="line"><span class="keyword">output</span> keyexprdy,encdecrdy,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">output</span> wrsben,mixsel,reginsel,wrregen,wrpckreg;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] krfaddr,wrsbaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,load,keyexp,staenc,stadec;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"></div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] wrkrfaddr,rdkrfaddre,rdkrfaddrd,encstate,decstate;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsele,keyadseld;</div><div class="line"><span class="keyword">wire</span> mixsele,reginsele,wrregene,encrdy,mixseld,reginseld,wrregend,decrdy;</div><div class="line"></div><div class="line"><span class="keyword">assign</span> krfaddr=(encstate != <span class="number">4'd0</span>)? rdkrfaddre:((decstate != <span class="number">4'd0</span>)?rdkrfaddrd:wrkrfaddr);</div><div class="line"><span class="keyword">assign</span> keyadsel=(encstate != <span class="number">4'd0</span>)? keyadsele:keyadseld;</div><div class="line"><span class="keyword">assign</span> mixsel=(encstate != <span class="number">4'd0</span>)? mixsele:mixseld;</div><div class="line"><span class="keyword">assign</span> reginsel=(encstate != <span class="number">4'd0</span>)? reginsele:reginseld;</div><div class="line"><span class="keyword">assign</span> wrregen=(encstate != <span class="number">4'd0</span>)? wrregene:wrregend;</div><div class="line"><span class="keyword">assign</span> encdecrdy=encrdy &amp; decrdy;</div><div class="line"></div><div class="line">keyexpfsm  keyexpfsm(clk,rst,keyexp,keysel,rndkren,wrrndkrf,wrkrfaddr,rconen,keyexprdy);</div><div class="line">encryfsm   encryfsm(clk,rst,staenc,keyadsele,mixsele,reginsele,wrregene,rdkrfaddre,encrdy,encstate);</div><div class="line">decryfsm   decryfsm(clk,rst,stadec,keyadseld,mixseld,reginseld,wrregend,rdkrfaddrd,decrdy,decstate);</div><div class="line"></div><div class="line"><span class="keyword">assign</span> wrsben=load &amp; ~address[<span class="number">4</span>];</div><div class="line"><span class="keyword">assign</span> wrsbaddr=address[<span class="number">3</span>:<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> wrpckreg=load &amp; address[<span class="number">4</span>] &amp; ~address[<span class="number">3</span>] &amp; ~address[<span class="number">2</span>] &amp; ~address[<span class="number">1</span>] &amp; ~address[<span class="number">0</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"><span class="keyword">module</span> keyexpfsm(clk,rst,keyexp,keysel,rndkren,wrrndkrf,wrkrfaddr,rconen,keyexprdy);</div><div class="line"><span class="keyword">output</span> keysel,rndkren,wrrndkrf,rconen,keyexprdy;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] wrkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,keyexp;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,wrkrfaddr;</div><div class="line"><span class="keyword">reg</span> keysel,rndkren,keyexprdy;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> keyexp)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(keyexp == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                  <span class="keyword">else</span></div><div class="line">                           next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keysel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: keysel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd2</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    keysel=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: keysel=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rndkren=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    rndkren=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: rndkren=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> wrrndkrf=rndkren;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd2</span>: wrkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd4</span>: wrkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd5</span>: wrkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd6</span>: wrkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: wrkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd8</span>: wrkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd9</span>: wrkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="keyword">default</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> rconen=keysel;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyexprdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: keyexprdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> encryfsm(clk,rst,staenc,keyadsel,mixsel,reginsel,wrregen,rdkrfaddr,encrdy,state);</div><div class="line"><span class="keyword">output</span> wrregen,mixsel,reginsel,encrdy,state;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] rdkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,staenc;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,rdkrfaddr;</div><div class="line"><span class="keyword">reg</span> wrregen,encrdy;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> staenc)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(staenc == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                       next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrregen=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: wrregen=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> mixsel=<span class="number">0</span>;</div><div class="line"><span class="keyword">assign</span> reginsel=<span class="number">0</span>;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd1</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd2</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd3</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd4</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd5</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd6</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd7</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd8</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd9</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd10</span>:    keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd11</span>:    keyadsel=<span class="number">2'b10</span>;</div><div class="line">              <span class="keyword">default</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd2</span>: rdkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd3</span>: rdkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd4</span>: rdkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd5</span>: rdkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd6</span>: rdkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: rdkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd8</span>: rdkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd9</span>: rdkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd10</span>:    rdkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd11</span>:    rdkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="keyword">default</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: encrdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: encrdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> decryfsm(clk,rst,stadec,keyadsel,mixsel,reginsel,wrregen,rdkrfaddr,decrdy,state);</div><div class="line"><span class="keyword">output</span> wrregen,mixsel,reginsel,decrdy,state;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] rdkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,stadec;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,rdkrfaddr;</div><div class="line"><span class="keyword">reg</span> wrregen,decrdy,reginsel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> stadec)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(stadec == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                        <span class="keyword">else</span></div><div class="line">                           next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrregen=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: wrregen=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: reginsel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: reginsel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd2</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    reginsel=<span class="number">0</span>;</div><div class="line">              <span class="keyword">default</span>: reginsel=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> mixsel=reginsel;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd1</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd2</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd3</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd4</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd5</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd6</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd7</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd8</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd9</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd10</span>:    keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd11</span>:    keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="keyword">default</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: rdkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd2</span>: rdkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd3</span>: rdkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd4</span>: rdkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd5</span>: rdkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: rdkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: rdkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd8</span>: rdkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd9</span>: rdkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd10</span>:    rdkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd11</span>:    rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>:    rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: decrdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: decrdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计控制模块的测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> aescontrol_tb;</div><div class="line"><span class="keyword">wire</span>  keyexprdy,encdecrdy,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">wire</span>  wrsben,mixsel,reginsel,wrregen,wrpckreg;</div><div class="line"><span class="keyword">wire</span>  [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">wire</span>  [<span class="number">3</span>:<span class="number">0</span>] krfaddr,wrsbaddr;</div><div class="line"><span class="keyword">reg</span>   clk,rst,load,keyexp,staenc,stadec;</div><div class="line"><span class="keyword">reg</span>   [<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"></div><div class="line">aescontrol  aescontrol(clk,rst,load,address,keyexp,staenc,stadec,keyexprdy,encdecrdy,keysel,rndkren,wrrndkrf,krfaddr,rconen,wrsben,wrsbaddr,keyadsel,mixsel,reginsel,wrregen,wrpckreg);</div><div class="line"></div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        #<span class="number">20</span>  rst=<span class="number">1</span>;<span class="comment">//test reset.</span></div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">200</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>; <span class="comment">//test load data.</span></div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd1</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd2</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd3</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd4</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd5</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">     #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd6</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd7</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd8</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd9</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd10</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd11</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd12</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd13</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd14</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd15</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd17</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd18</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd19</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd20</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd21</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd22</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">     #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd23</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd24</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd25</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd26</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">     #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd27</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd28</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd29</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd30</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd31</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexp=<span class="number">1</span>;<span class="comment">//test cipher key expansion.</span></div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd1</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">1200</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd2</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">1</span>;<span class="comment">//test start encryption.</span></div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd3</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">1200</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd16</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">1</span>;<span class="comment">//tset start decryption.</span></div><div class="line">      #<span class="number">100</span>  rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd17</span>;</div><div class="line">             keyexp=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">      #<span class="number">1200</span> <span class="built_in">$finish</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>4、将控制模块的设计文件和测试文件输入Modelsim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观测制模块的仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="五、实验结果-2"><a href="#五、实验结果-2" class="headerlink" title="五、实验结果"></a>五、实验结果</h2><p>　　参见Modelsim中的仿真波形图,列出下列实验结果表。<br>　　AES密码处理器控制模块仿真结果：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/5511.png" alt=""><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/5512.png" alt=""><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/5513.png" alt=""><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/5514.png" alt=""><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/5515.png" alt=""></p>
<h2 id="六、实验结论-2"><a href="#六、实验结论-2" class="headerlink" title="六、实验结论"></a>六、实验结论</h2><p>　　本实验设计了AES密码处理器控制模块的Verilog模型及其测试程序，并分别对其复位、数据装载、密钥扩展、加密、解密功能进行了仿真，仿真结果全部正确，这说明所设计的控制模块的功能是正确的。</p>
<h1 id="AES密码处理器的系统集成与仿真"><a href="#AES密码处理器的系统集成与仿真" class="headerlink" title="AES密码处理器的系统集成与仿真"></a>AES密码处理器的系统集成与仿真</h1><h2 id="一、实验目的-4"><a href="#一、实验目的-4" class="headerlink" title="一、实验目的"></a>一、实验目的</h2><p>　　掌握AES密码处理器的系统集成与仿真方法。</p>
<h2 id="二、实验内容-4"><a href="#二、实验内容-4" class="headerlink" title="二、实验内容"></a>二、实验内容</h2><p>　　1、对AES密码处理器进行系统集成，得到顶层模块。<br>　　2、利用Modelsim仿真软件对所设计AES密码处理器的顶层模块进行功能仿真。</p>
<h2 id="三、实验环境-4"><a href="#三、实验环境-4" class="headerlink" title="三、实验环境"></a>三、实验环境</h2><p>　　PC机1台、Modelsim仿真软件1套。</p>
<h2 id="四、实验步骤-4"><a href="#四、实验步骤-4" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h2><p><strong>1、AES密码处理器顶层模块的电路结构</strong><br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/661.png" alt=""><br>　　AES密码处理器顶层模块的外部信号如下表所示：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/662.png" alt=""><br><strong>2、对AES密码处理器进行系统集成，建立顶层模块的Verilog模型。</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div><div class="line">917</div><div class="line">918</div><div class="line">919</div><div class="line">920</div><div class="line">921</div><div class="line">922</div><div class="line">923</div><div class="line">924</div><div class="line">925</div><div class="line">926</div><div class="line">927</div><div class="line">928</div><div class="line">929</div><div class="line">930</div><div class="line">931</div><div class="line">932</div><div class="line">933</div><div class="line">934</div><div class="line">935</div><div class="line">936</div><div class="line">937</div><div class="line">938</div><div class="line">939</div><div class="line">940</div><div class="line">941</div><div class="line">942</div><div class="line">943</div><div class="line">944</div><div class="line">945</div><div class="line">946</div><div class="line">947</div><div class="line">948</div><div class="line">949</div><div class="line">950</div><div class="line">951</div><div class="line">952</div><div class="line">953</div><div class="line">954</div><div class="line">955</div><div class="line">956</div><div class="line">957</div><div class="line">958</div><div class="line">959</div><div class="line">960</div><div class="line">961</div><div class="line">962</div><div class="line">963</div><div class="line">964</div><div class="line">965</div><div class="line">966</div><div class="line">967</div><div class="line">968</div><div class="line">969</div><div class="line">970</div><div class="line">971</div><div class="line">972</div><div class="line">973</div><div class="line">974</div><div class="line">975</div><div class="line">976</div><div class="line">977</div><div class="line">978</div><div class="line">979</div><div class="line">980</div><div class="line">981</div><div class="line">982</div><div class="line">983</div><div class="line">984</div><div class="line">985</div><div class="line">986</div><div class="line">987</div><div class="line">988</div><div class="line">989</div><div class="line">990</div><div class="line">991</div><div class="line">992</div><div class="line">993</div><div class="line">994</div><div class="line">995</div><div class="line">996</div><div class="line">997</div><div class="line">998</div><div class="line">999</div><div class="line">1000</div><div class="line">1001</div><div class="line">1002</div><div class="line">1003</div><div class="line">1004</div><div class="line">1005</div><div class="line">1006</div><div class="line">1007</div><div class="line">1008</div><div class="line">1009</div><div class="line">1010</div><div class="line">1011</div><div class="line">1012</div><div class="line">1013</div><div class="line">1014</div><div class="line">1015</div><div class="line">1016</div><div class="line">1017</div><div class="line">1018</div><div class="line">1019</div><div class="line">1020</div><div class="line">1021</div><div class="line">1022</div><div class="line">1023</div><div class="line">1024</div><div class="line">1025</div><div class="line">1026</div><div class="line">1027</div><div class="line">1028</div><div class="line">1029</div><div class="line">1030</div><div class="line">1031</div><div class="line">1032</div><div class="line">1033</div><div class="line">1034</div><div class="line">1035</div><div class="line">1036</div><div class="line">1037</div><div class="line">1038</div><div class="line">1039</div><div class="line">1040</div><div class="line">1041</div><div class="line">1042</div><div class="line">1043</div><div class="line">1044</div><div class="line">1045</div><div class="line">1046</div><div class="line">1047</div><div class="line">1048</div><div class="line">1049</div><div class="line">1050</div><div class="line">1051</div><div class="line">1052</div><div class="line">1053</div><div class="line">1054</div><div class="line">1055</div><div class="line">1056</div><div class="line">1057</div><div class="line">1058</div><div class="line">1059</div><div class="line">1060</div><div class="line">1061</div><div class="line">1062</div><div class="line">1063</div><div class="line">1064</div><div class="line">1065</div><div class="line">1066</div><div class="line">1067</div><div class="line">1068</div><div class="line">1069</div><div class="line">1070</div><div class="line">1071</div><div class="line">1072</div><div class="line">1073</div><div class="line">1074</div><div class="line">1075</div><div class="line">1076</div><div class="line">1077</div><div class="line">1078</div><div class="line">1079</div><div class="line">1080</div><div class="line">1081</div><div class="line">1082</div><div class="line">1083</div><div class="line">1084</div><div class="line">1085</div><div class="line">1086</div><div class="line">1087</div><div class="line">1088</div><div class="line">1089</div><div class="line">1090</div><div class="line">1091</div><div class="line">1092</div><div class="line">1093</div><div class="line">1094</div><div class="line">1095</div><div class="line">1096</div><div class="line">1097</div><div class="line">1098</div><div class="line">1099</div><div class="line">1100</div><div class="line">1101</div><div class="line">1102</div><div class="line">1103</div><div class="line">1104</div><div class="line">1105</div><div class="line">1106</div><div class="line">1107</div><div class="line">1108</div><div class="line">1109</div><div class="line">1110</div><div class="line">1111</div><div class="line">1112</div><div class="line">1113</div><div class="line">1114</div><div class="line">1115</div><div class="line">1116</div><div class="line">1117</div><div class="line">1118</div><div class="line">1119</div><div class="line">1120</div><div class="line">1121</div><div class="line">1122</div><div class="line">1123</div><div class="line">1124</div><div class="line">1125</div><div class="line">1126</div><div class="line">1127</div><div class="line">1128</div><div class="line">1129</div><div class="line">1130</div><div class="line">1131</div><div class="line">1132</div><div class="line">1133</div><div class="line">1134</div><div class="line">1135</div><div class="line">1136</div><div class="line">1137</div><div class="line">1138</div><div class="line">1139</div><div class="line">1140</div><div class="line">1141</div><div class="line">1142</div><div class="line">1143</div><div class="line">1144</div><div class="line">1145</div><div class="line">1146</div><div class="line">1147</div><div class="line">1148</div><div class="line">1149</div><div class="line">1150</div><div class="line">1151</div><div class="line">1152</div><div class="line">1153</div><div class="line">1154</div><div class="line">1155</div><div class="line">1156</div><div class="line">1157</div><div class="line">1158</div><div class="line">1159</div><div class="line">1160</div><div class="line">1161</div><div class="line">1162</div><div class="line">1163</div><div class="line">1164</div><div class="line">1165</div><div class="line">1166</div><div class="line">1167</div><div class="line">1168</div><div class="line">1169</div><div class="line">1170</div><div class="line">1171</div><div class="line">1172</div><div class="line">1173</div><div class="line">1174</div><div class="line">1175</div><div class="line">1176</div><div class="line">1177</div><div class="line">1178</div><div class="line">1179</div><div class="line">1180</div><div class="line">1181</div><div class="line">1182</div><div class="line">1183</div><div class="line">1184</div><div class="line">1185</div><div class="line">1186</div><div class="line">1187</div><div class="line">1188</div><div class="line">1189</div><div class="line">1190</div><div class="line">1191</div><div class="line">1192</div><div class="line">1193</div><div class="line">1194</div><div class="line">1195</div><div class="line">1196</div><div class="line">1197</div><div class="line">1198</div><div class="line">1199</div><div class="line">1200</div><div class="line">1201</div><div class="line">1202</div><div class="line">1203</div><div class="line">1204</div><div class="line">1205</div><div class="line">1206</div><div class="line">1207</div><div class="line">1208</div><div class="line">1209</div><div class="line">1210</div><div class="line">1211</div><div class="line">1212</div><div class="line">1213</div><div class="line">1214</div><div class="line">1215</div><div class="line">1216</div><div class="line">1217</div><div class="line">1218</div><div class="line">1219</div><div class="line">1220</div><div class="line">1221</div><div class="line">1222</div><div class="line">1223</div><div class="line">1224</div><div class="line">1225</div><div class="line">1226</div><div class="line">1227</div><div class="line">1228</div><div class="line">1229</div><div class="line">1230</div><div class="line">1231</div><div class="line">1232</div><div class="line">1233</div><div class="line">1234</div><div class="line">1235</div><div class="line">1236</div><div class="line">1237</div><div class="line">1238</div><div class="line">1239</div><div class="line">1240</div><div class="line">1241</div><div class="line">1242</div><div class="line">1243</div><div class="line">1244</div><div class="line">1245</div><div class="line">1246</div><div class="line">1247</div><div class="line">1248</div><div class="line">1249</div><div class="line">1250</div><div class="line">1251</div><div class="line">1252</div><div class="line">1253</div><div class="line">1254</div><div class="line">1255</div><div class="line">1256</div><div class="line">1257</div><div class="line">1258</div><div class="line">1259</div><div class="line">1260</div><div class="line">1261</div><div class="line">1262</div><div class="line">1263</div><div class="line">1264</div><div class="line">1265</div><div class="line">1266</div><div class="line">1267</div><div class="line">1268</div><div class="line">1269</div><div class="line">1270</div><div class="line">1271</div><div class="line">1272</div><div class="line">1273</div><div class="line">1274</div><div class="line">1275</div><div class="line">1276</div><div class="line">1277</div><div class="line">1278</div><div class="line">1279</div><div class="line">1280</div><div class="line">1281</div><div class="line">1282</div><div class="line">1283</div><div class="line">1284</div><div class="line">1285</div><div class="line">1286</div><div class="line">1287</div><div class="line">1288</div><div class="line">1289</div><div class="line">1290</div><div class="line">1291</div><div class="line">1292</div><div class="line">1293</div><div class="line">1294</div><div class="line">1295</div><div class="line">1296</div><div class="line">1297</div><div class="line">1298</div><div class="line">1299</div><div class="line">1300</div><div class="line">1301</div><div class="line">1302</div><div class="line">1303</div><div class="line">1304</div><div class="line">1305</div><div class="line">1306</div><div class="line">1307</div><div class="line">1308</div><div class="line">1309</div><div class="line">1310</div><div class="line">1311</div><div class="line">1312</div><div class="line">1313</div><div class="line">1314</div><div class="line">1315</div><div class="line">1316</div><div class="line">1317</div><div class="line">1318</div><div class="line">1319</div><div class="line">1320</div><div class="line">1321</div><div class="line">1322</div><div class="line">1323</div><div class="line">1324</div><div class="line">1325</div><div class="line">1326</div><div class="line">1327</div><div class="line">1328</div><div class="line">1329</div><div class="line">1330</div><div class="line">1331</div><div class="line">1332</div><div class="line">1333</div><div class="line">1334</div><div class="line">1335</div><div class="line">1336</div><div class="line">1337</div><div class="line">1338</div><div class="line">1339</div><div class="line">1340</div><div class="line">1341</div><div class="line">1342</div><div class="line">1343</div><div class="line">1344</div><div class="line">1345</div><div class="line">1346</div><div class="line">1347</div><div class="line">1348</div><div class="line">1349</div><div class="line">1350</div><div class="line">1351</div><div class="line">1352</div><div class="line">1353</div><div class="line">1354</div><div class="line">1355</div><div class="line">1356</div><div class="line">1357</div><div class="line">1358</div><div class="line">1359</div><div class="line">1360</div><div class="line">1361</div><div class="line">1362</div><div class="line">1363</div><div class="line">1364</div><div class="line">1365</div><div class="line">1366</div><div class="line">1367</div><div class="line">1368</div><div class="line">1369</div><div class="line">1370</div><div class="line">1371</div><div class="line">1372</div><div class="line">1373</div><div class="line">1374</div><div class="line">1375</div><div class="line">1376</div><div class="line">1377</div><div class="line">1378</div><div class="line">1379</div><div class="line">1380</div><div class="line">1381</div><div class="line">1382</div><div class="line">1383</div><div class="line">1384</div><div class="line">1385</div><div class="line">1386</div><div class="line">1387</div><div class="line">1388</div><div class="line">1389</div><div class="line">1390</div><div class="line">1391</div><div class="line">1392</div><div class="line">1393</div><div class="line">1394</div><div class="line">1395</div><div class="line">1396</div><div class="line">1397</div><div class="line">1398</div><div class="line">1399</div><div class="line">1400</div><div class="line">1401</div><div class="line">1402</div><div class="line">1403</div><div class="line">1404</div><div class="line">1405</div><div class="line">1406</div><div class="line">1407</div><div class="line">1408</div><div class="line">1409</div><div class="line">1410</div><div class="line">1411</div><div class="line">1412</div><div class="line">1413</div><div class="line">1414</div><div class="line">1415</div><div class="line">1416</div><div class="line">1417</div><div class="line">1418</div><div class="line">1419</div><div class="line">1420</div><div class="line">1421</div><div class="line">1422</div><div class="line">1423</div><div class="line">1424</div><div class="line">1425</div><div class="line">1426</div><div class="line">1427</div><div class="line">1428</div><div class="line">1429</div><div class="line">1430</div><div class="line">1431</div><div class="line">1432</div><div class="line">1433</div><div class="line">1434</div><div class="line">1435</div><div class="line">1436</div><div class="line">1437</div><div class="line">1438</div><div class="line">1439</div><div class="line">1440</div><div class="line">1441</div><div class="line">1442</div><div class="line">1443</div><div class="line">1444</div><div class="line">1445</div><div class="line">1446</div><div class="line">1447</div><div class="line">1448</div><div class="line">1449</div><div class="line">1450</div><div class="line">1451</div><div class="line">1452</div><div class="line">1453</div><div class="line">1454</div><div class="line">1455</div><div class="line">1456</div><div class="line">1457</div><div class="line">1458</div><div class="line">1459</div><div class="line">1460</div><div class="line">1461</div><div class="line">1462</div><div class="line">1463</div><div class="line">1464</div><div class="line">1465</div><div class="line">1466</div><div class="line">1467</div><div class="line">1468</div><div class="line">1469</div><div class="line">1470</div><div class="line">1471</div><div class="line">1472</div><div class="line">1473</div><div class="line">1474</div><div class="line">1475</div><div class="line">1476</div><div class="line">1477</div><div class="line">1478</div><div class="line">1479</div><div class="line">1480</div><div class="line">1481</div><div class="line">1482</div><div class="line">1483</div><div class="line">1484</div><div class="line">1485</div><div class="line">1486</div><div class="line">1487</div><div class="line">1488</div><div class="line">1489</div><div class="line">1490</div><div class="line">1491</div><div class="line">1492</div><div class="line">1493</div><div class="line">1494</div><div class="line">1495</div><div class="line">1496</div><div class="line">1497</div><div class="line">1498</div><div class="line">1499</div><div class="line">1500</div><div class="line">1501</div><div class="line">1502</div><div class="line">1503</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> aes(clk,rst,load,address,keyexpen,staenc,stadec,</div><div class="line">din,keyexprdy,encdecrdy,dout);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">output</span> keyexprdy,encdecrdy;</div><div class="line"><span class="keyword">input</span>  clk,rst,load,keyexpen,staenc,stadec;</div><div class="line"><span class="keyword">input</span>  [<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"><span class="keyword">input</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"></div><div class="line"><span class="keyword">wire</span>  wrpckreg,keysel,rndkren,wrrndkrf,rconen,wrsben,mixsel,reginsel,wrregen;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] pckregout,roundkey;</div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] krfaddr,wrsbaddr;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"></div><div class="line">reg_128     pckreg(clk,wrpckreg,din,pckregout);</div><div class="line">aescontrol  control(clk,rst,load,address,keyexpen,staenc,stadec,</div><div class="line">keyexprdy,encdecrdy,keysel,rndkren,</div><div class="line">wrrndkrf,krfaddr,rconen,wrsben,wrsbaddr,</div><div class="line">keyadsel,mixsel,reginsel,wrregen,wrpckreg);</div><div class="line">keyexp  keyexp(clk,rst,keysel,rndkren,wrrndkrf,krfaddr,</div><div class="line">rconen,pckregout,roundkey);</div><div class="line">crydap  crydap(clk,wrsben,wrsbaddr,din,keyadsel,mixsel,</div><div class="line">reginsel,wrregen,pckregout,roundkey,dout);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> reg_128(clk,write,din,dout);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">input</span>  clk,write;</div><div class="line"><span class="keyword">input</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">          <span class="keyword">if</span>(write)</div><div class="line">            dout&lt;=din;</div><div class="line">          <span class="keyword">else</span></div><div class="line">            dout&lt;=dout;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> aescontrol(clk,rst,load,address,keyexp,staenc,stadec,keyexprdy,encdecrdy,</div><div class="line">                  keysel,rndkren,wrrndkrf,krfaddr,rconen,</div><div class="line">                  wrsben,wrsbaddr,keyadsel,mixsel,reginsel,wrregen,wrpckreg);</div><div class="line"><span class="keyword">output</span> keyexprdy,encdecrdy,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">output</span> wrsben,mixsel,reginsel,wrregen,wrpckreg;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] krfaddr,wrsbaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,load,keyexp,staenc,stadec;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] wrkrfaddr,rdkrfaddre,rdkrfaddrd,encstate,decstate;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsele,keyadseld;</div><div class="line"><span class="keyword">wire</span> mixsele,reginsele,wrregene,encrdy,mixseld,reginseld,wrregend,decrdy;</div><div class="line"><span class="keyword">assign</span> krfaddr=(encstate != <span class="number">4'd0</span>)? rdkrfaddre:((decstate != <span class="number">4'd0</span>)?rdkrfaddrd:wrkrfaddr);</div><div class="line"><span class="keyword">assign</span> keyadsel=(encstate != <span class="number">4'd0</span>)? keyadsele:keyadseld;</div><div class="line"><span class="keyword">assign</span> mixsel=(encstate != <span class="number">4'd0</span>)? mixsele:mixseld;</div><div class="line"><span class="keyword">assign</span> reginsel=(encstate != <span class="number">4'd0</span>)? reginsele:reginseld;</div><div class="line"><span class="keyword">assign</span> wrregen=(encstate != <span class="number">4'd0</span>)? wrregene:wrregend;</div><div class="line"><span class="keyword">assign</span> encdecrdy=encrdy &amp; decrdy;</div><div class="line">keyexpfsm  keyexpfsm(clk,rst,keyexp,keysel,rndkren,wrrndkrf,wrkrfaddr,rconen,keyexprdy);</div><div class="line">encryfsm   encryfsm(clk,rst,staenc,keyadsele,mixsele,reginsele,wrregene,rdkrfaddre,encrdy,encstate);</div><div class="line">decryfsm   decryfsm(clk,rst,stadec,keyadseld,mixseld,reginseld,wrregend,rdkrfaddrd,decrdy,decstate);</div><div class="line"><span class="keyword">assign</span> wrsben=load &amp; ~address[<span class="number">4</span>];</div><div class="line"><span class="keyword">assign</span> wrsbaddr=address[<span class="number">3</span>:<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> wrpckreg=load &amp; address[<span class="number">4</span>] &amp; ~address[<span class="number">3</span>] &amp; ~address[<span class="number">2</span>] &amp; ~address[<span class="number">1</span>] &amp; ~address[<span class="number">0</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> keyexpfsm(clk,rst,keyexp,keysel,rndkren,wrrndkrf,wrkrfaddr,rconen,keyexprdy);</div><div class="line"><span class="keyword">output</span> keysel,rndkren,wrrndkrf,rconen,keyexprdy;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] wrkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,keyexp;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,wrkrfaddr;</div><div class="line"><span class="keyword">reg</span> keysel,rndkren,keyexprdy;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> keyexp)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(keyexp == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                  <span class="keyword">else</span></div><div class="line">                           next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keysel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: keysel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd2</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    keysel=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: keysel=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rndkren=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    rndkren=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: rndkren=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> wrrndkrf=rndkren;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd2</span>: wrkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd4</span>: wrkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd5</span>: wrkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd6</span>: wrkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: wrkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd8</span>: wrkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd9</span>: wrkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="keyword">default</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> rconen=keysel;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyexprdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: keyexprdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> encryfsm(clk,rst,staenc,keyadsel,mixsel,reginsel,wrregen,rdkrfaddr,encrdy,state);</div><div class="line"><span class="keyword">output</span> wrregen,mixsel,reginsel,encrdy,state;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] rdkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,staenc;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,rdkrfaddr;</div><div class="line"><span class="keyword">reg</span> wrregen,encrdy;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> staenc)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(staenc == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                       next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrregen=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: wrregen=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> mixsel=<span class="number">0</span>;</div><div class="line"><span class="keyword">assign</span> reginsel=<span class="number">0</span>;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd1</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd2</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd3</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd4</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd5</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd6</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd7</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd8</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd9</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd10</span>:    keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd11</span>:    keyadsel=<span class="number">2'b10</span>;</div><div class="line">              <span class="keyword">default</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd2</span>: rdkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd3</span>: rdkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd4</span>: rdkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd5</span>: rdkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd6</span>: rdkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: rdkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd8</span>: rdkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd9</span>: rdkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd10</span>:    rdkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd11</span>:    rdkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="keyword">default</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: encrdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: encrdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> decryfsm(clk,rst,stadec,keyadsel,mixsel,reginsel,wrregen,rdkrfaddr,decrdy,state);</div><div class="line"><span class="keyword">output</span> wrregen,mixsel,reginsel,decrdy,state;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] rdkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,stadec;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,rdkrfaddr;</div><div class="line"><span class="keyword">reg</span> wrregen,decrdy,reginsel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> stadec)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(stadec == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                        <span class="keyword">else</span></div><div class="line">                           next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrregen=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: wrregen=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: reginsel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: reginsel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd2</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    reginsel=<span class="number">0</span>;</div><div class="line">              <span class="keyword">default</span>: reginsel=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> mixsel=reginsel;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd1</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd2</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd3</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd4</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd5</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd6</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd7</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd8</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd9</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd10</span>:    keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd11</span>:    keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="keyword">default</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: rdkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd2</span>: rdkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd3</span>: rdkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd4</span>: rdkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd5</span>: rdkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: rdkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: rdkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd8</span>: rdkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd9</span>: rdkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd10</span>:    rdkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd11</span>:    rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>:    rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: decrdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: decrdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> keyexp(clk,rst,keysel,rndkren,wrrndkrf,addr,rconen,key,rndkrfout);</div><div class="line"><span class="keyword">output</span>[<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">input</span> clk,rst,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">input</span>[<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">input</span>[<span class="number">127</span>:<span class="number">0</span>] key;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] rndkey,rndkrout,rndkrfout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w4,w5,w6,w7,rotword,subword,xorrcon;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"><span class="keyword">assign</span> rndkey=(keysel==<span class="number">0</span>) ? key:&#123;w4,w5,w6,w7&#125;;</div><div class="line">reg_128 rndkreg(clk,rndkren,rndkey,rndkrout);</div><div class="line">rndkrf rndkrf(clk,wrrndkrf,addr,rndkey,rndkrfout);</div><div class="line"><span class="keyword">assign</span> rotword=&#123;rndkrout[<span class="number">23</span>:<span class="number">0</span>],rndkrout[<span class="number">31</span>:<span class="number">24</span>]&#125;;</div><div class="line">sbox_mux sbox0(rotword[<span class="number">31</span>:<span class="number">24</span>],subword[<span class="number">31</span>:<span class="number">24</span>]);</div><div class="line">sbox_mux sbox1(rotword[<span class="number">23</span>:<span class="number">16</span>],subword[<span class="number">23</span>:<span class="number">16</span>]);</div><div class="line">sbox_mux sbox2(rotword[<span class="number">15</span>:<span class="number">8</span>],subword[<span class="number">15</span>:<span class="number">8</span>]);</div><div class="line">sbox_mux sbox3(rotword[<span class="number">7</span>:<span class="number">0</span>],subword[<span class="number">7</span>:<span class="number">0</span>]);</div><div class="line">rcon rcon(clk,rst,rconen,rconout);</div><div class="line"><span class="keyword">assign</span> xorrcon=subword^&#123;rconout,<span class="number">24'h000000</span>&#125;;</div><div class="line"><span class="keyword">assign</span> w4=xorrcon^rndkrout[<span class="number">127</span>:<span class="number">96</span>];</div><div class="line"><span class="keyword">assign</span> w5=w4^rndkrout[<span class="number">95</span>:<span class="number">64</span>];</div><div class="line"><span class="keyword">assign</span> w6=w5^rndkrout[<span class="number">63</span>:<span class="number">32</span>];</div><div class="line"><span class="keyword">assign</span> w7=w6^rndkrout[<span class="number">31</span>:<span class="number">0</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> rndkrf(clk,wrrndkrf,addr,rndkey,rndkrfout);</div><div class="line"><span class="keyword">input</span> clk,wrrndkrf;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] rndkey;</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">reg</span> [<span class="number">10</span>:<span class="number">0</span>] decout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">10</span>:<span class="number">0</span>] write_reg;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] reg0out,reg1out,reg2out,reg3out,reg4out,reg5out,reg6out,reg7out,reg8out,reg9out,reg10out;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">always</span> @ (addr)</div><div class="line"><span class="keyword">case</span>(addr)</div><div class="line"><span class="number">4'd0</span>: decout=<span class="number">11'b000_0000_0001</span>;</div><div class="line"><span class="number">4'd1</span>: decout=<span class="number">11'b000_0000_0010</span>;</div><div class="line"><span class="number">4'd2</span>: decout=<span class="number">11'b000_0000_0100</span>;</div><div class="line"><span class="number">4'd3</span>: decout=<span class="number">11'b000_0000_1000</span>;</div><div class="line"><span class="number">4'd4</span>: decout=<span class="number">11'b000_0001_0000</span>;</div><div class="line"><span class="number">4'd5</span>: decout=<span class="number">11'b000_0010_0000</span>;</div><div class="line"><span class="number">4'd6</span>: decout=<span class="number">11'b000_0100_0000</span>;</div><div class="line"><span class="number">4'd7</span>: decout=<span class="number">11'b000_1000_0000</span>;</div><div class="line"><span class="number">4'd8</span>: decout=<span class="number">11'b001_0000_0000</span>;</div><div class="line"><span class="number">4'd9</span>: decout=<span class="number">11'b010_0000_0000</span>;</div><div class="line"><span class="number">4'd10</span>: decout=<span class="number">11'b100_0000_0000</span>;</div><div class="line"><span class="keyword">default</span>: decout=<span class="number">11'b000_0000_0000</span>;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">assign</span> write_reg=decout &amp; &#123;wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf&#125;;</div><div class="line"></div><div class="line">reg_128 reg0(clk,write_reg[<span class="number">0</span>],rndkey,reg0out);</div><div class="line">reg_128 reg1(clk,write_reg[<span class="number">1</span>],rndkey,reg1out);</div><div class="line">reg_128 reg2(clk,write_reg[<span class="number">2</span>],rndkey,reg2out);</div><div class="line">reg_128 reg3(clk,write_reg[<span class="number">3</span>],rndkey,reg3out);</div><div class="line">reg_128 reg4(clk,write_reg[<span class="number">4</span>],rndkey,reg4out);</div><div class="line">reg_128 reg5(clk,write_reg[<span class="number">5</span>],rndkey,reg5out);</div><div class="line">reg_128 reg6(clk,write_reg[<span class="number">6</span>],rndkey,reg6out);</div><div class="line">reg_128 reg7(clk,write_reg[<span class="number">7</span>],rndkey,reg7out);</div><div class="line">reg_128 reg8(clk,write_reg[<span class="number">8</span>],rndkey,reg8out);</div><div class="line">reg_128 reg9(clk,write_reg[<span class="number">9</span>],rndkey,reg9out);</div><div class="line">reg_128 reg10(clk,write_reg[<span class="number">10</span>],rndkey,reg10out);</div><div class="line"><span class="keyword">always</span> @(addr <span class="keyword">or</span> reg0out <span class="keyword">or</span> reg1out <span class="keyword">or</span> reg2out <span class="keyword">or</span> reg3out <span class="keyword">or</span> reg4out <span class="keyword">or</span> reg5out <span class="keyword">or</span> reg6out <span class="keyword">or</span> reg7out <span class="keyword">or</span> reg8out <span class="keyword">or</span> reg9out <span class="keyword">or</span> reg10out)</div><div class="line"><span class="keyword">case</span>(addr)</div><div class="line"><span class="number">4'd0</span>: rndkrfout=reg0out;</div><div class="line"><span class="number">4'd1</span>: rndkrfout=reg1out;</div><div class="line"><span class="number">4'd2</span>: rndkrfout=reg2out;</div><div class="line"><span class="number">4'd3</span>: rndkrfout=reg3out;</div><div class="line"><span class="number">4'd4</span>: rndkrfout=reg4out;</div><div class="line"><span class="number">4'd5</span>: rndkrfout=reg5out;</div><div class="line"><span class="number">4'd6</span>: rndkrfout=reg6out;</div><div class="line"><span class="number">4'd7</span>: rndkrfout=reg7out;</div><div class="line"><span class="number">4'd8</span>: rndkrfout=reg8out;</div><div class="line"><span class="number">4'd9</span>: rndkrfout=reg9out;</div><div class="line"><span class="number">4'd10</span>: rndkrfout=reg10out;</div><div class="line"><span class="keyword">default</span>: rndkrfout=reg10out;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> sbox_mux(in,out);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] out;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] in;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] out;</div><div class="line"><span class="keyword">always</span>@(in)</div><div class="line">  <span class="keyword">case</span>(in)</div><div class="line">    <span class="number">8'h00</span>: out=<span class="number">8'h63</span>;</div><div class="line">    <span class="number">8'h01</span>: out=<span class="number">8'h7c</span>;</div><div class="line">    <span class="number">8'h02</span>: out=<span class="number">8'h77</span>;</div><div class="line">    <span class="number">8'h03</span>: out=<span class="number">8'h7b</span>;</div><div class="line">    <span class="number">8'h04</span>: out=<span class="number">8'hf2</span>;</div><div class="line">    <span class="number">8'h05</span>: out=<span class="number">8'h6b</span>;</div><div class="line">    <span class="number">8'h06</span>: out=<span class="number">8'h6f</span>;</div><div class="line">    <span class="number">8'h07</span>: out=<span class="number">8'hc5</span>;</div><div class="line">    <span class="number">8'h08</span>: out=<span class="number">8'h30</span>;</div><div class="line">    <span class="number">8'h09</span>: out=<span class="number">8'h01</span>;</div><div class="line">    <span class="number">8'h0a</span>: out=<span class="number">8'h67</span>;</div><div class="line">    <span class="number">8'h0b</span>: out=<span class="number">8'h2b</span>;</div><div class="line">    <span class="number">8'h0c</span>: out=<span class="number">8'hfe</span>;</div><div class="line">    <span class="number">8'h0d</span>: out=<span class="number">8'hd7</span>;</div><div class="line">    <span class="number">8'h0e</span>: out=<span class="number">8'hab</span>;</div><div class="line">    <span class="number">8'h0f</span>: out=<span class="number">8'h76</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h10</span>: out=<span class="number">8'hca</span>;</div><div class="line">    <span class="number">8'h11</span>: out=<span class="number">8'h82</span>;</div><div class="line">    <span class="number">8'h12</span>: out=<span class="number">8'hc9</span>;</div><div class="line">    <span class="number">8'h13</span>: out=<span class="number">8'h7d</span>;</div><div class="line">    <span class="number">8'h14</span>: out=<span class="number">8'hfa</span>;</div><div class="line">    <span class="number">8'h15</span>: out=<span class="number">8'h59</span>;</div><div class="line">    <span class="number">8'h16</span>: out=<span class="number">8'h47</span>;</div><div class="line">    <span class="number">8'h17</span>: out=<span class="number">8'hf0</span>;</div><div class="line">    <span class="number">8'h18</span>: out=<span class="number">8'had</span>;</div><div class="line">    <span class="number">8'h19</span>: out=<span class="number">8'hd4</span>;</div><div class="line">    <span class="number">8'h1a</span>: out=<span class="number">8'ha2</span>;</div><div class="line">    <span class="number">8'h1b</span>: out=<span class="number">8'haf</span>;</div><div class="line">    <span class="number">8'h1c</span>: out=<span class="number">8'h9c</span>;</div><div class="line">    <span class="number">8'h1d</span>: out=<span class="number">8'ha4</span>;</div><div class="line">    <span class="number">8'h1e</span>: out=<span class="number">8'h72</span>;</div><div class="line">    <span class="number">8'h1f</span>: out=<span class="number">8'hc0</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h20</span>: out=<span class="number">8'hb7</span>;</div><div class="line">    <span class="number">8'h21</span>: out=<span class="number">8'hfd</span>;</div><div class="line">    <span class="number">8'h22</span>: out=<span class="number">8'h93</span>;</div><div class="line">    <span class="number">8'h23</span>: out=<span class="number">8'h26</span>;</div><div class="line">    <span class="number">8'h24</span>: out=<span class="number">8'h36</span>;</div><div class="line">    <span class="number">8'h25</span>: out=<span class="number">8'h3f</span>;</div><div class="line">    <span class="number">8'h26</span>: out=<span class="number">8'hf7</span>;</div><div class="line">    <span class="number">8'h27</span>: out=<span class="number">8'hcc</span>;</div><div class="line">    <span class="number">8'h28</span>: out=<span class="number">8'h34</span>;</div><div class="line">    <span class="number">8'h29</span>: out=<span class="number">8'ha5</span>;</div><div class="line">    <span class="number">8'h2a</span>: out=<span class="number">8'he5</span>;</div><div class="line">    <span class="number">8'h2b</span>: out=<span class="number">8'hf1</span>;</div><div class="line">    <span class="number">8'h2c</span>: out=<span class="number">8'h71</span>;</div><div class="line">    <span class="number">8'h2d</span>: out=<span class="number">8'hd8</span>;</div><div class="line">    <span class="number">8'h2e</span>: out=<span class="number">8'h31</span>;</div><div class="line">    <span class="number">8'h2f</span>: out=<span class="number">8'h15</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h30</span>: out=<span class="number">8'h04</span>;</div><div class="line">    <span class="number">8'h31</span>: out=<span class="number">8'hc7</span>;</div><div class="line">    <span class="number">8'h32</span>: out=<span class="number">8'h23</span>;</div><div class="line">    <span class="number">8'h33</span>: out=<span class="number">8'hc3</span>;</div><div class="line">    <span class="number">8'h34</span>: out=<span class="number">8'h18</span>;</div><div class="line">    <span class="number">8'h35</span>: out=<span class="number">8'h96</span>;</div><div class="line">    <span class="number">8'h36</span>: out=<span class="number">8'h05</span>;</div><div class="line">    <span class="number">8'h37</span>: out=<span class="number">8'h9a</span>;</div><div class="line">    <span class="number">8'h38</span>: out=<span class="number">8'h07</span>;</div><div class="line">    <span class="number">8'h39</span>: out=<span class="number">8'h12</span>;</div><div class="line">    <span class="number">8'h3a</span>: out=<span class="number">8'h80</span>;</div><div class="line">    <span class="number">8'h3b</span>: out=<span class="number">8'he2</span>;</div><div class="line">    <span class="number">8'h3c</span>: out=<span class="number">8'heb</span>;</div><div class="line">    <span class="number">8'h3d</span>: out=<span class="number">8'h27</span>;</div><div class="line">    <span class="number">8'h3e</span>: out=<span class="number">8'hb2</span>;</div><div class="line">    <span class="number">8'h3f</span>: out=<span class="number">8'h75</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h40</span>: out=<span class="number">8'h09</span>;</div><div class="line">    <span class="number">8'h41</span>: out=<span class="number">8'h83</span>;</div><div class="line">    <span class="number">8'h42</span>: out=<span class="number">8'h2c</span>;</div><div class="line">    <span class="number">8'h43</span>: out=<span class="number">8'h1a</span>;</div><div class="line">    <span class="number">8'h44</span>: out=<span class="number">8'h1b</span>;</div><div class="line">    <span class="number">8'h45</span>: out=<span class="number">8'h6e</span>;</div><div class="line">    <span class="number">8'h46</span>: out=<span class="number">8'h5a</span>;</div><div class="line">    <span class="number">8'h47</span>: out=<span class="number">8'ha0</span>;</div><div class="line">    <span class="number">8'h48</span>: out=<span class="number">8'h52</span>;</div><div class="line">    <span class="number">8'h49</span>: out=<span class="number">8'h3b</span>;</div><div class="line">    <span class="number">8'h4a</span>: out=<span class="number">8'hd6</span>;</div><div class="line">    <span class="number">8'h4b</span>: out=<span class="number">8'hb3</span>;</div><div class="line">    <span class="number">8'h4c</span>: out=<span class="number">8'h29</span>;</div><div class="line">    <span class="number">8'h4d</span>: out=<span class="number">8'he3</span>;</div><div class="line">    <span class="number">8'h4e</span>: out=<span class="number">8'h2f</span>;</div><div class="line">    <span class="number">8'h4f</span>: out=<span class="number">8'h84</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h50</span>: out=<span class="number">8'h53</span>;</div><div class="line">    <span class="number">8'h51</span>: out=<span class="number">8'hd1</span>;</div><div class="line">    <span class="number">8'h52</span>: out=<span class="number">8'h00</span>;</div><div class="line">    <span class="number">8'h53</span>: out=<span class="number">8'hed</span>;</div><div class="line">    <span class="number">8'h54</span>: out=<span class="number">8'h20</span>;</div><div class="line">    <span class="number">8'h55</span>: out=<span class="number">8'hfc</span>;</div><div class="line">    <span class="number">8'h56</span>: out=<span class="number">8'hb1</span>;</div><div class="line">    <span class="number">8'h57</span>: out=<span class="number">8'h5b</span>;</div><div class="line">    <span class="number">8'h58</span>: out=<span class="number">8'h6a</span>;</div><div class="line">    <span class="number">8'h59</span>: out=<span class="number">8'hcb</span>;</div><div class="line">    <span class="number">8'h5a</span>: out=<span class="number">8'hbe</span>;</div><div class="line">    <span class="number">8'h5b</span>: out=<span class="number">8'h39</span>;</div><div class="line">    <span class="number">8'h5c</span>: out=<span class="number">8'h4a</span>;</div><div class="line">    <span class="number">8'h5d</span>: out=<span class="number">8'h4c</span>;</div><div class="line">    <span class="number">8'h5e</span>: out=<span class="number">8'h58</span>;</div><div class="line">    <span class="number">8'h5f</span>: out=<span class="number">8'hcf</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h60</span>: out=<span class="number">8'hd0</span>;</div><div class="line">    <span class="number">8'h61</span>: out=<span class="number">8'hef</span>;</div><div class="line">    <span class="number">8'h62</span>: out=<span class="number">8'haa</span>;</div><div class="line">    <span class="number">8'h63</span>: out=<span class="number">8'hfb</span>;</div><div class="line">    <span class="number">8'h64</span>: out=<span class="number">8'h43</span>;</div><div class="line">    <span class="number">8'h65</span>: out=<span class="number">8'h4d</span>;</div><div class="line">    <span class="number">8'h66</span>: out=<span class="number">8'h33</span>;</div><div class="line">    <span class="number">8'h67</span>: out=<span class="number">8'h85</span>;</div><div class="line">    <span class="number">8'h68</span>: out=<span class="number">8'h45</span>;</div><div class="line">    <span class="number">8'h69</span>: out=<span class="number">8'hf9</span>;</div><div class="line">    <span class="number">8'h6a</span>: out=<span class="number">8'h02</span>;</div><div class="line">    <span class="number">8'h6b</span>: out=<span class="number">8'h7f</span>;</div><div class="line">    <span class="number">8'h6c</span>: out=<span class="number">8'h50</span>;</div><div class="line">    <span class="number">8'h6d</span>: out=<span class="number">8'h3c</span>;</div><div class="line">    <span class="number">8'h6e</span>: out=<span class="number">8'h9f</span>;</div><div class="line">    <span class="number">8'h6f</span>: out=<span class="number">8'ha8</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h70</span>: out=<span class="number">8'h51</span>;</div><div class="line">    <span class="number">8'h71</span>: out=<span class="number">8'ha3</span>;</div><div class="line">    <span class="number">8'h72</span>: out=<span class="number">8'h40</span>;</div><div class="line">    <span class="number">8'h73</span>: out=<span class="number">8'h8f</span>;</div><div class="line">    <span class="number">8'h74</span>: out=<span class="number">8'h92</span>;</div><div class="line">    <span class="number">8'h75</span>: out=<span class="number">8'h9d</span>;</div><div class="line">    <span class="number">8'h76</span>: out=<span class="number">8'h38</span>;</div><div class="line">    <span class="number">8'h77</span>: out=<span class="number">8'hf5</span>;</div><div class="line">    <span class="number">8'h78</span>: out=<span class="number">8'hbc</span>;</div><div class="line">    <span class="number">8'h79</span>: out=<span class="number">8'hb6</span>;</div><div class="line">    <span class="number">8'h7a</span>: out=<span class="number">8'hda</span>;</div><div class="line">    <span class="number">8'h7b</span>: out=<span class="number">8'h21</span>;</div><div class="line">    <span class="number">8'h7c</span>: out=<span class="number">8'h10</span>;</div><div class="line">    <span class="number">8'h7d</span>: out=<span class="number">8'hff</span>;</div><div class="line">    <span class="number">8'h7e</span>: out=<span class="number">8'hf3</span>;</div><div class="line">    <span class="number">8'h7f</span>: out=<span class="number">8'hd2</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h80</span>: out=<span class="number">8'hcd</span>;</div><div class="line">    <span class="number">8'h81</span>: out=<span class="number">8'h0c</span>;</div><div class="line">    <span class="number">8'h82</span>: out=<span class="number">8'h13</span>;</div><div class="line">    <span class="number">8'h83</span>: out=<span class="number">8'hec</span>;</div><div class="line">    <span class="number">8'h84</span>: out=<span class="number">8'h5f</span>;</div><div class="line">    <span class="number">8'h85</span>: out=<span class="number">8'h97</span>;</div><div class="line">    <span class="number">8'h86</span>: out=<span class="number">8'h44</span>;</div><div class="line">    <span class="number">8'h87</span>: out=<span class="number">8'h17</span>;</div><div class="line">    <span class="number">8'h88</span>: out=<span class="number">8'hc4</span>;</div><div class="line">    <span class="number">8'h89</span>: out=<span class="number">8'ha7</span>;</div><div class="line">    <span class="number">8'h8a</span>: out=<span class="number">8'h7e</span>;</div><div class="line">    <span class="number">8'h8b</span>: out=<span class="number">8'h3d</span>;</div><div class="line">    <span class="number">8'h8c</span>: out=<span class="number">8'h64</span>;</div><div class="line">    <span class="number">8'h8d</span>: out=<span class="number">8'h5d</span>;</div><div class="line">    <span class="number">8'h8e</span>: out=<span class="number">8'h19</span>;</div><div class="line">    <span class="number">8'h8f</span>: out=<span class="number">8'h73</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h90</span>: out=<span class="number">8'h60</span>;</div><div class="line">    <span class="number">8'h91</span>: out=<span class="number">8'h81</span>;</div><div class="line">    <span class="number">8'h92</span>: out=<span class="number">8'h4f</span>;</div><div class="line">    <span class="number">8'h93</span>: out=<span class="number">8'hdc</span>;</div><div class="line">    <span class="number">8'h94</span>: out=<span class="number">8'h22</span>;</div><div class="line">    <span class="number">8'h95</span>: out=<span class="number">8'h2a</span>;</div><div class="line">    <span class="number">8'h96</span>: out=<span class="number">8'h90</span>;</div><div class="line">    <span class="number">8'h97</span>: out=<span class="number">8'h88</span>;</div><div class="line">    <span class="number">8'h98</span>: out=<span class="number">8'h46</span>;</div><div class="line">    <span class="number">8'h99</span>: out=<span class="number">8'hee</span>;</div><div class="line">    <span class="number">8'h9a</span>: out=<span class="number">8'hb8</span>;</div><div class="line">      <span class="number">8'h9b</span>: out=<span class="number">8'h14</span>;</div><div class="line">    <span class="number">8'h9c</span>: out=<span class="number">8'hde</span>;</div><div class="line">    <span class="number">8'h9d</span>: out=<span class="number">8'h5e</span>;</div><div class="line">    <span class="number">8'h9e</span>: out=<span class="number">8'h0b</span>;</div><div class="line">    <span class="number">8'h9f</span>: out=<span class="number">8'hdb</span>;</div><div class="line"></div><div class="line">    <span class="number">8'ha0</span>: out=<span class="number">8'he0</span>;</div><div class="line">    <span class="number">8'ha1</span>: out=<span class="number">8'h32</span>;</div><div class="line">    <span class="number">8'ha2</span>: out=<span class="number">8'h3a</span>;</div><div class="line">    <span class="number">8'ha3</span>: out=<span class="number">8'h0a</span>;</div><div class="line">    <span class="number">8'ha4</span>: out=<span class="number">8'h49</span>;</div><div class="line">    <span class="number">8'ha5</span>: out=<span class="number">8'h06</span>;</div><div class="line">    <span class="number">8'ha6</span>: out=<span class="number">8'h24</span>;</div><div class="line">    <span class="number">8'ha7</span>: out=<span class="number">8'h5c</span>;</div><div class="line">    <span class="number">8'ha8</span>: out=<span class="number">8'hc2</span>;</div><div class="line">    <span class="number">8'ha9</span>: out=<span class="number">8'hd3</span>;</div><div class="line">    <span class="number">8'haa</span>: out=<span class="number">8'hac</span>;</div><div class="line">    <span class="number">8'hab</span>: out=<span class="number">8'h62</span>;</div><div class="line">    <span class="number">8'hac</span>: out=<span class="number">8'h91</span>;</div><div class="line">    <span class="number">8'had</span>: out=<span class="number">8'h95</span>;</div><div class="line">    <span class="number">8'hae</span>: out=<span class="number">8'he4</span>;</div><div class="line">    <span class="number">8'haf</span>: out=<span class="number">8'h79</span>;</div><div class="line"></div><div class="line">    <span class="number">8'hb0</span>: out=<span class="number">8'he7</span>;</div><div class="line">    <span class="number">8'hb1</span>: out=<span class="number">8'hc8</span>;</div><div class="line">    <span class="number">8'hb2</span>: out=<span class="number">8'h37</span>;</div><div class="line">    <span class="number">8'hb3</span>: out=<span class="number">8'h6d</span>;</div><div class="line">    <span class="number">8'hb4</span>: out=<span class="number">8'h8d</span>;</div><div class="line">    <span class="number">8'hb5</span>: out=<span class="number">8'hd5</span>;</div><div class="line">    <span class="number">8'hb6</span>: out=<span class="number">8'h4e</span>;</div><div class="line">    <span class="number">8'hb7</span>: out=<span class="number">8'ha9</span>;</div><div class="line">    <span class="number">8'hb8</span>: out=<span class="number">8'h6c</span>;</div><div class="line">    <span class="number">8'hb9</span>: out=<span class="number">8'h56</span>;</div><div class="line">    <span class="number">8'hba</span>: out=<span class="number">8'hf4</span>;</div><div class="line">    <span class="number">8'hbb</span>: out=<span class="number">8'hea</span>;</div><div class="line">    <span class="number">8'hbc</span>: out=<span class="number">8'h65</span>;</div><div class="line">    <span class="number">8'hbd</span>: out=<span class="number">8'h7a</span>;</div><div class="line">    <span class="number">8'hbe</span>: out=<span class="number">8'hae</span>;</div><div class="line">    <span class="number">8'hbf</span>: out=<span class="number">8'h08</span>;</div><div class="line"></div><div class="line">          <span class="number">8'hc0</span>: out=<span class="number">8'hba</span>;</div><div class="line">          <span class="number">8'hc1</span>: out=<span class="number">8'h78</span>;</div><div class="line">          <span class="number">8'hc2</span>: out=<span class="number">8'h25</span>;</div><div class="line">          <span class="number">8'hc3</span>: out=<span class="number">8'h2e</span>;</div><div class="line">          <span class="number">8'hc4</span>: out=<span class="number">8'h1c</span>;</div><div class="line">          <span class="number">8'hc5</span>: out=<span class="number">8'ha6</span>;</div><div class="line">          <span class="number">8'hc6</span>: out=<span class="number">8'hb4</span>;</div><div class="line">          <span class="number">8'hc7</span>: out=<span class="number">8'hc6</span>;</div><div class="line">          <span class="number">8'hc8</span>: out=<span class="number">8'he8</span>;</div><div class="line">          <span class="number">8'hc9</span>: out=<span class="number">8'hdd</span>;</div><div class="line">          <span class="number">8'hca</span>: out=<span class="number">8'h74</span>;</div><div class="line">          <span class="number">8'hcb</span>: out=<span class="number">8'h1f</span>;</div><div class="line">          <span class="number">8'hcc</span>: out=<span class="number">8'h4b</span>;</div><div class="line">          <span class="number">8'hcd</span>: out=<span class="number">8'hbd</span>;</div><div class="line">          <span class="number">8'hce</span>: out=<span class="number">8'h8b</span>;</div><div class="line">          <span class="number">8'hcf</span>: out=<span class="number">8'h8a</span>;</div><div class="line"></div><div class="line">          <span class="number">8'hd0</span>: out=<span class="number">8'h70</span>;</div><div class="line">          <span class="number">8'hd1</span>: out=<span class="number">8'h3e</span>;</div><div class="line">          <span class="number">8'hd2</span>: out=<span class="number">8'hb5</span>;</div><div class="line">          <span class="number">8'hd3</span>: out=<span class="number">8'h66</span>;</div><div class="line">          <span class="number">8'hd4</span>: out=<span class="number">8'h48</span>;</div><div class="line">          <span class="number">8'hd5</span>: out=<span class="number">8'h03</span>;</div><div class="line">          <span class="number">8'hd6</span>: out=<span class="number">8'hf6</span>;</div><div class="line">          <span class="number">8'hd7</span>: out=<span class="number">8'h0e</span>;</div><div class="line">          <span class="number">8'hd8</span>: out=<span class="number">8'h61</span>;</div><div class="line">          <span class="number">8'hd9</span>: out=<span class="number">8'h35</span>;</div><div class="line">          <span class="number">8'hda</span>: out=<span class="number">8'h57</span>;</div><div class="line">          <span class="number">8'hdb</span>: out=<span class="number">8'hb9</span>;</div><div class="line">          <span class="number">8'hdc</span>: out=<span class="number">8'h86</span>;</div><div class="line">          <span class="number">8'hdd</span>: out=<span class="number">8'hc1</span>;</div><div class="line">          <span class="number">8'hde</span>: out=<span class="number">8'h1d</span>;</div><div class="line">          <span class="number">8'hdf</span>: out=<span class="number">8'h9e</span>;</div><div class="line"></div><div class="line">          <span class="number">8'he0</span>: out=<span class="number">8'he1</span>;</div><div class="line">          <span class="number">8'he1</span>: out=<span class="number">8'hf8</span>;</div><div class="line">          <span class="number">8'he2</span>: out=<span class="number">8'h98</span>;</div><div class="line">          <span class="number">8'he3</span>: out=<span class="number">8'h11</span>;</div><div class="line">          <span class="number">8'he4</span>: out=<span class="number">8'h69</span>;</div><div class="line">          <span class="number">8'he5</span>: out=<span class="number">8'hd9</span>;</div><div class="line">          <span class="number">8'he6</span>: out=<span class="number">8'h8e</span>;</div><div class="line">          <span class="number">8'he7</span>: out=<span class="number">8'h94</span>;</div><div class="line">          <span class="number">8'he8</span>: out=<span class="number">8'h9b</span>;</div><div class="line">          <span class="number">8'he9</span>: out=<span class="number">8'h1e</span>;</div><div class="line">          <span class="number">8'hea</span>: out=<span class="number">8'h87</span>;</div><div class="line">          <span class="number">8'heb</span>: out=<span class="number">8'he9</span>;</div><div class="line">          <span class="number">8'hec</span>: out=<span class="number">8'hce</span>;</div><div class="line">          <span class="number">8'hed</span>: out=<span class="number">8'h55</span>;</div><div class="line">          <span class="number">8'hee</span>: out=<span class="number">8'h28</span>;</div><div class="line">          <span class="number">8'hef</span>: out=<span class="number">8'hdf</span>;</div><div class="line"></div><div class="line">          <span class="number">8'hf0</span>: out=<span class="number">8'h8c</span>;</div><div class="line">          <span class="number">8'hf1</span>: out=<span class="number">8'ha1</span>;</div><div class="line">          <span class="number">8'hf2</span>: out=<span class="number">8'h89</span>;</div><div class="line">          <span class="number">8'hf3</span>: out=<span class="number">8'h0d</span>;</div><div class="line">          <span class="number">8'hf4</span>: out=<span class="number">8'hbf</span>;</div><div class="line">          <span class="number">8'hf5</span>: out=<span class="number">8'he6</span>;</div><div class="line">          <span class="number">8'hf6</span>: out=<span class="number">8'h42</span>;</div><div class="line">          <span class="number">8'hf7</span>: out=<span class="number">8'h68</span>;</div><div class="line">          <span class="number">8'hf8</span>: out=<span class="number">8'h41</span>;</div><div class="line">          <span class="number">8'hf9</span>: out=<span class="number">8'h99</span>;</div><div class="line">          <span class="number">8'hfa</span>: out=<span class="number">8'h2d</span>;</div><div class="line">          <span class="number">8'hfb</span>: out=<span class="number">8'h0f</span>;</div><div class="line">          <span class="number">8'hfc</span>: out=<span class="number">8'hb0</span>;</div><div class="line">          <span class="number">8'hfd</span>: out=<span class="number">8'h54</span>;</div><div class="line">          <span class="number">8'hfe</span>: out=<span class="number">8'hbb</span>;</div><div class="line">          <span class="number">8'hff</span>: out=<span class="number">8'h16</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> rcon(clk,rst,write,rconout);</div><div class="line"></div><div class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line">    <span class="keyword">input</span>  clk,rst,write;</div><div class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"></div><div class="line">    <span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">        <span class="keyword">begin</span></div><div class="line">            <span class="keyword">if</span>(rst)</div><div class="line">      rconout&lt;=<span class="number">8'h01</span>;</div><div class="line">             <span class="keyword">else</span> <span class="keyword">if</span>(write)</div><div class="line">      rconout&lt;=(rconout[<span class="number">7</span>]==<span class="number">0</span>)? (rconout&lt;&lt;<span class="number">1</span>):((rconout&lt;&lt;<span class="number">1</span>)^&#123;<span class="number">8'h1b</span>&#125;);</div><div class="line">             <span class="keyword">else</span></div><div class="line">      rconout&lt;=rconout;</div><div class="line">        <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> crydap(clk,wrsben,wrsbaddr,sbdata,keyadsel,mixsel,reginsel,wrregen,intxt,roundkey,outtxt);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] outtxt;</div><div class="line"><span class="keyword">input</span> clk,wrsben,wrregen,mixsel,reginsel;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] wrsbaddr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] sbdata,intxt,roundkey;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] sb0out,sb1out,sb2out,sb3out,sb4out,sb5out,sb6out,sb7out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] sb8out,sb9out,sb10out,sb11out,sb12out,sb13out,sb14out,sb15out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a0,b0,c0,a1,b1,c1,a2,b2,c2,a3,b3,c3,a4,b4,c4,a5,b5,c5;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a6,b6,c6,a7,b7,c7,a8,b8,c8,a9,b9,c9,a10,b10,c10,a11,b11,c11;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a12,b12,c12,a13,b13,c13,a14,b14,c14,a15,b15,c15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13,f14,f15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] i0,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,i14,i15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] j0,j1,j2,j3,j4,j5,j6,j7,j8,j9,j10,j11,j12,j13,j14,j15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f002,f003,f009,f00b,f00d,f00e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f102,f103,f109,f10b,f10d,f10e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f202,f203,f209,f20b,f20d,f20e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f302,f303,f309,f30b,f30d,f30e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f402,f403,f409,f40b,f40d,f40e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f502,f503,f509,f50b,f50d,f50e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f602,f603,f609,f60b,f60d,f60e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f702,f703,f709,f70b,f70d,f70e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f802,f803,f809,f80b,f80d,f80e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f902,f903,f909,f90b,f90d,f90e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1002,f1003,f1009,f100b,f100d,f100e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1102,f1103,f1109,f110b,f110d,f110e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1202,f1203,f1209,f120b,f120d,f120e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1302,f1303,f1309,f130b,f130d,f130e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1402,f1403,f1409,f140b,f140d,f140e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1502,f1503,f1509,f150b,f150d,f150e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] d,e,g,h;</div><div class="line">sbox  sbox0(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">127</span>:<span class="number">120</span>],sb0out);</div><div class="line">sbox  sbox1(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">119</span>:<span class="number">112</span>],sb1out);</div><div class="line">sbox  sbox2(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">111</span>:<span class="number">104</span>],sb2out);</div><div class="line">sbox  sbox3(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">103</span>:<span class="number">96</span>],sb3out);</div><div class="line">sbox  sbox4(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">95</span>:<span class="number">88</span>],sb4out);</div><div class="line">sbox  sbox5(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">87</span>:<span class="number">80</span>],sb5out);</div><div class="line">sbox  sbox6(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">79</span>:<span class="number">72</span>],sb6out);</div><div class="line">sbox  sbox7(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">71</span>:<span class="number">64</span>],sb7out);</div><div class="line">sbox  sbox8(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">63</span>:<span class="number">56</span>],sb8out);</div><div class="line">sbox  sbox9(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">55</span>:<span class="number">48</span>],sb9out);</div><div class="line">sbox  sbox10(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">47</span>:<span class="number">40</span>],sb10out);</div><div class="line">sbox  sbox11(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">39</span>:<span class="number">32</span>],sb11out);</div><div class="line">sbox  sbox12(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">31</span>:<span class="number">24</span>],sb12out);</div><div class="line">sbox  sbox13(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">23</span>:<span class="number">16</span>],sb13out);</div><div class="line">sbox  sbox14(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">15</span>:<span class="number">8</span>],sb14out);</div><div class="line">sbox  sbox15(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">7</span>:<span class="number">0</span>],sb15out);</div><div class="line">mux21_8  mux21_8_0(mixsel,sb0out,e0,f0);</div><div class="line">mux21_8  mux21_8_1(mixsel,sb1out,e1,f1);</div><div class="line">mux21_8  mux21_8_2(mixsel,sb2out,e2,f2);</div><div class="line">mux21_8  mux21_8_3(mixsel,sb3out,e3,f3);</div><div class="line">mux21_8  mux21_8_4(mixsel,sb4out,e4,f4);</div><div class="line">mux21_8  mux21_8_5(mixsel,sb5out,e5,f5);</div><div class="line">mux21_8  mux21_8_6(mixsel,sb6out,e6,f6);</div><div class="line">mux21_8  mux21_8_7(mixsel,sb7out,e7,f7);</div><div class="line">mux21_8  mux21_8_8(mixsel,sb8out,e8,f8);</div><div class="line">mux21_8  mux21_8_9(mixsel,sb9out,e9,f9);</div><div class="line">mux21_8  mux21_8_10(mixsel,sb10out,e10,f10);</div><div class="line">mux21_8  mux21_8_11(mixsel,sb11out,e11,f11);</div><div class="line">mux21_8  mux21_8_12(mixsel,sb12out,e12,f12);</div><div class="line">mux21_8  mux21_8_13(mixsel,sb13out,e13,f13);</div><div class="line">mux21_8  mux21_8_14(mixsel,sb14out,e14,f14);</div><div class="line">mux21_8  mux21_8_15(mixsel,sb15out,e15,f15);</div><div class="line">byte0203 byte0203_0(f0,f002,f003);</div><div class="line">byte0203 byte0203_1(f1,f102,f103);</div><div class="line">byte0203 byte0203_2(f2,f202,f203);</div><div class="line">byte0203 byte0203_3(f3,f302,f303);</div><div class="line">byte0203 byte0203_4(f4,f402,f403);</div><div class="line">byte0203 byte0203_5(f5,f502,f503);</div><div class="line">byte0203 byte0203_6(f6,f602,f603);</div><div class="line">byte0203 byte0203_7(f7,f702,f703);</div><div class="line">byte0203 byte0203_8(f8,f802,f803);</div><div class="line">byte0203 byte0203_9(f9,f902,f903);</div><div class="line">byte0203 byte0203_10(f10,f1002,f1003);</div><div class="line">byte0203 byte0203_11(f11,f1102,f1103);</div><div class="line">byte0203 byte0203_12(f12,f1202,f1203);</div><div class="line">byte0203 byte0203_13(f13,f1302,f1303);</div><div class="line">byte0203 byte0203_14(f14,f1402,f1403);</div><div class="line">byte0203 byte0203_15(f15,f1502,f1503);</div><div class="line">byte9bde byte9bde_0(f0,f002,f003,f009,f00b,f00d,f00e);</div><div class="line">byte9bde byte9bde_1(f1,f102,f103,f109,f10b,f10d,f10e);</div><div class="line">byte9bde byte9bde_2(f2,f202,f203,f209,f20b,f20d,f20e);</div><div class="line">byte9bde byte9bde_3(f3,f302,f303,f309,f30b,f30d,f30e);</div><div class="line">byte9bde byte9bde_4(f4,f402,f403,f409,f40b,f40d,f40e);</div><div class="line">byte9bde byte9bde_5(f5,f502,f503,f509,f50b,f50d,f50e);</div><div class="line">byte9bde byte9bde_6(f6,f602,f603,f609,f60b,f60d,f60e);</div><div class="line">byte9bde byte9bde_7(f7,f702,f703,f709,f70b,f70d,f70e);</div><div class="line">byte9bde byte9bde_8(f8,f802,f803,f809,f80b,f80d,f80e);</div><div class="line">byte9bde byte9bde_9(f9,f902,f903,f909,f90b,f90d,f90e);</div><div class="line">byte9bde byte9bde_10(f10,f1002,f1003,f1009,f100b,f100d,f100e);</div><div class="line">byte9bde byte9bde_11(f11,f1102,f1103,f1109,f110b,f110d,f110e);</div><div class="line">byte9bde byte9bde_12(f12,f1202,f1203,f1209,f120b,f120d,f120e);</div><div class="line">byte9bde byte9bde_13(f13,f1302,f1303,f1309,f130b,f130d,f130e);</div><div class="line">byte9bde byte9bde_14(f14,f1402,f1403,f1409,f140b,f140d,f140e);</div><div class="line">byte9bde byte9bde_15(f15,f1502,f1503,f1509,f150b,f150d,f150e);</div><div class="line"><span class="keyword">assign</span> a0=f002^f503;</div><div class="line"><span class="keyword">assign</span> b0=sb10out^sb15out;</div><div class="line"><span class="keyword">assign</span> c0=a0^b0;</div><div class="line">mux41_8  mux41_8_0(keyadsel,intxt[<span class="number">127</span>:<span class="number">120</span>],c0,sb0out,sb0out,d0);</div><div class="line"><span class="keyword">assign</span> a1=sb0out^f502;</div><div class="line"><span class="keyword">assign</span> b1=f1003^sb15out;</div><div class="line"><span class="keyword">assign</span> c1=a1^b1;</div><div class="line">mux41_8  mux41_8_1(keyadsel,intxt[<span class="number">119</span>:<span class="number">112</span>],c1,sb5out,sb13out,d1);</div><div class="line"><span class="keyword">assign</span> a2=sb0out^sb5out;</div><div class="line"><span class="keyword">assign</span> b2=f1002^f1503;</div><div class="line"><span class="keyword">assign</span> c2=a2^b2;</div><div class="line">mux41_8  mux41_8_2(keyadsel,intxt[<span class="number">111</span>:<span class="number">104</span>],c2,sb10out,sb10out,d2);</div><div class="line"><span class="keyword">assign</span> a3=f003^sb5out;</div><div class="line"><span class="keyword">assign</span> b3=sb10out^f1502;</div><div class="line"><span class="keyword">assign</span> c3=a3^b3;</div><div class="line">mux41_8  mux41_8_3(keyadsel,intxt[<span class="number">103</span>:<span class="number">96</span>],c3,sb15out,sb7out,d3);</div><div class="line"><span class="keyword">assign</span> a4=f402^f903;</div><div class="line"><span class="keyword">assign</span> b4=sb14out^sb3out;</div><div class="line"><span class="keyword">assign</span> c4=a4^b4;</div><div class="line">mux41_8  mux41_8_4(keyadsel,intxt[<span class="number">95</span>:<span class="number">88</span>],c4,sb4out,sb4out,d4);</div><div class="line"><span class="keyword">assign</span> a5=sb4out^f902;</div><div class="line"><span class="keyword">assign</span> b5=f1403^sb3out;</div><div class="line"><span class="keyword">assign</span> c5=a5^b5;</div><div class="line">mux41_8  mux41_8_5(keyadsel,intxt[<span class="number">87</span>:<span class="number">80</span>],c5,sb9out,sb1out,d5);</div><div class="line"><span class="keyword">assign</span> a6=sb4out^sb9out;</div><div class="line"><span class="keyword">assign</span> b6=f1402^f303;</div><div class="line"><span class="keyword">assign</span> c6=a6^b6;</div><div class="line">mux41_8  mux41_8_6(keyadsel,intxt[<span class="number">79</span>:<span class="number">72</span>],c6,sb14out,sb14out,d6);</div><div class="line"><span class="keyword">assign</span> a7=f403^sb9out;</div><div class="line"><span class="keyword">assign</span> b7=sb14out^f302;</div><div class="line"><span class="keyword">assign</span> c7=a7^b7;</div><div class="line">mux41_8  mux41_8_7(keyadsel,intxt[<span class="number">71</span>:<span class="number">64</span>],c7,sb3out,sb11out,d7);</div><div class="line"><span class="keyword">assign</span> a8=f802^f1303;</div><div class="line"><span class="keyword">assign</span> b8=sb2out^sb7out;</div><div class="line"><span class="keyword">assign</span> c8=a8^b8;</div><div class="line">mux41_8  mux41_8_8(keyadsel,intxt[<span class="number">63</span>:<span class="number">56</span>],c8,sb8out,sb8out,d8);</div><div class="line"><span class="keyword">assign</span> a9=sb8out^f1302;</div><div class="line"><span class="keyword">assign</span> b9=f203^sb7out;</div><div class="line"><span class="keyword">assign</span> c9=a9^b9;</div><div class="line">mux41_8  mux41_8_9(keyadsel,intxt[<span class="number">55</span>:<span class="number">48</span>],c9,sb13out,sb5out,d9);</div><div class="line"><span class="keyword">assign</span> a10=sb8out^sb13out;</div><div class="line"><span class="keyword">assign</span> b10=f202^f703;</div><div class="line"><span class="keyword">assign</span> c10=a10^b10;</div><div class="line">mux41_8  mux41_8_10(keyadsel,intxt[<span class="number">47</span>:<span class="number">40</span>],c10,sb2out,sb2out,d10);</div><div class="line"><span class="keyword">assign</span> a11=f803^sb13out;</div><div class="line"><span class="keyword">assign</span> b11=sb2out^f702;</div><div class="line"><span class="keyword">assign</span> c11=a11^b11;</div><div class="line">mux41_8  mux41_8_11(keyadsel,intxt[<span class="number">39</span>:<span class="number">32</span>],c11,sb7out,sb15out,d11);</div><div class="line"><span class="keyword">assign</span> a12=f1202^f103;</div><div class="line"><span class="keyword">assign</span> b12=sb6out^sb11out;</div><div class="line"><span class="keyword">assign</span> c12=a12^b12;</div><div class="line">mux41_8  mux41_8_12(keyadsel,intxt[<span class="number">31</span>:<span class="number">24</span>],c12,sb12out,sb12out,d12);</div><div class="line"><span class="keyword">assign</span> a13=sb12out^f102;</div><div class="line"><span class="keyword">assign</span> b13=f603^sb11out;</div><div class="line"><span class="keyword">assign</span> c13=a13^b13;</div><div class="line">mux41_8  mux41_8_13(keyadsel,intxt[<span class="number">23</span>:<span class="number">16</span>],c13,sb1out,sb9out,d13);</div><div class="line"><span class="keyword">assign</span> a14=sb12out^sb1out;</div><div class="line"><span class="keyword">assign</span> b14=f602^f1103;</div><div class="line"><span class="keyword">assign</span> c14=a14^b14;</div><div class="line">mux41_8  mux41_8_14(keyadsel,intxt[<span class="number">15</span>:<span class="number">8</span>],c14,sb6out,sb6out,d14);</div><div class="line"><span class="keyword">assign</span> a15=f1203^sb1out;</div><div class="line"><span class="keyword">assign</span> b15=sb6out^f1102;</div><div class="line"><span class="keyword">assign</span> c15=a15^b15;</div><div class="line">mux41_8  mux41_8_15(keyadsel,intxt[<span class="number">7</span>:<span class="number">0</span>],c15,sb11out,sb3out,d15);</div><div class="line"><span class="keyword">assign</span> d=&#123;d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15&#125;;</div><div class="line"><span class="keyword">assign</span> e=&#123;e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15&#125;;</div><div class="line"><span class="keyword">assign</span> g=&#123;g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15&#125;;</div><div class="line"><span class="keyword">assign</span> &#123;e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15&#125;=d^roundkey;</div><div class="line"><span class="keyword">assign</span> i0=f00e^f10b;</div><div class="line"><span class="keyword">assign</span> j0=f20d^f309;</div><div class="line"><span class="keyword">assign</span> g0=i0^j0;</div><div class="line"><span class="keyword">assign</span> i1=f009^f10e;</div><div class="line"><span class="keyword">assign</span> j1=f20b^f30d;</div><div class="line"><span class="keyword">assign</span> g1=i1^j1;</div><div class="line"><span class="keyword">assign</span> i2=f00d^f109;</div><div class="line"><span class="keyword">assign</span> j2=f20e^f30b;</div><div class="line"><span class="keyword">assign</span> g2=i2^j2;</div><div class="line"><span class="keyword">assign</span> i3=f00b^f10d;</div><div class="line"><span class="keyword">assign</span> j3=f209^f30e;</div><div class="line"><span class="keyword">assign</span> g3=i3^j3;</div><div class="line"><span class="keyword">assign</span> i4=f40e^f50b;</div><div class="line"><span class="keyword">assign</span> j4=f60d^f709;</div><div class="line"><span class="keyword">assign</span> g4=i4^j4;</div><div class="line"><span class="keyword">assign</span> i5=f409^f50e;</div><div class="line"><span class="keyword">assign</span> j5=f60b^f70d;</div><div class="line"><span class="keyword">assign</span> g5=i5^j5;</div><div class="line"><span class="keyword">assign</span> i6=f40d^f509;</div><div class="line"><span class="keyword">assign</span> j6=f60e^f70b;</div><div class="line"><span class="keyword">assign</span> g6=i6^j6;</div><div class="line"><span class="keyword">assign</span> i7=f40b^f50d;</div><div class="line"><span class="keyword">assign</span> j7=f609^f70e;</div><div class="line"><span class="keyword">assign</span> g7=i7^j7;</div><div class="line"></div><div class="line"><span class="keyword">assign</span> i8=f80e^f90b;</div><div class="line"><span class="keyword">assign</span> j8=f100d^f1109;</div><div class="line"><span class="keyword">assign</span> g8=i8^j8;</div><div class="line"><span class="keyword">assign</span> i9=f809^f90e;</div><div class="line"><span class="keyword">assign</span> j9=f100b^f110d;</div><div class="line"><span class="keyword">assign</span> g9=i9^j9;</div><div class="line"><span class="keyword">assign</span> i10=f80d^f909;</div><div class="line"><span class="keyword">assign</span> j10=f100e^f110b;</div><div class="line"><span class="keyword">assign</span> g10=i10^j10;</div><div class="line"><span class="keyword">assign</span> i11=f80b^f90d;</div><div class="line"><span class="keyword">assign</span> j11=f1009^f110e;</div><div class="line"><span class="keyword">assign</span> g11=i11^j11;</div><div class="line"><span class="keyword">assign</span> i12=f120e^f130b;</div><div class="line"><span class="keyword">assign</span> j12=f140d^f1509;</div><div class="line"><span class="keyword">assign</span> g12=i12^j12;</div><div class="line"><span class="keyword">assign</span> i13=f1209^f130e;</div><div class="line"><span class="keyword">assign</span> j13=f140b^f150d;</div><div class="line"><span class="keyword">assign</span> g13=i13^j13;</div><div class="line"><span class="keyword">assign</span> i14=f120d^f1309;</div><div class="line"><span class="keyword">assign</span> j14=f140e^f150b;</div><div class="line"><span class="keyword">assign</span> g14=i14^j14;</div><div class="line"><span class="keyword">assign</span> i15=f120b^f130d;</div><div class="line"><span class="keyword">assign</span> j15=f1409^f150e;</div><div class="line"><span class="keyword">assign</span> g15=i15^j15;</div><div class="line">mux21_128 mux21_128_0(reginsel,e,g,h);</div><div class="line">reg_128 resultreg(clk,wrregen,h,outtxt);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> sbox(clk,write,wr_addr,din,rd_addr,dout);</div><div class="line"><span class="keyword">input</span> clk;</div><div class="line"><span class="keyword">input</span> write;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] wr_addr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] rd_addr;</div><div class="line"><span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] decout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] write_reg;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] reg0out,reg1out,reg2out,reg3out,reg4out,reg5out,reg6out,reg7out,reg8out,reg9out,reg10out,reg11out,reg12out,reg13out,reg14out,reg15out;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (wr_addr)</div><div class="line">  <span class="keyword">case</span>(wr_addr)</div><div class="line">    <span class="number">4'd0</span>: decout=<span class="number">16'b0000_0000_0000_0001</span>;</div><div class="line">    <span class="number">4'd1</span>: decout=<span class="number">16'b0000_0000_0000_0010</span>;</div><div class="line">    <span class="number">4'd2</span>: decout=<span class="number">16'b0000_0000_0000_0100</span>;</div><div class="line">    <span class="number">4'd3</span>: decout=<span class="number">16'b0000_0000_0000_1000</span>;</div><div class="line">    <span class="number">4'd4</span>: decout=<span class="number">16'b0000_0000_0001_0000</span>;</div><div class="line">    <span class="number">4'd5</span>: decout=<span class="number">16'b0000_0000_0010_0000</span>;</div><div class="line">    <span class="number">4'd6</span>: decout=<span class="number">16'b0000_0000_0100_0000</span>;</div><div class="line">    <span class="number">4'd7</span>: decout=<span class="number">16'b0000_0000_1000_0000</span>;</div><div class="line">    <span class="number">4'd8</span>: decout=<span class="number">16'b0000_0001_0000_0000</span>;</div><div class="line">    <span class="number">4'd9</span>: decout=<span class="number">16'b0000_0010_0000_0000</span>;</div><div class="line">    <span class="number">4'd10</span>: decout=<span class="number">16'b0000_0100_0000_0000</span>;</div><div class="line">    <span class="number">4'd11</span>: decout=<span class="number">16'b0000_1000_0000_0000</span>;</div><div class="line">    <span class="number">4'd12</span>: decout=<span class="number">16'b0001_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd13</span>: decout=<span class="number">16'b0010_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd14</span>: decout=<span class="number">16'b0100_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd15</span>: decout=<span class="number">16'b1000_0000_0000_0000</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">assign</span> write_reg=decout &amp; &#123;write,write,write,write,write,write,write,write,write,write,write,write,write,write,write,write&#125;;</div><div class="line"></div><div class="line">reg_128 reg0(clk,write_reg[<span class="number">0</span>],din,reg0out);</div><div class="line">reg_128 reg1(clk,write_reg[<span class="number">1</span>],din,reg1out);</div><div class="line">reg_128 reg2(clk,write_reg[<span class="number">2</span>],din,reg2out);</div><div class="line">reg_128 reg3(clk,write_reg[<span class="number">3</span>],din,reg3out);</div><div class="line">reg_128 reg4(clk,write_reg[<span class="number">4</span>],din,reg4out);</div><div class="line">reg_128 reg5(clk,write_reg[<span class="number">5</span>],din,reg5out);</div><div class="line">reg_128 reg6(clk,write_reg[<span class="number">6</span>],din,reg6out);</div><div class="line">reg_128 reg7(clk,write_reg[<span class="number">7</span>],din,reg7out);</div><div class="line">reg_128 reg8(clk,write_reg[<span class="number">8</span>],din,reg8out);</div><div class="line">reg_128 reg9(clk,write_reg[<span class="number">9</span>],din,reg9out);</div><div class="line">reg_128 reg10(clk,write_reg[<span class="number">10</span>],din,reg10out);</div><div class="line">reg_128 reg11(clk,write_reg[<span class="number">11</span>],din,reg11out);</div><div class="line">reg_128 reg12(clk,write_reg[<span class="number">12</span>],din,reg12out);</div><div class="line">reg_128 reg13(clk,write_reg[<span class="number">13</span>],din,reg13out);</div><div class="line">reg_128 reg14(clk,write_reg[<span class="number">14</span>],din,reg14out);</div><div class="line">reg_128 reg15(clk,write_reg[<span class="number">15</span>],din,reg15out);</div><div class="line"><span class="keyword">always</span> @(rd_addr <span class="keyword">or</span> reg0out <span class="keyword">or</span> reg1out <span class="keyword">or</span> reg2out <span class="keyword">or</span> reg3out <span class="keyword">or</span> reg4out <span class="keyword">or</span> reg5out <span class="keyword">or</span> reg6out <span class="keyword">or</span> reg7out <span class="keyword">or</span> reg8out <span class="keyword">or</span> reg9out <span class="keyword">or</span> reg10out <span class="keyword">or</span> reg11out <span class="keyword">or</span> reg12out <span class="keyword">or</span> reg13out <span class="keyword">or</span> reg14out <span class="keyword">or</span> reg15out)</div><div class="line">  <span class="keyword">case</span>(rd_addr)</div><div class="line">    <span class="number">8'd0</span>: dout=reg0out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd1</span>: dout=reg0out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd2</span>: dout=reg0out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd3</span>: dout=reg0out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd4</span>: dout=reg0out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd5</span>: dout=reg0out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd6</span>: dout=reg0out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd7</span>: dout=reg0out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd8</span>: dout=reg0out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd9</span>: dout=reg0out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd10</span>: dout=reg0out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd11</span>: dout=reg0out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd12</span>: dout=reg0out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd13</span>: dout=reg0out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd14</span>: dout=reg0out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd15</span>: dout=reg0out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd16</span>: dout=reg1out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd17</span>: dout=reg1out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd18</span>: dout=reg1out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd19</span>: dout=reg1out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd20</span>: dout=reg1out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd21</span>: dout=reg1out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd22</span>: dout=reg1out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd23</span>: dout=reg1out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd24</span>: dout=reg1out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd25</span>: dout=reg1out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd26</span>: dout=reg1out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd27</span>: dout=reg1out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd28</span>: dout=reg1out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd29</span>: dout=reg1out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd30</span>: dout=reg1out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd31</span>: dout=reg1out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd32</span>: dout=reg2out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd33</span>: dout=reg2out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd34</span>: dout=reg2out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd35</span>: dout=reg2out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd36</span>: dout=reg2out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd37</span>: dout=reg2out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd38</span>: dout=reg2out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd39</span>: dout=reg2out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd40</span>: dout=reg2out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd41</span>: dout=reg2out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd42</span>: dout=reg2out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd43</span>: dout=reg2out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd44</span>: dout=reg2out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd45</span>: dout=reg2out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd46</span>: dout=reg2out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd47</span>: dout=reg2out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd48</span>: dout=reg3out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd49</span>: dout=reg3out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd50</span>: dout=reg3out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd51</span>: dout=reg3out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd52</span>: dout=reg3out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd53</span>: dout=reg3out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd54</span>: dout=reg3out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd55</span>: dout=reg3out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd56</span>: dout=reg3out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd57</span>: dout=reg3out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd58</span>: dout=reg3out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd59</span>: dout=reg3out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd60</span>: dout=reg3out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd61</span>: dout=reg3out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd62</span>: dout=reg3out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd63</span>: dout=reg3out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd64</span>: dout=reg4out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd65</span>: dout=reg4out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd66</span>: dout=reg4out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd67</span>: dout=reg4out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd68</span>: dout=reg4out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd69</span>: dout=reg4out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd70</span>: dout=reg4out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd71</span>: dout=reg4out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd72</span>: dout=reg4out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd73</span>: dout=reg4out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd74</span>: dout=reg4out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd75</span>: dout=reg4out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd76</span>: dout=reg4out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd77</span>: dout=reg4out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd78</span>: dout=reg4out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd79</span>: dout=reg4out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd80</span>: dout=reg5out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd81</span>: dout=reg5out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd82</span>: dout=reg5out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd83</span>: dout=reg5out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd84</span>: dout=reg5out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd85</span>: dout=reg5out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd86</span>: dout=reg5out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd87</span>: dout=reg5out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd88</span>: dout=reg5out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd89</span>: dout=reg5out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd90</span>: dout=reg5out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd91</span>: dout=reg5out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd92</span>: dout=reg5out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd93</span>: dout=reg5out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd94</span>: dout=reg5out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd95</span>: dout=reg5out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd96</span>: dout=reg6out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd97</span>: dout=reg6out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd98</span>: dout=reg6out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd99</span>: dout=reg6out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd100</span>: dout=reg6out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd101</span>: dout=reg6out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd102</span>: dout=reg6out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd103</span>: dout=reg6out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd104</span>: dout=reg6out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd105</span>: dout=reg6out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd106</span>: dout=reg6out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd107</span>: dout=reg6out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd108</span>: dout=reg6out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd109</span>: dout=reg6out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd110</span>: dout=reg6out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd111</span>: dout=reg6out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd112</span>: dout=reg7out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd113</span>: dout=reg7out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd114</span>: dout=reg7out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd115</span>: dout=reg7out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd116</span>: dout=reg7out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd117</span>: dout=reg7out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd118</span>: dout=reg7out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd119</span>: dout=reg7out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd120</span>: dout=reg7out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd121</span>: dout=reg7out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd122</span>: dout=reg7out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd123</span>: dout=reg7out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd124</span>: dout=reg7out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd125</span>: dout=reg7out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd126</span>: dout=reg7out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd127</span>: dout=reg7out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd128</span>: dout=reg8out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd129</span>: dout=reg8out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd130</span>: dout=reg8out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd131</span>: dout=reg8out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd132</span>: dout=reg8out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd133</span>: dout=reg8out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd134</span>: dout=reg8out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd135</span>: dout=reg8out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd136</span>: dout=reg8out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd137</span>: dout=reg8out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd138</span>: dout=reg8out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd139</span>: dout=reg8out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd140</span>: dout=reg8out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd141</span>: dout=reg8out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd142</span>: dout=reg8out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd143</span>: dout=reg8out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd144</span>: dout=reg9out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd145</span>: dout=reg9out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd146</span>: dout=reg9out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd147</span>: dout=reg9out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd148</span>: dout=reg9out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd149</span>: dout=reg9out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd150</span>: dout=reg9out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd151</span>: dout=reg9out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd152</span>: dout=reg9out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd153</span>: dout=reg9out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd154</span>: dout=reg9out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd155</span>: dout=reg9out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd156</span>: dout=reg9out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd157</span>: dout=reg9out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd158</span>: dout=reg9out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd159</span>: dout=reg9out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd160</span>: dout=reg10out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd161</span>: dout=reg10out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd162</span>: dout=reg10out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd163</span>: dout=reg10out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd164</span>: dout=reg10out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd165</span>: dout=reg10out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd166</span>: dout=reg10out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd167</span>: dout=reg10out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd168</span>: dout=reg10out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd169</span>: dout=reg10out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd170</span>: dout=reg10out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd171</span>: dout=reg10out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd172</span>: dout=reg10out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd173</span>: dout=reg10out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd174</span>: dout=reg10out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd175</span>: dout=reg10out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd176</span>: dout=reg11out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd177</span>: dout=reg11out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd178</span>: dout=reg11out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd179</span>: dout=reg11out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd180</span>: dout=reg11out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd181</span>: dout=reg11out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd182</span>: dout=reg11out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd183</span>: dout=reg11out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd184</span>: dout=reg11out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd185</span>: dout=reg11out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd186</span>: dout=reg11out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd187</span>: dout=reg11out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd188</span>: dout=reg11out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd189</span>: dout=reg11out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd190</span>: dout=reg11out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd191</span>: dout=reg11out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd192</span>: dout=reg12out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd193</span>: dout=reg12out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd194</span>: dout=reg12out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd195</span>: dout=reg12out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd196</span>: dout=reg12out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd197</span>: dout=reg12out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd198</span>: dout=reg12out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd199</span>: dout=reg12out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd200</span>: dout=reg12out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd201</span>: dout=reg12out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd202</span>: dout=reg12out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd203</span>: dout=reg12out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd204</span>: dout=reg12out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd205</span>: dout=reg12out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd206</span>: dout=reg12out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd207</span>: dout=reg12out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd208</span>: dout=reg13out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd209</span>: dout=reg13out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd210</span>: dout=reg13out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd211</span>: dout=reg13out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd212</span>: dout=reg13out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd213</span>: dout=reg13out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd214</span>: dout=reg13out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd215</span>: dout=reg13out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd216</span>: dout=reg13out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd217</span>: dout=reg13out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd218</span>: dout=reg13out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd219</span>: dout=reg13out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd220</span>: dout=reg13out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd221</span>: dout=reg13out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd222</span>: dout=reg13out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd223</span>: dout=reg13out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd224</span>: dout=reg14out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd225</span>: dout=reg14out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd226</span>: dout=reg14out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd227</span>: dout=reg14out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd228</span>: dout=reg14out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd229</span>: dout=reg14out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd230</span>: dout=reg14out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd231</span>: dout=reg14out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd232</span>: dout=reg14out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd233</span>: dout=reg14out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd234</span>: dout=reg14out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd235</span>: dout=reg14out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd236</span>: dout=reg14out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd237</span>: dout=reg14out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd238</span>: dout=reg14out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd239</span>: dout=reg14out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd240</span>: dout=reg15out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd241</span>: dout=reg15out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd242</span>: dout=reg15out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd243</span>: dout=reg15out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd244</span>: dout=reg15out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd245</span>: dout=reg15out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd246</span>: dout=reg15out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd247</span>: dout=reg15out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd248</span>: dout=reg15out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd249</span>: dout=reg15out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd250</span>: dout=reg15out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd251</span>: dout=reg15out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd252</span>: dout=reg15out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd253</span>: dout=reg15out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd254</span>: dout=reg15out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd255</span>: dout=reg15out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_8(sel,a,b,c);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">1'b0</span>: c=a;</div><div class="line">    <span class="number">1'b1</span>: c=b;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte0203(a,a02,a03);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a02,a03;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] b,c;</div><div class="line"><span class="keyword">assign</span> b=&#123;a[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1'b0</span>&#125;;</div><div class="line"><span class="keyword">assign</span> c=b^&#123;<span class="number">8'h1b</span>&#125;;</div><div class="line"><span class="keyword">assign</span> a02=(a[<span class="number">7</span>]==<span class="number">0</span>)? b:c;</div><div class="line"><span class="keyword">assign</span> a03=a02^a;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte9bde(a,a02,a03,a09,a0b,a0d,a0e);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a09,a0b,a0d,a0e;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,a02,a03;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a04,a08,b,c;</div><div class="line">byte02  byte02_0(a02,a04);</div><div class="line">byte02  byte02_1(a04,a08);</div><div class="line"><span class="keyword">assign</span> a09=a08^a;</div><div class="line"><span class="keyword">assign</span> a0b=a08^a03;</div><div class="line"><span class="keyword">assign</span> b=a04^a;</div><div class="line"><span class="keyword">assign</span> c=a04^a02;</div><div class="line"><span class="keyword">assign</span> a0d=a08^b;</div><div class="line"><span class="keyword">assign</span> a0e=a08^c;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte02(a,a02);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a02;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] b,c;</div><div class="line"><span class="keyword">assign</span> b=&#123;a[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1'b0</span>&#125;;</div><div class="line"><span class="keyword">assign</span> c=b^&#123;<span class="number">8'h1b</span>&#125;;</div><div class="line"><span class="keyword">assign</span> a02=(a[<span class="number">7</span>]==<span class="number">0</span>)? b:c;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux41_8(sel,a,b,c,d,e);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] e;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,b,c,d;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] e;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b <span class="keyword">or</span> c <span class="keyword">or</span> d)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">2'b00</span>: e=a;</div><div class="line">    <span class="number">2'b01</span>: e=b;</div><div class="line">    <span class="number">2'b10</span>: e=c;</div><div class="line">    <span class="number">2'b11</span>: e=d;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_128(sel,a,b,c);</div><div class="line"><span class="keyword">output</span>[<span class="number">127</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">input</span>[<span class="number">127</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">1'b0</span>: c=a;</div><div class="line">    <span class="number">1'b1</span>: c=b;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> aes_tb;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">wire</span> keyexprdy,encdecrdy;</div><div class="line"><span class="keyword">reg</span>  clk,rst,load,keyexpen,staenc,stadec;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"></div><div class="line">aes  aes(clk,rst,load,address,keyexpen,staenc,stadec,</div><div class="line">din,keyexprdy,encdecrdy,dout);</div><div class="line"></div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        #<span class="number">20</span>  rst=<span class="number">1</span>;        <span class="comment">//reset.</span></div><div class="line"></div><div class="line">        #<span class="number">200</span> rst=<span class="number">0</span>;        <span class="comment">//load key.</span></div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>;</div><div class="line">             din=<span class="number">128'h2b7e1516_28aed2a6_abf71588_09cf4f3c</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexpen=<span class="number">1</span>;   <span class="comment">//key expansion.</span></div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">1000</span> rst=<span class="number">0</span>;       <span class="comment">//encryption sbox configuration.</span></div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             din=<span class="number">128'h637c777bf26b6fc53001672bfed7ab76</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd1</span>;</div><div class="line">             din=<span class="number">128'hca82c97dfa5947f0add4a2af9ca472c0</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd2</span>;</div><div class="line">             din=<span class="number">128'hb7fd9326363ff7cc34a5e5f171d83115</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd3</span>;</div><div class="line">             din=<span class="number">128'h04c723c31896059a071280e2eb27b275</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd4</span>;</div><div class="line">             din=<span class="number">128'h09832c1a1b6e5aa0523bd6b329e32f84</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd5</span>;</div><div class="line">             din=<span class="number">128'h53d100ed20fcb15b6acbbe394a4c58cf</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd6</span>;</div><div class="line">             din=<span class="number">128'hd0efaafb434d338545f9027f503c9fa8</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd7</span>;</div><div class="line">             din=<span class="number">128'h51a3408f929d38f5bcb6da2110fff3d2</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd8</span>;</div><div class="line">             din=<span class="number">128'hcd0c13ec5f974417c4a77e3d645d1973</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd9</span>;</div><div class="line">             din=<span class="number">128'h60814fdc222a908846eeb814de5e0bdb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd10</span>;</div><div class="line">             din=<span class="number">128'he0323a0a4906245cc2d3ac629195e479</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd11</span>;</div><div class="line">             din=<span class="number">128'he7c8376d8dd54ea96c56f4ea657aae08</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd12</span>;</div><div class="line">             din=<span class="number">128'hba78252e1ca6b4c6e8dd741f4bbd8b8a</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd13</span>;</div><div class="line">             din=<span class="number">128'h703eb5664803f60e613557b986c11d9e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd14</span>;</div><div class="line">             din=<span class="number">128'he1f8981169d98e949b1e87e9ce5528df</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd15</span>;</div><div class="line">             din=<span class="number">128'h8ca1890dbfe6426841992d0fb054bb16</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>; <span class="comment">//load plain text.</span></div><div class="line">            din=<span class="number">128'h3243f6a8_885a308d_313198a2_e0370734</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">1</span>;   <span class="comment">// start encryption.</span></div><div class="line"></div><div class="line">        #<span class="number">100</span> staenc=<span class="number">0</span>;</div><div class="line">        #<span class="number">1200</span> load=<span class="number">1</span>;   <span class="comment">//decryption sbox configuration.</span></div><div class="line">              address=<span class="number">5'd0</span>;</div><div class="line">              din=<span class="number">128'h52096ad53036a538bf40a39e81f3d7fb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd1</span>;</div><div class="line">             din=<span class="number">128'h7ce339829b2fff87348e4344c4dee9cb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd2</span>;</div><div class="line">             din=<span class="number">128'h547b9432a6c2233dee4c950b42fac34e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd3</span>;</div><div class="line">             din=<span class="number">128'h082ea16628d924b2765ba2496d8bd125</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd4</span>;</div><div class="line">             din=<span class="number">128'h72f8f66486689816d4a45ccc5d65b692</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd5</span>;</div><div class="line">             din=<span class="number">128'h6c704850fdedb9da5e154657a78d9d84</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd6</span>;</div><div class="line">             din=<span class="number">128'h90d8ab008cbcd30af7e45805b8b34506</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd7</span>;</div><div class="line">             din=<span class="number">128'hd02c1e8fca3f0f02c1afbd0301138a6b</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd8</span>;</div><div class="line">             din=<span class="number">128'h3a9111414f67dcea97f2cfcef0b4e673</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd9</span>;</div><div class="line">             din=<span class="number">128'h96ac7422e7ad3585e2f937e81c75df6e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd10</span>;</div><div class="line">             din=<span class="number">128'h47f11a711d29c5896fb7620eaa18be1b</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd11</span>;</div><div class="line">             din=<span class="number">128'hfc563e4bc6d279209adbc0fe78cd5af4</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd12</span>;</div><div class="line">             din=<span class="number">128'h1fdda8338807c731b11210592780ec5f</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd13</span>;</div><div class="line">             din=<span class="number">128'h60517fa919b54a0d2de57a9f93c99cef</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd14</span>;</div><div class="line">             din=<span class="number">128'ha0e03b4dae2af5b0c8ebbb3c83539961</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd15</span>;</div><div class="line">             din=<span class="number">128'h172b047eba77d626e169146355210c7d</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>; <span class="comment">//load cipher text.</span></div><div class="line">             din=<span class="number">128'h3925841d_02dc09fb_dc118597_196a0b32</span>;</div><div class="line">        #<span class="number">100</span> load=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">1</span>;   <span class="comment">//start decryption.</span></div><div class="line">        #<span class="number">100</span> stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">      #<span class="number">1500</span> <span class="built_in">$finish</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>3、设计AES密码处理器的测试文件</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> aes_tb;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">wire</span> keyexprdy,encdecrdy;</div><div class="line"><span class="keyword">reg</span>  clk,rst,load,keyexpen,staenc,stadec;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"></div><div class="line">aes  aes(clk,rst,load,address,keyexpen,staenc,stadec,</div><div class="line">din,keyexprdy,encdecrdy,dout);</div><div class="line"></div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        #<span class="number">20</span>  rst=<span class="number">1</span>;        <span class="comment">//reset.</span></div><div class="line"></div><div class="line">        #<span class="number">200</span> rst=<span class="number">0</span>;        <span class="comment">//load key.</span></div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>;</div><div class="line">             din=<span class="number">128'h2b7e1516_28aed2a6_abf71588_09cf4f3c</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexpen=<span class="number">1</span>;   <span class="comment">//key expansion.</span></div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">1000</span> rst=<span class="number">0</span>;       <span class="comment">//encryption sbox configuration.</span></div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             din=<span class="number">128'h637c777bf26b6fc53001672bfed7ab76</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd1</span>;</div><div class="line">             din=<span class="number">128'hca82c97dfa5947f0add4a2af9ca472c0</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd2</span>;</div><div class="line">             din=<span class="number">128'hb7fd9326363ff7cc34a5e5f171d83115</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd3</span>;</div><div class="line">             din=<span class="number">128'h04c723c31896059a071280e2eb27b275</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd4</span>;</div><div class="line">             din=<span class="number">128'h09832c1a1b6e5aa0523bd6b329e32f84</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd5</span>;</div><div class="line">             din=<span class="number">128'h53d100ed20fcb15b6acbbe394a4c58cf</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd6</span>;</div><div class="line">             din=<span class="number">128'hd0efaafb434d338545f9027f503c9fa8</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd7</span>;</div><div class="line">             din=<span class="number">128'h51a3408f929d38f5bcb6da2110fff3d2</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd8</span>;</div><div class="line">             din=<span class="number">128'hcd0c13ec5f974417c4a77e3d645d1973</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd9</span>;</div><div class="line">             din=<span class="number">128'h60814fdc222a908846eeb814de5e0bdb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd10</span>;</div><div class="line">             din=<span class="number">128'he0323a0a4906245cc2d3ac629195e479</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd11</span>;</div><div class="line">             din=<span class="number">128'he7c8376d8dd54ea96c56f4ea657aae08</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd12</span>;</div><div class="line">             din=<span class="number">128'hba78252e1ca6b4c6e8dd741f4bbd8b8a</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd13</span>;</div><div class="line">             din=<span class="number">128'h703eb5664803f60e613557b986c11d9e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd14</span>;</div><div class="line">             din=<span class="number">128'he1f8981169d98e949b1e87e9ce5528df</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd15</span>;</div><div class="line">             din=<span class="number">128'h8ca1890dbfe6426841992d0fb054bb16</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>; <span class="comment">//load plain text.</span></div><div class="line">            din=<span class="number">128'h3243f6a8_885a308d_313198a2_e0370734</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">1</span>;   <span class="comment">// start encryption.</span></div><div class="line"></div><div class="line">        #<span class="number">100</span> staenc=<span class="number">0</span>;</div><div class="line">        #<span class="number">1200</span> load=<span class="number">1</span>;   <span class="comment">//decryption sbox configuration.</span></div><div class="line">              address=<span class="number">5'd0</span>;</div><div class="line">              din=<span class="number">128'h52096ad53036a538bf40a39e81f3d7fb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd1</span>;</div><div class="line">             din=<span class="number">128'h7ce339829b2fff87348e4344c4dee9cb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd2</span>;</div><div class="line">             din=<span class="number">128'h547b9432a6c2233dee4c950b42fac34e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd3</span>;</div><div class="line">             din=<span class="number">128'h082ea16628d924b2765ba2496d8bd125</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd4</span>;</div><div class="line">             din=<span class="number">128'h72f8f66486689816d4a45ccc5d65b692</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd5</span>;</div><div class="line">             din=<span class="number">128'h6c704850fdedb9da5e154657a78d9d84</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd6</span>;</div><div class="line">             din=<span class="number">128'h90d8ab008cbcd30af7e45805b8b34506</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd7</span>;</div><div class="line">             din=<span class="number">128'hd02c1e8fca3f0f02c1afbd0301138a6b</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd8</span>;</div><div class="line">             din=<span class="number">128'h3a9111414f67dcea97f2cfcef0b4e673</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd9</span>;</div><div class="line">             din=<span class="number">128'h96ac7422e7ad3585e2f937e81c75df6e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd10</span>;</div><div class="line">             din=<span class="number">128'h47f11a711d29c5896fb7620eaa18be1b</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd11</span>;</div><div class="line">             din=<span class="number">128'hfc563e4bc6d279209adbc0fe78cd5af4</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd12</span>;</div><div class="line">             din=<span class="number">128'h1fdda8338807c731b11210592780ec5f</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd13</span>;</div><div class="line">             din=<span class="number">128'h60517fa919b54a0d2de57a9f93c99cef</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd14</span>;</div><div class="line">             din=<span class="number">128'ha0e03b4dae2af5b0c8ebbb3c83539961</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd15</span>;</div><div class="line">             din=<span class="number">128'h172b047eba77d626e169146355210c7d</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>; <span class="comment">//load cipher text.</span></div><div class="line">             din=<span class="number">128'h3925841d_02dc09fb_dc118597_196a0b32</span>;</div><div class="line">        #<span class="number">100</span> load=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">1</span>;   <span class="comment">//start decryption.</span></div><div class="line">        #<span class="number">100</span> stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">      #<span class="number">1500</span> <span class="built_in">$finish</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>4、将AES密码处理器的设计文件和测试文件输入Modelsim仿真工具，并进行编译和功能仿真。</strong></p>
<p><strong>5、观察AES密码处理器的仿真波形图，分析结果是否正确。若有错误，则修改设计文件或测试文件，重新编译和仿真。</strong></p>
<h2 id="五、实验结果-3"><a href="#五、实验结果-3" class="headerlink" title="五、实验结果"></a>五、实验结果</h2><p>　　参见Modelsim中的仿真波形图,列出下列实验结果表。<br>　　AES密码处理器系统集成仿真结果：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/663.png" alt=""></p>
<h2 id="六、实验结论-3"><a href="#六、实验结论-3" class="headerlink" title="六、实验结论"></a>六、实验结论</h2><p>　　本实验对AES密码处理器进行了系统集成，并选择了20组不同的密钥和明文对其进行了功能仿真，仿真结果全部正确，这说明所设计的AES密码处理器的功能是正确的。</p>
<h2 id="七、推荐测试数据"><a href="#七、推荐测试数据" class="headerlink" title="七、推荐测试数据"></a>七、推荐测试数据</h2><p>　　表1：AES加密算法测试数据<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/664.png" alt=""><br>　　表2：AES解密算法测试数据<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/665.png" alt=""></p>
<h1 id="AES密码处理器综合优化与仿真分析"><a href="#AES密码处理器综合优化与仿真分析" class="headerlink" title="AES密码处理器综合优化与仿真分析"></a>AES密码处理器综合优化与仿真分析</h1><h2 id="一、实验目的-5"><a href="#一、实验目的-5" class="headerlink" title="一、实验目的"></a>一、实验目的</h2><p>　　掌握超大规模集成电路(VLSI)设计流程中的综合优化、布局布线、静态时序分析、时序仿真等技术的思想、原理和方法，并学会使用相关的EDA工具软件。</p>
<h2 id="二、实验内容-5"><a href="#二、实验内容-5" class="headerlink" title="二、实验内容"></a>二、实验内容</h2><p>　　1、利用QuartusII软件对AES密码处理器的Verilog RTL模型进行基于FPGA的综合优化、布局布线、静态时序分析(全编译)，生成布局布线后的电路网表和时序文件。<br>　　2、对第1步得到的资源占用报告、静态时序分析报告进行分析，确定电路的规模和性能是否满足要求。若不满足则通过修改约束条件、重新编译来对电路进行优化。<br>　　3、利用Modelsim或QuartusII软件对布局布线后的电路网表进行时序仿真（需要用到前面生成的时序文件），确定电路是否满足时序要求。</p>
<h2 id="三、实验环境-5"><a href="#三、实验环境-5" class="headerlink" title="三、实验环境"></a>三、实验环境</h2><p>　　PC机1台、QuartusII软件、Modelsim仿真软件。</p>
<h2 id="四、实验步骤-5"><a href="#四、实验步骤-5" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h2><p><strong>1、建立AES密码处理器的Verilog RTL模型。</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div><div class="line">663</div><div class="line">664</div><div class="line">665</div><div class="line">666</div><div class="line">667</div><div class="line">668</div><div class="line">669</div><div class="line">670</div><div class="line">671</div><div class="line">672</div><div class="line">673</div><div class="line">674</div><div class="line">675</div><div class="line">676</div><div class="line">677</div><div class="line">678</div><div class="line">679</div><div class="line">680</div><div class="line">681</div><div class="line">682</div><div class="line">683</div><div class="line">684</div><div class="line">685</div><div class="line">686</div><div class="line">687</div><div class="line">688</div><div class="line">689</div><div class="line">690</div><div class="line">691</div><div class="line">692</div><div class="line">693</div><div class="line">694</div><div class="line">695</div><div class="line">696</div><div class="line">697</div><div class="line">698</div><div class="line">699</div><div class="line">700</div><div class="line">701</div><div class="line">702</div><div class="line">703</div><div class="line">704</div><div class="line">705</div><div class="line">706</div><div class="line">707</div><div class="line">708</div><div class="line">709</div><div class="line">710</div><div class="line">711</div><div class="line">712</div><div class="line">713</div><div class="line">714</div><div class="line">715</div><div class="line">716</div><div class="line">717</div><div class="line">718</div><div class="line">719</div><div class="line">720</div><div class="line">721</div><div class="line">722</div><div class="line">723</div><div class="line">724</div><div class="line">725</div><div class="line">726</div><div class="line">727</div><div class="line">728</div><div class="line">729</div><div class="line">730</div><div class="line">731</div><div class="line">732</div><div class="line">733</div><div class="line">734</div><div class="line">735</div><div class="line">736</div><div class="line">737</div><div class="line">738</div><div class="line">739</div><div class="line">740</div><div class="line">741</div><div class="line">742</div><div class="line">743</div><div class="line">744</div><div class="line">745</div><div class="line">746</div><div class="line">747</div><div class="line">748</div><div class="line">749</div><div class="line">750</div><div class="line">751</div><div class="line">752</div><div class="line">753</div><div class="line">754</div><div class="line">755</div><div class="line">756</div><div class="line">757</div><div class="line">758</div><div class="line">759</div><div class="line">760</div><div class="line">761</div><div class="line">762</div><div class="line">763</div><div class="line">764</div><div class="line">765</div><div class="line">766</div><div class="line">767</div><div class="line">768</div><div class="line">769</div><div class="line">770</div><div class="line">771</div><div class="line">772</div><div class="line">773</div><div class="line">774</div><div class="line">775</div><div class="line">776</div><div class="line">777</div><div class="line">778</div><div class="line">779</div><div class="line">780</div><div class="line">781</div><div class="line">782</div><div class="line">783</div><div class="line">784</div><div class="line">785</div><div class="line">786</div><div class="line">787</div><div class="line">788</div><div class="line">789</div><div class="line">790</div><div class="line">791</div><div class="line">792</div><div class="line">793</div><div class="line">794</div><div class="line">795</div><div class="line">796</div><div class="line">797</div><div class="line">798</div><div class="line">799</div><div class="line">800</div><div class="line">801</div><div class="line">802</div><div class="line">803</div><div class="line">804</div><div class="line">805</div><div class="line">806</div><div class="line">807</div><div class="line">808</div><div class="line">809</div><div class="line">810</div><div class="line">811</div><div class="line">812</div><div class="line">813</div><div class="line">814</div><div class="line">815</div><div class="line">816</div><div class="line">817</div><div class="line">818</div><div class="line">819</div><div class="line">820</div><div class="line">821</div><div class="line">822</div><div class="line">823</div><div class="line">824</div><div class="line">825</div><div class="line">826</div><div class="line">827</div><div class="line">828</div><div class="line">829</div><div class="line">830</div><div class="line">831</div><div class="line">832</div><div class="line">833</div><div class="line">834</div><div class="line">835</div><div class="line">836</div><div class="line">837</div><div class="line">838</div><div class="line">839</div><div class="line">840</div><div class="line">841</div><div class="line">842</div><div class="line">843</div><div class="line">844</div><div class="line">845</div><div class="line">846</div><div class="line">847</div><div class="line">848</div><div class="line">849</div><div class="line">850</div><div class="line">851</div><div class="line">852</div><div class="line">853</div><div class="line">854</div><div class="line">855</div><div class="line">856</div><div class="line">857</div><div class="line">858</div><div class="line">859</div><div class="line">860</div><div class="line">861</div><div class="line">862</div><div class="line">863</div><div class="line">864</div><div class="line">865</div><div class="line">866</div><div class="line">867</div><div class="line">868</div><div class="line">869</div><div class="line">870</div><div class="line">871</div><div class="line">872</div><div class="line">873</div><div class="line">874</div><div class="line">875</div><div class="line">876</div><div class="line">877</div><div class="line">878</div><div class="line">879</div><div class="line">880</div><div class="line">881</div><div class="line">882</div><div class="line">883</div><div class="line">884</div><div class="line">885</div><div class="line">886</div><div class="line">887</div><div class="line">888</div><div class="line">889</div><div class="line">890</div><div class="line">891</div><div class="line">892</div><div class="line">893</div><div class="line">894</div><div class="line">895</div><div class="line">896</div><div class="line">897</div><div class="line">898</div><div class="line">899</div><div class="line">900</div><div class="line">901</div><div class="line">902</div><div class="line">903</div><div class="line">904</div><div class="line">905</div><div class="line">906</div><div class="line">907</div><div class="line">908</div><div class="line">909</div><div class="line">910</div><div class="line">911</div><div class="line">912</div><div class="line">913</div><div class="line">914</div><div class="line">915</div><div class="line">916</div><div class="line">917</div><div class="line">918</div><div class="line">919</div><div class="line">920</div><div class="line">921</div><div class="line">922</div><div class="line">923</div><div class="line">924</div><div class="line">925</div><div class="line">926</div><div class="line">927</div><div class="line">928</div><div class="line">929</div><div class="line">930</div><div class="line">931</div><div class="line">932</div><div class="line">933</div><div class="line">934</div><div class="line">935</div><div class="line">936</div><div class="line">937</div><div class="line">938</div><div class="line">939</div><div class="line">940</div><div class="line">941</div><div class="line">942</div><div class="line">943</div><div class="line">944</div><div class="line">945</div><div class="line">946</div><div class="line">947</div><div class="line">948</div><div class="line">949</div><div class="line">950</div><div class="line">951</div><div class="line">952</div><div class="line">953</div><div class="line">954</div><div class="line">955</div><div class="line">956</div><div class="line">957</div><div class="line">958</div><div class="line">959</div><div class="line">960</div><div class="line">961</div><div class="line">962</div><div class="line">963</div><div class="line">964</div><div class="line">965</div><div class="line">966</div><div class="line">967</div><div class="line">968</div><div class="line">969</div><div class="line">970</div><div class="line">971</div><div class="line">972</div><div class="line">973</div><div class="line">974</div><div class="line">975</div><div class="line">976</div><div class="line">977</div><div class="line">978</div><div class="line">979</div><div class="line">980</div><div class="line">981</div><div class="line">982</div><div class="line">983</div><div class="line">984</div><div class="line">985</div><div class="line">986</div><div class="line">987</div><div class="line">988</div><div class="line">989</div><div class="line">990</div><div class="line">991</div><div class="line">992</div><div class="line">993</div><div class="line">994</div><div class="line">995</div><div class="line">996</div><div class="line">997</div><div class="line">998</div><div class="line">999</div><div class="line">1000</div><div class="line">1001</div><div class="line">1002</div><div class="line">1003</div><div class="line">1004</div><div class="line">1005</div><div class="line">1006</div><div class="line">1007</div><div class="line">1008</div><div class="line">1009</div><div class="line">1010</div><div class="line">1011</div><div class="line">1012</div><div class="line">1013</div><div class="line">1014</div><div class="line">1015</div><div class="line">1016</div><div class="line">1017</div><div class="line">1018</div><div class="line">1019</div><div class="line">1020</div><div class="line">1021</div><div class="line">1022</div><div class="line">1023</div><div class="line">1024</div><div class="line">1025</div><div class="line">1026</div><div class="line">1027</div><div class="line">1028</div><div class="line">1029</div><div class="line">1030</div><div class="line">1031</div><div class="line">1032</div><div class="line">1033</div><div class="line">1034</div><div class="line">1035</div><div class="line">1036</div><div class="line">1037</div><div class="line">1038</div><div class="line">1039</div><div class="line">1040</div><div class="line">1041</div><div class="line">1042</div><div class="line">1043</div><div class="line">1044</div><div class="line">1045</div><div class="line">1046</div><div class="line">1047</div><div class="line">1048</div><div class="line">1049</div><div class="line">1050</div><div class="line">1051</div><div class="line">1052</div><div class="line">1053</div><div class="line">1054</div><div class="line">1055</div><div class="line">1056</div><div class="line">1057</div><div class="line">1058</div><div class="line">1059</div><div class="line">1060</div><div class="line">1061</div><div class="line">1062</div><div class="line">1063</div><div class="line">1064</div><div class="line">1065</div><div class="line">1066</div><div class="line">1067</div><div class="line">1068</div><div class="line">1069</div><div class="line">1070</div><div class="line">1071</div><div class="line">1072</div><div class="line">1073</div><div class="line">1074</div><div class="line">1075</div><div class="line">1076</div><div class="line">1077</div><div class="line">1078</div><div class="line">1079</div><div class="line">1080</div><div class="line">1081</div><div class="line">1082</div><div class="line">1083</div><div class="line">1084</div><div class="line">1085</div><div class="line">1086</div><div class="line">1087</div><div class="line">1088</div><div class="line">1089</div><div class="line">1090</div><div class="line">1091</div><div class="line">1092</div><div class="line">1093</div><div class="line">1094</div><div class="line">1095</div><div class="line">1096</div><div class="line">1097</div><div class="line">1098</div><div class="line">1099</div><div class="line">1100</div><div class="line">1101</div><div class="line">1102</div><div class="line">1103</div><div class="line">1104</div><div class="line">1105</div><div class="line">1106</div><div class="line">1107</div><div class="line">1108</div><div class="line">1109</div><div class="line">1110</div><div class="line">1111</div><div class="line">1112</div><div class="line">1113</div><div class="line">1114</div><div class="line">1115</div><div class="line">1116</div><div class="line">1117</div><div class="line">1118</div><div class="line">1119</div><div class="line">1120</div><div class="line">1121</div><div class="line">1122</div><div class="line">1123</div><div class="line">1124</div><div class="line">1125</div><div class="line">1126</div><div class="line">1127</div><div class="line">1128</div><div class="line">1129</div><div class="line">1130</div><div class="line">1131</div><div class="line">1132</div><div class="line">1133</div><div class="line">1134</div><div class="line">1135</div><div class="line">1136</div><div class="line">1137</div><div class="line">1138</div><div class="line">1139</div><div class="line">1140</div><div class="line">1141</div><div class="line">1142</div><div class="line">1143</div><div class="line">1144</div><div class="line">1145</div><div class="line">1146</div><div class="line">1147</div><div class="line">1148</div><div class="line">1149</div><div class="line">1150</div><div class="line">1151</div><div class="line">1152</div><div class="line">1153</div><div class="line">1154</div><div class="line">1155</div><div class="line">1156</div><div class="line">1157</div><div class="line">1158</div><div class="line">1159</div><div class="line">1160</div><div class="line">1161</div><div class="line">1162</div><div class="line">1163</div><div class="line">1164</div><div class="line">1165</div><div class="line">1166</div><div class="line">1167</div><div class="line">1168</div><div class="line">1169</div><div class="line">1170</div><div class="line">1171</div><div class="line">1172</div><div class="line">1173</div><div class="line">1174</div><div class="line">1175</div><div class="line">1176</div><div class="line">1177</div><div class="line">1178</div><div class="line">1179</div><div class="line">1180</div><div class="line">1181</div><div class="line">1182</div><div class="line">1183</div><div class="line">1184</div><div class="line">1185</div><div class="line">1186</div><div class="line">1187</div><div class="line">1188</div><div class="line">1189</div><div class="line">1190</div><div class="line">1191</div><div class="line">1192</div><div class="line">1193</div><div class="line">1194</div><div class="line">1195</div><div class="line">1196</div><div class="line">1197</div><div class="line">1198</div><div class="line">1199</div><div class="line">1200</div><div class="line">1201</div><div class="line">1202</div><div class="line">1203</div><div class="line">1204</div><div class="line">1205</div><div class="line">1206</div><div class="line">1207</div><div class="line">1208</div><div class="line">1209</div><div class="line">1210</div><div class="line">1211</div><div class="line">1212</div><div class="line">1213</div><div class="line">1214</div><div class="line">1215</div><div class="line">1216</div><div class="line">1217</div><div class="line">1218</div><div class="line">1219</div><div class="line">1220</div><div class="line">1221</div><div class="line">1222</div><div class="line">1223</div><div class="line">1224</div><div class="line">1225</div><div class="line">1226</div><div class="line">1227</div><div class="line">1228</div><div class="line">1229</div><div class="line">1230</div><div class="line">1231</div><div class="line">1232</div><div class="line">1233</div><div class="line">1234</div><div class="line">1235</div><div class="line">1236</div><div class="line">1237</div><div class="line">1238</div><div class="line">1239</div><div class="line">1240</div><div class="line">1241</div><div class="line">1242</div><div class="line">1243</div><div class="line">1244</div><div class="line">1245</div><div class="line">1246</div><div class="line">1247</div><div class="line">1248</div><div class="line">1249</div><div class="line">1250</div><div class="line">1251</div><div class="line">1252</div><div class="line">1253</div><div class="line">1254</div><div class="line">1255</div><div class="line">1256</div><div class="line">1257</div><div class="line">1258</div><div class="line">1259</div><div class="line">1260</div><div class="line">1261</div><div class="line">1262</div><div class="line">1263</div><div class="line">1264</div><div class="line">1265</div><div class="line">1266</div><div class="line">1267</div><div class="line">1268</div><div class="line">1269</div><div class="line">1270</div><div class="line">1271</div><div class="line">1272</div><div class="line">1273</div><div class="line">1274</div><div class="line">1275</div><div class="line">1276</div><div class="line">1277</div><div class="line">1278</div><div class="line">1279</div><div class="line">1280</div><div class="line">1281</div><div class="line">1282</div><div class="line">1283</div><div class="line">1284</div><div class="line">1285</div><div class="line">1286</div><div class="line">1287</div><div class="line">1288</div><div class="line">1289</div><div class="line">1290</div><div class="line">1291</div><div class="line">1292</div><div class="line">1293</div><div class="line">1294</div><div class="line">1295</div><div class="line">1296</div><div class="line">1297</div><div class="line">1298</div><div class="line">1299</div><div class="line">1300</div><div class="line">1301</div><div class="line">1302</div><div class="line">1303</div><div class="line">1304</div><div class="line">1305</div><div class="line">1306</div><div class="line">1307</div><div class="line">1308</div><div class="line">1309</div><div class="line">1310</div><div class="line">1311</div><div class="line">1312</div><div class="line">1313</div><div class="line">1314</div><div class="line">1315</div><div class="line">1316</div><div class="line">1317</div><div class="line">1318</div><div class="line">1319</div><div class="line">1320</div><div class="line">1321</div><div class="line">1322</div><div class="line">1323</div><div class="line">1324</div><div class="line">1325</div><div class="line">1326</div><div class="line">1327</div><div class="line">1328</div><div class="line">1329</div><div class="line">1330</div><div class="line">1331</div><div class="line">1332</div><div class="line">1333</div><div class="line">1334</div><div class="line">1335</div><div class="line">1336</div><div class="line">1337</div><div class="line">1338</div><div class="line">1339</div><div class="line">1340</div><div class="line">1341</div><div class="line">1342</div><div class="line">1343</div><div class="line">1344</div><div class="line">1345</div><div class="line">1346</div><div class="line">1347</div><div class="line">1348</div><div class="line">1349</div><div class="line">1350</div><div class="line">1351</div><div class="line">1352</div><div class="line">1353</div><div class="line">1354</div><div class="line">1355</div><div class="line">1356</div><div class="line">1357</div><div class="line">1358</div><div class="line">1359</div><div class="line">1360</div><div class="line">1361</div><div class="line">1362</div><div class="line">1363</div><div class="line">1364</div><div class="line">1365</div><div class="line">1366</div><div class="line">1367</div><div class="line">1368</div><div class="line">1369</div><div class="line">1370</div><div class="line">1371</div><div class="line">1372</div><div class="line">1373</div><div class="line">1374</div><div class="line">1375</div><div class="line">1376</div><div class="line">1377</div><div class="line">1378</div><div class="line">1379</div><div class="line">1380</div><div class="line">1381</div><div class="line">1382</div><div class="line">1383</div><div class="line">1384</div><div class="line">1385</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">module</span> aes(clk,rst,load,address,keyexpen,staenc,stadec,din,keyexprdy,encdecrdy,dout);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">output</span> keyexprdy,encdecrdy;</div><div class="line"><span class="keyword">input</span>  clk,rst,load,keyexpen,staenc,stadec;</div><div class="line"><span class="keyword">input</span>  [<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"><span class="keyword">input</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"></div><div class="line"><span class="keyword">wire</span>  wrpckreg,keysel,rndkren,wrrndkrf,rconen,</div><div class="line">wrsben,mixsel,reginsel,wrregen;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] pckregout,roundkey;</div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] krfaddr,wrsbaddr;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"></div><div class="line">reg_128     pckreg(clk,wrpckreg,din,pckregout);</div><div class="line">aescontrol  control(clk,rst,load,address,keyexpen,staenc,stadec,</div><div class="line">keyexprdy,encdecrdy,keysel,rndkren,</div><div class="line">wrrndkrf,krfaddr,rconen,wrsben,wrsbaddr,</div><div class="line">keyadsel,mixsel,reginsel,wrregen,wrpckreg);</div><div class="line">keyexp  keyexp(clk,rst,keysel,rndkren,wrrndkrf,krfaddr,</div><div class="line">rconen,pckregout,roundkey);</div><div class="line">crydap  crydap(clk,wrsben,wrsbaddr,din,keyadsel,mixsel,</div><div class="line">reginsel,wrregen,pckregout,roundkey,dout);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> reg_128(clk,write,din,dout);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">input</span>  clk,write;</div><div class="line"><span class="keyword">input</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">          <span class="keyword">if</span>(write)</div><div class="line">            dout&lt;=din;</div><div class="line">          <span class="keyword">else</span></div><div class="line">            dout&lt;=dout;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> aescontrol(clk,rst,load,address,keyexp,staenc,</div><div class="line">stadec,keyexprdy,encdecrdy,keysel,rndkren,</div><div class="line">wrrndkrf,krfaddr,rconen,wrsben,wrsbaddr,</div><div class="line">keyadsel,mixsel,reginsel,wrregen,wrpckreg);</div><div class="line"><span class="keyword">output</span> keyexprdy,encdecrdy,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">output</span> wrsben,mixsel,reginsel,wrregen,wrpckreg;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] krfaddr,wrsbaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,load,keyexp,staenc,stadec;</div><div class="line"><span class="keyword">input</span>[<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"></div><div class="line"><span class="keyword">wire</span> [<span class="number">3</span>:<span class="number">0</span>] wrkrfaddr,rdkrfaddre,rdkrfaddrd,encstate,decstate;</div><div class="line"><span class="keyword">wire</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsele,keyadseld;</div><div class="line"><span class="keyword">wire</span> mixsele,reginsele,wrregene,encrdy,mixseld,reginseld,wrregend,decrdy;</div><div class="line"></div><div class="line"><span class="keyword">assign</span> krfaddr=(encstate != <span class="number">4'd0</span>)? rdkrfaddre:</div><div class="line">((decstate != <span class="number">4'd0</span>)?rdkrfaddrd:wrkrfaddr);</div><div class="line"><span class="keyword">assign</span> keyadsel=(encstate != <span class="number">4'd0</span>)? keyadsele:keyadseld;</div><div class="line"><span class="keyword">assign</span> mixsel=(encstate != <span class="number">4'd0</span>)? mixsele:mixseld;</div><div class="line"><span class="keyword">assign</span> reginsel=(encstate != <span class="number">4'd0</span>)? reginsele:reginseld;</div><div class="line"><span class="keyword">assign</span> wrregen=(encstate != <span class="number">4'd0</span>)? wrregene:wrregend;</div><div class="line"><span class="keyword">assign</span> encdecrdy=encrdy &amp; decrdy;</div><div class="line"></div><div class="line">keyexpfsm  keyexpfsm(clk,rst,keyexp,keysel,rndkren,</div><div class="line">wrrndkrf,wrkrfaddr,rconen,keyexprdy);</div><div class="line">encryfsm   encryfsm(clk,rst,staenc,keyadsele,mixsele,</div><div class="line">reginsele,wrregene,rdkrfaddre,encrdy,encstate);</div><div class="line">decryfsm   decryfsm(clk,rst,stadec,keyadseld,mixseld,</div><div class="line">reginseld,wrregend,rdkrfaddrd,decrdy,decstate);</div><div class="line"></div><div class="line"><span class="keyword">assign</span> wrsben=load &amp; ~address[<span class="number">4</span>];</div><div class="line"><span class="keyword">assign</span> wrsbaddr=address[<span class="number">3</span>:<span class="number">0</span>];</div><div class="line"><span class="keyword">assign</span> wrpckreg=load &amp; address[<span class="number">4</span>] &amp; ~address[<span class="number">3</span>] &amp; ~address[<span class="number">2</span>]</div><div class="line">&amp; ~address[<span class="number">1</span>] &amp; ~address[<span class="number">0</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> keyexpfsm(clk,rst,keyexp,keysel,rndkren,wrrndkrf,wrkrfaddr,rconen,keyexprdy);</div><div class="line"><span class="keyword">output</span> keysel,rndkren,wrrndkrf,rconen,keyexprdy;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] wrkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,keyexp;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,wrkrfaddr;</div><div class="line"><span class="keyword">reg</span> keysel,rndkren,keyexprdy;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> keyexp)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(keyexp == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                  <span class="keyword">else</span></div><div class="line">                           next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keysel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: keysel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd2</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    keysel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    keysel=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: keysel=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rndkren=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    rndkren=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    rndkren=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: rndkren=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> wrrndkrf=rndkren;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd2</span>: wrkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd4</span>: wrkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd5</span>: wrkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd6</span>: wrkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: wrkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd8</span>: wrkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd9</span>: wrkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="keyword">default</span>: wrkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> rconen=keysel;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyexprdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: keyexprdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> encryfsm(clk,rst,staenc,keyadsel,mixsel,reginsel,wrregen,rdkrfaddr,encrdy,state);</div><div class="line"><span class="keyword">output</span> wrregen,mixsel,reginsel,encrdy,state;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] rdkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,staenc;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,rdkrfaddr;</div><div class="line"><span class="keyword">reg</span> wrregen,encrdy;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> staenc)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(staenc == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                       next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrregen=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: wrregen=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> mixsel=<span class="number">0</span>;</div><div class="line"><span class="keyword">assign</span> reginsel=<span class="number">0</span>;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd1</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd2</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd3</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd4</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd5</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd6</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd7</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd8</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd9</span>: keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd10</span>:    keyadsel=<span class="number">2'b01</span>;</div><div class="line">              <span class="number">4'd11</span>:    keyadsel=<span class="number">2'b10</span>;</div><div class="line">              <span class="keyword">default</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd2</span>: rdkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd3</span>: rdkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd4</span>: rdkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd5</span>: rdkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd6</span>: rdkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: rdkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd8</span>: rdkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd9</span>: rdkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd10</span>:    rdkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd11</span>:    rdkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="keyword">default</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: encrdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: encrdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> decryfsm(clk,rst,stadec,keyadsel,mixsel,reginsel,wrregen,rdkrfaddr,decrdy,state);</div><div class="line"><span class="keyword">output</span> wrregen,mixsel,reginsel,decrdy,state;</div><div class="line"><span class="keyword">output</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">output</span> [<span class="number">3</span>:<span class="number">0</span>] rdkrfaddr;</div><div class="line"><span class="keyword">input</span> clk,rst,stadec;</div><div class="line"><span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] state,next_state,rdkrfaddr;</div><div class="line"><span class="keyword">reg</span> wrregen,decrdy,reginsel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">always</span> @(<span class="keyword">posedge</span> clk)</div><div class="line">    <span class="keyword">begin</span></div><div class="line">        <span class="keyword">if</span>(rst)</div><div class="line">            state&lt;=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            state&lt;=next_state;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">always</span> @ (state <span class="keyword">or</span> stadec)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: <span class="keyword">if</span>(stadec == <span class="number">1</span>)</div><div class="line">                       next_state = <span class="number">4'd1</span>;</div><div class="line">                        <span class="keyword">else</span></div><div class="line">                           next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: next_state = <span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd2</span>: next_state = <span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd3</span>: next_state = <span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd4</span>: next_state = <span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd5</span>: next_state = <span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: next_state = <span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd7</span>: next_state = <span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd8</span>: next_state = <span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd9</span>: next_state = <span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd10</span>: next_state = <span class="number">4'd11</span>;</div><div class="line">              <span class="number">4'd11</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>: next_state = <span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: wrregen=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd2</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    wrregen=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: wrregen=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: reginsel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd1</span>: reginsel=<span class="number">0</span>;</div><div class="line">              <span class="number">4'd2</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd3</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd4</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd5</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd6</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd7</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd8</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd9</span>: reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd10</span>:    reginsel=<span class="number">1</span>;</div><div class="line">              <span class="number">4'd11</span>:    reginsel=<span class="number">0</span>;</div><div class="line">              <span class="keyword">default</span>: reginsel=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">assign</span> mixsel=reginsel;</div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd1</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">              <span class="number">4'd2</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd3</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd4</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd5</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd6</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd7</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd8</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd9</span>: keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd10</span>:    keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="number">4'd11</span>:    keyadsel=<span class="number">2'b11</span>;</div><div class="line">              <span class="keyword">default</span>: keyadsel=<span class="number">2'b00</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="number">4'd1</span>: rdkrfaddr=<span class="number">4'd10</span>;</div><div class="line">              <span class="number">4'd2</span>: rdkrfaddr=<span class="number">4'd9</span>;</div><div class="line">              <span class="number">4'd3</span>: rdkrfaddr=<span class="number">4'd8</span>;</div><div class="line">              <span class="number">4'd4</span>: rdkrfaddr=<span class="number">4'd7</span>;</div><div class="line">              <span class="number">4'd5</span>: rdkrfaddr=<span class="number">4'd6</span>;</div><div class="line">              <span class="number">4'd6</span>: rdkrfaddr=<span class="number">4'd5</span>;</div><div class="line">              <span class="number">4'd7</span>: rdkrfaddr=<span class="number">4'd4</span>;</div><div class="line">              <span class="number">4'd8</span>: rdkrfaddr=<span class="number">4'd3</span>;</div><div class="line">              <span class="number">4'd9</span>: rdkrfaddr=<span class="number">4'd2</span>;</div><div class="line">              <span class="number">4'd10</span>:    rdkrfaddr=<span class="number">4'd1</span>;</div><div class="line">              <span class="number">4'd11</span>:    rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">              <span class="keyword">default</span>:    rdkrfaddr=<span class="number">4'd0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"></div><div class="line"><span class="keyword">always</span> @ (state)</div><div class="line">        <span class="keyword">case</span>(state)</div><div class="line">              <span class="number">4'd0</span>: decrdy=<span class="number">1</span>;</div><div class="line">              <span class="keyword">default</span>: decrdy=<span class="number">0</span>;</div><div class="line">        <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> keyexp(clk,rst,keysel,rndkren,wrrndkrf,</div><div class="line">addr,rconen,key,rndkrfout);</div><div class="line"><span class="keyword">output</span>[<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">input</span> clk,rst,keysel,rndkren,wrrndkrf,rconen;</div><div class="line"><span class="keyword">input</span>[<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">input</span>[<span class="number">127</span>:<span class="number">0</span>] key;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] rndkey,rndkrout,rndkrfout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">31</span>:<span class="number">0</span>] w4,w5,w6,w7,rotword,subword,xorrcon;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"></div><div class="line"><span class="keyword">assign</span> rndkey=(keysel==<span class="number">0</span>) ? key:&#123;w4,w5,w6,w7&#125;;</div><div class="line">reg_128 rndkreg(clk,rndkren,rndkey,rndkrout);</div><div class="line">rndkrf rndkrf(clk,wrrndkrf,addr,rndkey,rndkrfout);</div><div class="line"></div><div class="line"><span class="keyword">assign</span> rotword=&#123;rndkrout[<span class="number">23</span>:<span class="number">0</span>],rndkrout[<span class="number">31</span>:<span class="number">24</span>]&#125;;</div><div class="line">sbox_mux sbox0(rotword[<span class="number">31</span>:<span class="number">24</span>],subword[<span class="number">31</span>:<span class="number">24</span>]);</div><div class="line">sbox_mux sbox1(rotword[<span class="number">23</span>:<span class="number">16</span>],subword[<span class="number">23</span>:<span class="number">16</span>]);</div><div class="line">sbox_mux sbox2(rotword[<span class="number">15</span>:<span class="number">8</span>],subword[<span class="number">15</span>:<span class="number">8</span>]);</div><div class="line">sbox_mux sbox3(rotword[<span class="number">7</span>:<span class="number">0</span>],subword[<span class="number">7</span>:<span class="number">0</span>]);</div><div class="line"></div><div class="line">rcon rcon(clk,rst,rconen,rconout);</div><div class="line"><span class="keyword">assign</span> xorrcon=subword^&#123;rconout,<span class="number">24'h000000</span>&#125;;</div><div class="line"><span class="keyword">assign</span> w4=xorrcon^rndkrout[<span class="number">127</span>:<span class="number">96</span>];</div><div class="line"><span class="keyword">assign</span> w5=w4^rndkrout[<span class="number">95</span>:<span class="number">64</span>];</div><div class="line"><span class="keyword">assign</span> w6=w5^rndkrout[<span class="number">63</span>:<span class="number">32</span>];</div><div class="line"><span class="keyword">assign</span> w7=w6^rndkrout[<span class="number">31</span>:<span class="number">0</span>];</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> rndkrf(clk,wrrndkrf,addr,rndkey,rndkrfout);</div><div class="line"><span class="keyword">input</span> clk,wrrndkrf;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] addr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] rndkey;</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">reg</span> [<span class="number">10</span>:<span class="number">0</span>] decout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">10</span>:<span class="number">0</span>] write_reg;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] reg0out,reg1out,reg2out,reg3out,reg4out,reg5out,reg6out,reg7out,reg8out,reg9out,reg10out;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] rndkrfout;</div><div class="line"><span class="keyword">always</span> @ (addr)</div><div class="line"><span class="keyword">case</span>(addr)</div><div class="line"><span class="number">4'd0</span>: decout=<span class="number">11'b000_0000_0001</span>;</div><div class="line"><span class="number">4'd1</span>: decout=<span class="number">11'b000_0000_0010</span>;</div><div class="line"><span class="number">4'd2</span>: decout=<span class="number">11'b000_0000_0100</span>;</div><div class="line"><span class="number">4'd3</span>: decout=<span class="number">11'b000_0000_1000</span>;</div><div class="line"><span class="number">4'd4</span>: decout=<span class="number">11'b000_0001_0000</span>;</div><div class="line"><span class="number">4'd5</span>: decout=<span class="number">11'b000_0010_0000</span>;</div><div class="line"><span class="number">4'd6</span>: decout=<span class="number">11'b000_0100_0000</span>;</div><div class="line"><span class="number">4'd7</span>: decout=<span class="number">11'b000_1000_0000</span>;</div><div class="line"><span class="number">4'd8</span>: decout=<span class="number">11'b001_0000_0000</span>;</div><div class="line"><span class="number">4'd9</span>: decout=<span class="number">11'b010_0000_0000</span>;</div><div class="line"><span class="number">4'd10</span>: decout=<span class="number">11'b100_0000_0000</span>;</div><div class="line"><span class="keyword">default</span>: decout=<span class="number">11'b000_0000_0000</span>;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">assign</span> write_reg=decout &amp; &#123;wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf,wrrndkrf&#125;;</div><div class="line"></div><div class="line">reg_128 reg0(clk,write_reg[<span class="number">0</span>],rndkey,reg0out);</div><div class="line">reg_128 reg1(clk,write_reg[<span class="number">1</span>],rndkey,reg1out);</div><div class="line">reg_128 reg2(clk,write_reg[<span class="number">2</span>],rndkey,reg2out);</div><div class="line">reg_128 reg3(clk,write_reg[<span class="number">3</span>],rndkey,reg3out);</div><div class="line">reg_128 reg4(clk,write_reg[<span class="number">4</span>],rndkey,reg4out);</div><div class="line">reg_128 reg5(clk,write_reg[<span class="number">5</span>],rndkey,reg5out);</div><div class="line">reg_128 reg6(clk,write_reg[<span class="number">6</span>],rndkey,reg6out);</div><div class="line">reg_128 reg7(clk,write_reg[<span class="number">7</span>],rndkey,reg7out);</div><div class="line">reg_128 reg8(clk,write_reg[<span class="number">8</span>],rndkey,reg8out);</div><div class="line">reg_128 reg9(clk,write_reg[<span class="number">9</span>],rndkey,reg9out);</div><div class="line">reg_128 reg10(clk,write_reg[<span class="number">10</span>],rndkey,reg10out);</div><div class="line"><span class="keyword">always</span> @(addr <span class="keyword">or</span> reg0out <span class="keyword">or</span> reg1out <span class="keyword">or</span> reg2out <span class="keyword">or</span> reg3out <span class="keyword">or</span> reg4out <span class="keyword">or</span> reg5out <span class="keyword">or</span> reg6out <span class="keyword">or</span> reg7out <span class="keyword">or</span> reg8out <span class="keyword">or</span> reg9out <span class="keyword">or</span> reg10out)</div><div class="line"><span class="keyword">case</span>(addr)</div><div class="line"><span class="number">4'd0</span>: rndkrfout=reg0out;</div><div class="line"><span class="number">4'd1</span>: rndkrfout=reg1out;</div><div class="line"><span class="number">4'd2</span>: rndkrfout=reg2out;</div><div class="line"><span class="number">4'd3</span>: rndkrfout=reg3out;</div><div class="line"><span class="number">4'd4</span>: rndkrfout=reg4out;</div><div class="line"><span class="number">4'd5</span>: rndkrfout=reg5out;</div><div class="line"><span class="number">4'd6</span>: rndkrfout=reg6out;</div><div class="line"><span class="number">4'd7</span>: rndkrfout=reg7out;</div><div class="line"><span class="number">4'd8</span>: rndkrfout=reg8out;</div><div class="line"><span class="number">4'd9</span>: rndkrfout=reg9out;</div><div class="line"><span class="number">4'd10</span>: rndkrfout=reg10out;</div><div class="line"><span class="keyword">default</span>: rndkrfout=reg10out;</div><div class="line"><span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> sbox_mux(in,out);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] out;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] in;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] out;</div><div class="line"><span class="keyword">always</span>@(in)</div><div class="line">  <span class="keyword">case</span>(in)</div><div class="line">    <span class="number">8'h00</span>: out=<span class="number">8'h63</span>;</div><div class="line">    <span class="number">8'h01</span>: out=<span class="number">8'h7c</span>;</div><div class="line">    <span class="number">8'h02</span>: out=<span class="number">8'h77</span>;</div><div class="line">    <span class="number">8'h03</span>: out=<span class="number">8'h7b</span>;</div><div class="line">    <span class="number">8'h04</span>: out=<span class="number">8'hf2</span>;</div><div class="line">    <span class="number">8'h05</span>: out=<span class="number">8'h6b</span>;</div><div class="line">    <span class="number">8'h06</span>: out=<span class="number">8'h6f</span>;</div><div class="line">    <span class="number">8'h07</span>: out=<span class="number">8'hc5</span>;</div><div class="line">    <span class="number">8'h08</span>: out=<span class="number">8'h30</span>;</div><div class="line">    <span class="number">8'h09</span>: out=<span class="number">8'h01</span>;</div><div class="line">    <span class="number">8'h0a</span>: out=<span class="number">8'h67</span>;</div><div class="line">    <span class="number">8'h0b</span>: out=<span class="number">8'h2b</span>;</div><div class="line">    <span class="number">8'h0c</span>: out=<span class="number">8'hfe</span>;</div><div class="line">    <span class="number">8'h0d</span>: out=<span class="number">8'hd7</span>;</div><div class="line">    <span class="number">8'h0e</span>: out=<span class="number">8'hab</span>;</div><div class="line">    <span class="number">8'h0f</span>: out=<span class="number">8'h76</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h10</span>: out=<span class="number">8'hca</span>;</div><div class="line">    <span class="number">8'h11</span>: out=<span class="number">8'h82</span>;</div><div class="line">    <span class="number">8'h12</span>: out=<span class="number">8'hc9</span>;</div><div class="line">    <span class="number">8'h13</span>: out=<span class="number">8'h7d</span>;</div><div class="line">    <span class="number">8'h14</span>: out=<span class="number">8'hfa</span>;</div><div class="line">    <span class="number">8'h15</span>: out=<span class="number">8'h59</span>;</div><div class="line">    <span class="number">8'h16</span>: out=<span class="number">8'h47</span>;</div><div class="line">    <span class="number">8'h17</span>: out=<span class="number">8'hf0</span>;</div><div class="line">    <span class="number">8'h18</span>: out=<span class="number">8'had</span>;</div><div class="line">    <span class="number">8'h19</span>: out=<span class="number">8'hd4</span>;</div><div class="line">    <span class="number">8'h1a</span>: out=<span class="number">8'ha2</span>;</div><div class="line">    <span class="number">8'h1b</span>: out=<span class="number">8'haf</span>;</div><div class="line">    <span class="number">8'h1c</span>: out=<span class="number">8'h9c</span>;</div><div class="line">    <span class="number">8'h1d</span>: out=<span class="number">8'ha4</span>;</div><div class="line">    <span class="number">8'h1e</span>: out=<span class="number">8'h72</span>;</div><div class="line">    <span class="number">8'h1f</span>: out=<span class="number">8'hc0</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h20</span>: out=<span class="number">8'hb7</span>;</div><div class="line">    <span class="number">8'h21</span>: out=<span class="number">8'hfd</span>;</div><div class="line">    <span class="number">8'h22</span>: out=<span class="number">8'h93</span>;</div><div class="line">    <span class="number">8'h23</span>: out=<span class="number">8'h26</span>;</div><div class="line">    <span class="number">8'h24</span>: out=<span class="number">8'h36</span>;</div><div class="line">    <span class="number">8'h25</span>: out=<span class="number">8'h3f</span>;</div><div class="line">    <span class="number">8'h26</span>: out=<span class="number">8'hf7</span>;</div><div class="line">    <span class="number">8'h27</span>: out=<span class="number">8'hcc</span>;</div><div class="line">    <span class="number">8'h28</span>: out=<span class="number">8'h34</span>;</div><div class="line">    <span class="number">8'h29</span>: out=<span class="number">8'ha5</span>;</div><div class="line">    <span class="number">8'h2a</span>: out=<span class="number">8'he5</span>;</div><div class="line">    <span class="number">8'h2b</span>: out=<span class="number">8'hf1</span>;</div><div class="line">    <span class="number">8'h2c</span>: out=<span class="number">8'h71</span>;</div><div class="line">    <span class="number">8'h2d</span>: out=<span class="number">8'hd8</span>;</div><div class="line">    <span class="number">8'h2e</span>: out=<span class="number">8'h31</span>;</div><div class="line">    <span class="number">8'h2f</span>: out=<span class="number">8'h15</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h30</span>: out=<span class="number">8'h04</span>;</div><div class="line">    <span class="number">8'h31</span>: out=<span class="number">8'hc7</span>;</div><div class="line">    <span class="number">8'h32</span>: out=<span class="number">8'h23</span>;</div><div class="line">    <span class="number">8'h33</span>: out=<span class="number">8'hc3</span>;</div><div class="line">    <span class="number">8'h34</span>: out=<span class="number">8'h18</span>;</div><div class="line">    <span class="number">8'h35</span>: out=<span class="number">8'h96</span>;</div><div class="line">    <span class="number">8'h36</span>: out=<span class="number">8'h05</span>;</div><div class="line">    <span class="number">8'h37</span>: out=<span class="number">8'h9a</span>;</div><div class="line">    <span class="number">8'h38</span>: out=<span class="number">8'h07</span>;</div><div class="line">    <span class="number">8'h39</span>: out=<span class="number">8'h12</span>;</div><div class="line">    <span class="number">8'h3a</span>: out=<span class="number">8'h80</span>;</div><div class="line">    <span class="number">8'h3b</span>: out=<span class="number">8'he2</span>;</div><div class="line">    <span class="number">8'h3c</span>: out=<span class="number">8'heb</span>;</div><div class="line">    <span class="number">8'h3d</span>: out=<span class="number">8'h27</span>;</div><div class="line">    <span class="number">8'h3e</span>: out=<span class="number">8'hb2</span>;</div><div class="line">    <span class="number">8'h3f</span>: out=<span class="number">8'h75</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h40</span>: out=<span class="number">8'h09</span>;</div><div class="line">    <span class="number">8'h41</span>: out=<span class="number">8'h83</span>;</div><div class="line">    <span class="number">8'h42</span>: out=<span class="number">8'h2c</span>;</div><div class="line">    <span class="number">8'h43</span>: out=<span class="number">8'h1a</span>;</div><div class="line">    <span class="number">8'h44</span>: out=<span class="number">8'h1b</span>;</div><div class="line">    <span class="number">8'h45</span>: out=<span class="number">8'h6e</span>;</div><div class="line">    <span class="number">8'h46</span>: out=<span class="number">8'h5a</span>;</div><div class="line">    <span class="number">8'h47</span>: out=<span class="number">8'ha0</span>;</div><div class="line">    <span class="number">8'h48</span>: out=<span class="number">8'h52</span>;</div><div class="line">    <span class="number">8'h49</span>: out=<span class="number">8'h3b</span>;</div><div class="line">    <span class="number">8'h4a</span>: out=<span class="number">8'hd6</span>;</div><div class="line">    <span class="number">8'h4b</span>: out=<span class="number">8'hb3</span>;</div><div class="line">    <span class="number">8'h4c</span>: out=<span class="number">8'h29</span>;</div><div class="line">    <span class="number">8'h4d</span>: out=<span class="number">8'he3</span>;</div><div class="line">    <span class="number">8'h4e</span>: out=<span class="number">8'h2f</span>;</div><div class="line">    <span class="number">8'h4f</span>: out=<span class="number">8'h84</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h50</span>: out=<span class="number">8'h53</span>;</div><div class="line">    <span class="number">8'h51</span>: out=<span class="number">8'hd1</span>;</div><div class="line">    <span class="number">8'h52</span>: out=<span class="number">8'h00</span>;</div><div class="line">    <span class="number">8'h53</span>: out=<span class="number">8'hed</span>;</div><div class="line">    <span class="number">8'h54</span>: out=<span class="number">8'h20</span>;</div><div class="line">    <span class="number">8'h55</span>: out=<span class="number">8'hfc</span>;</div><div class="line">    <span class="number">8'h56</span>: out=<span class="number">8'hb1</span>;</div><div class="line">    <span class="number">8'h57</span>: out=<span class="number">8'h5b</span>;</div><div class="line">    <span class="number">8'h58</span>: out=<span class="number">8'h6a</span>;</div><div class="line">    <span class="number">8'h59</span>: out=<span class="number">8'hcb</span>;</div><div class="line">    <span class="number">8'h5a</span>: out=<span class="number">8'hbe</span>;</div><div class="line">    <span class="number">8'h5b</span>: out=<span class="number">8'h39</span>;</div><div class="line">    <span class="number">8'h5c</span>: out=<span class="number">8'h4a</span>;</div><div class="line">    <span class="number">8'h5d</span>: out=<span class="number">8'h4c</span>;</div><div class="line">    <span class="number">8'h5e</span>: out=<span class="number">8'h58</span>;</div><div class="line">    <span class="number">8'h5f</span>: out=<span class="number">8'hcf</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h60</span>: out=<span class="number">8'hd0</span>;</div><div class="line">    <span class="number">8'h61</span>: out=<span class="number">8'hef</span>;</div><div class="line">    <span class="number">8'h62</span>: out=<span class="number">8'haa</span>;</div><div class="line">    <span class="number">8'h63</span>: out=<span class="number">8'hfb</span>;</div><div class="line">    <span class="number">8'h64</span>: out=<span class="number">8'h43</span>;</div><div class="line">    <span class="number">8'h65</span>: out=<span class="number">8'h4d</span>;</div><div class="line">    <span class="number">8'h66</span>: out=<span class="number">8'h33</span>;</div><div class="line">    <span class="number">8'h67</span>: out=<span class="number">8'h85</span>;</div><div class="line">    <span class="number">8'h68</span>: out=<span class="number">8'h45</span>;</div><div class="line">    <span class="number">8'h69</span>: out=<span class="number">8'hf9</span>;</div><div class="line">    <span class="number">8'h6a</span>: out=<span class="number">8'h02</span>;</div><div class="line">    <span class="number">8'h6b</span>: out=<span class="number">8'h7f</span>;</div><div class="line">    <span class="number">8'h6c</span>: out=<span class="number">8'h50</span>;</div><div class="line">    <span class="number">8'h6d</span>: out=<span class="number">8'h3c</span>;</div><div class="line">    <span class="number">8'h6e</span>: out=<span class="number">8'h9f</span>;</div><div class="line">    <span class="number">8'h6f</span>: out=<span class="number">8'ha8</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h70</span>: out=<span class="number">8'h51</span>;</div><div class="line">    <span class="number">8'h71</span>: out=<span class="number">8'ha3</span>;</div><div class="line">    <span class="number">8'h72</span>: out=<span class="number">8'h40</span>;</div><div class="line">    <span class="number">8'h73</span>: out=<span class="number">8'h8f</span>;</div><div class="line">    <span class="number">8'h74</span>: out=<span class="number">8'h92</span>;</div><div class="line">    <span class="number">8'h75</span>: out=<span class="number">8'h9d</span>;</div><div class="line">    <span class="number">8'h76</span>: out=<span class="number">8'h38</span>;</div><div class="line">    <span class="number">8'h77</span>: out=<span class="number">8'hf5</span>;</div><div class="line">    <span class="number">8'h78</span>: out=<span class="number">8'hbc</span>;</div><div class="line">    <span class="number">8'h79</span>: out=<span class="number">8'hb6</span>;</div><div class="line">    <span class="number">8'h7a</span>: out=<span class="number">8'hda</span>;</div><div class="line">    <span class="number">8'h7b</span>: out=<span class="number">8'h21</span>;</div><div class="line">    <span class="number">8'h7c</span>: out=<span class="number">8'h10</span>;</div><div class="line">    <span class="number">8'h7d</span>: out=<span class="number">8'hff</span>;</div><div class="line">    <span class="number">8'h7e</span>: out=<span class="number">8'hf3</span>;</div><div class="line">    <span class="number">8'h7f</span>: out=<span class="number">8'hd2</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h80</span>: out=<span class="number">8'hcd</span>;</div><div class="line">    <span class="number">8'h81</span>: out=<span class="number">8'h0c</span>;</div><div class="line">    <span class="number">8'h82</span>: out=<span class="number">8'h13</span>;</div><div class="line">    <span class="number">8'h83</span>: out=<span class="number">8'hec</span>;</div><div class="line">    <span class="number">8'h84</span>: out=<span class="number">8'h5f</span>;</div><div class="line">    <span class="number">8'h85</span>: out=<span class="number">8'h97</span>;</div><div class="line">    <span class="number">8'h86</span>: out=<span class="number">8'h44</span>;</div><div class="line">    <span class="number">8'h87</span>: out=<span class="number">8'h17</span>;</div><div class="line">    <span class="number">8'h88</span>: out=<span class="number">8'hc4</span>;</div><div class="line">    <span class="number">8'h89</span>: out=<span class="number">8'ha7</span>;</div><div class="line">    <span class="number">8'h8a</span>: out=<span class="number">8'h7e</span>;</div><div class="line">    <span class="number">8'h8b</span>: out=<span class="number">8'h3d</span>;</div><div class="line">    <span class="number">8'h8c</span>: out=<span class="number">8'h64</span>;</div><div class="line">    <span class="number">8'h8d</span>: out=<span class="number">8'h5d</span>;</div><div class="line">    <span class="number">8'h8e</span>: out=<span class="number">8'h19</span>;</div><div class="line">    <span class="number">8'h8f</span>: out=<span class="number">8'h73</span>;</div><div class="line"></div><div class="line">    <span class="number">8'h90</span>: out=<span class="number">8'h60</span>;</div><div class="line">    <span class="number">8'h91</span>: out=<span class="number">8'h81</span>;</div><div class="line">    <span class="number">8'h92</span>: out=<span class="number">8'h4f</span>;</div><div class="line">    <span class="number">8'h93</span>: out=<span class="number">8'hdc</span>;</div><div class="line">    <span class="number">8'h94</span>: out=<span class="number">8'h22</span>;</div><div class="line">    <span class="number">8'h95</span>: out=<span class="number">8'h2a</span>;</div><div class="line">    <span class="number">8'h96</span>: out=<span class="number">8'h90</span>;</div><div class="line">    <span class="number">8'h97</span>: out=<span class="number">8'h88</span>;</div><div class="line">    <span class="number">8'h98</span>: out=<span class="number">8'h46</span>;</div><div class="line">    <span class="number">8'h99</span>: out=<span class="number">8'hee</span>;</div><div class="line">    <span class="number">8'h9a</span>: out=<span class="number">8'hb8</span>;</div><div class="line">      <span class="number">8'h9b</span>: out=<span class="number">8'h14</span>;</div><div class="line">    <span class="number">8'h9c</span>: out=<span class="number">8'hde</span>;</div><div class="line">    <span class="number">8'h9d</span>: out=<span class="number">8'h5e</span>;</div><div class="line">    <span class="number">8'h9e</span>: out=<span class="number">8'h0b</span>;</div><div class="line">    <span class="number">8'h9f</span>: out=<span class="number">8'hdb</span>;</div><div class="line"></div><div class="line">    <span class="number">8'ha0</span>: out=<span class="number">8'he0</span>;</div><div class="line">    <span class="number">8'ha1</span>: out=<span class="number">8'h32</span>;</div><div class="line">    <span class="number">8'ha2</span>: out=<span class="number">8'h3a</span>;</div><div class="line">    <span class="number">8'ha3</span>: out=<span class="number">8'h0a</span>;</div><div class="line">    <span class="number">8'ha4</span>: out=<span class="number">8'h49</span>;</div><div class="line">    <span class="number">8'ha5</span>: out=<span class="number">8'h06</span>;</div><div class="line">    <span class="number">8'ha6</span>: out=<span class="number">8'h24</span>;</div><div class="line">    <span class="number">8'ha7</span>: out=<span class="number">8'h5c</span>;</div><div class="line">    <span class="number">8'ha8</span>: out=<span class="number">8'hc2</span>;</div><div class="line">    <span class="number">8'ha9</span>: out=<span class="number">8'hd3</span>;</div><div class="line">    <span class="number">8'haa</span>: out=<span class="number">8'hac</span>;</div><div class="line">    <span class="number">8'hab</span>: out=<span class="number">8'h62</span>;</div><div class="line">    <span class="number">8'hac</span>: out=<span class="number">8'h91</span>;</div><div class="line">    <span class="number">8'had</span>: out=<span class="number">8'h95</span>;</div><div class="line">    <span class="number">8'hae</span>: out=<span class="number">8'he4</span>;</div><div class="line">    <span class="number">8'haf</span>: out=<span class="number">8'h79</span>;</div><div class="line"></div><div class="line">    <span class="number">8'hb0</span>: out=<span class="number">8'he7</span>;</div><div class="line">    <span class="number">8'hb1</span>: out=<span class="number">8'hc8</span>;</div><div class="line">    <span class="number">8'hb2</span>: out=<span class="number">8'h37</span>;</div><div class="line">    <span class="number">8'hb3</span>: out=<span class="number">8'h6d</span>;</div><div class="line">    <span class="number">8'hb4</span>: out=<span class="number">8'h8d</span>;</div><div class="line">    <span class="number">8'hb5</span>: out=<span class="number">8'hd5</span>;</div><div class="line">    <span class="number">8'hb6</span>: out=<span class="number">8'h4e</span>;</div><div class="line">    <span class="number">8'hb7</span>: out=<span class="number">8'ha9</span>;</div><div class="line">    <span class="number">8'hb8</span>: out=<span class="number">8'h6c</span>;</div><div class="line">    <span class="number">8'hb9</span>: out=<span class="number">8'h56</span>;</div><div class="line">    <span class="number">8'hba</span>: out=<span class="number">8'hf4</span>;</div><div class="line">    <span class="number">8'hbb</span>: out=<span class="number">8'hea</span>;</div><div class="line">    <span class="number">8'hbc</span>: out=<span class="number">8'h65</span>;</div><div class="line">    <span class="number">8'hbd</span>: out=<span class="number">8'h7a</span>;</div><div class="line">    <span class="number">8'hbe</span>: out=<span class="number">8'hae</span>;</div><div class="line">    <span class="number">8'hbf</span>: out=<span class="number">8'h08</span>;</div><div class="line"></div><div class="line">          <span class="number">8'hc0</span>: out=<span class="number">8'hba</span>;</div><div class="line">          <span class="number">8'hc1</span>: out=<span class="number">8'h78</span>;</div><div class="line">          <span class="number">8'hc2</span>: out=<span class="number">8'h25</span>;</div><div class="line">          <span class="number">8'hc3</span>: out=<span class="number">8'h2e</span>;</div><div class="line">          <span class="number">8'hc4</span>: out=<span class="number">8'h1c</span>;</div><div class="line">          <span class="number">8'hc5</span>: out=<span class="number">8'ha6</span>;</div><div class="line">          <span class="number">8'hc6</span>: out=<span class="number">8'hb4</span>;</div><div class="line">          <span class="number">8'hc7</span>: out=<span class="number">8'hc6</span>;</div><div class="line">          <span class="number">8'hc8</span>: out=<span class="number">8'he8</span>;</div><div class="line">          <span class="number">8'hc9</span>: out=<span class="number">8'hdd</span>;</div><div class="line">          <span class="number">8'hca</span>: out=<span class="number">8'h74</span>;</div><div class="line">          <span class="number">8'hcb</span>: out=<span class="number">8'h1f</span>;</div><div class="line">          <span class="number">8'hcc</span>: out=<span class="number">8'h4b</span>;</div><div class="line">          <span class="number">8'hcd</span>: out=<span class="number">8'hbd</span>;</div><div class="line">          <span class="number">8'hce</span>: out=<span class="number">8'h8b</span>;</div><div class="line">          <span class="number">8'hcf</span>: out=<span class="number">8'h8a</span>;</div><div class="line"></div><div class="line">          <span class="number">8'hd0</span>: out=<span class="number">8'h70</span>;</div><div class="line">          <span class="number">8'hd1</span>: out=<span class="number">8'h3e</span>;</div><div class="line">          <span class="number">8'hd2</span>: out=<span class="number">8'hb5</span>;</div><div class="line">          <span class="number">8'hd3</span>: out=<span class="number">8'h66</span>;</div><div class="line">          <span class="number">8'hd4</span>: out=<span class="number">8'h48</span>;</div><div class="line">          <span class="number">8'hd5</span>: out=<span class="number">8'h03</span>;</div><div class="line">          <span class="number">8'hd6</span>: out=<span class="number">8'hf6</span>;</div><div class="line">          <span class="number">8'hd7</span>: out=<span class="number">8'h0e</span>;</div><div class="line">          <span class="number">8'hd8</span>: out=<span class="number">8'h61</span>;</div><div class="line">          <span class="number">8'hd9</span>: out=<span class="number">8'h35</span>;</div><div class="line">          <span class="number">8'hda</span>: out=<span class="number">8'h57</span>;</div><div class="line">          <span class="number">8'hdb</span>: out=<span class="number">8'hb9</span>;</div><div class="line">          <span class="number">8'hdc</span>: out=<span class="number">8'h86</span>;</div><div class="line">          <span class="number">8'hdd</span>: out=<span class="number">8'hc1</span>;</div><div class="line">          <span class="number">8'hde</span>: out=<span class="number">8'h1d</span>;</div><div class="line">          <span class="number">8'hdf</span>: out=<span class="number">8'h9e</span>;</div><div class="line"></div><div class="line">          <span class="number">8'he0</span>: out=<span class="number">8'he1</span>;</div><div class="line">          <span class="number">8'he1</span>: out=<span class="number">8'hf8</span>;</div><div class="line">          <span class="number">8'he2</span>: out=<span class="number">8'h98</span>;</div><div class="line">          <span class="number">8'he3</span>: out=<span class="number">8'h11</span>;</div><div class="line">          <span class="number">8'he4</span>: out=<span class="number">8'h69</span>;</div><div class="line">          <span class="number">8'he5</span>: out=<span class="number">8'hd9</span>;</div><div class="line">          <span class="number">8'he6</span>: out=<span class="number">8'h8e</span>;</div><div class="line">          <span class="number">8'he7</span>: out=<span class="number">8'h94</span>;</div><div class="line">          <span class="number">8'he8</span>: out=<span class="number">8'h9b</span>;</div><div class="line">          <span class="number">8'he9</span>: out=<span class="number">8'h1e</span>;</div><div class="line">          <span class="number">8'hea</span>: out=<span class="number">8'h87</span>;</div><div class="line">          <span class="number">8'heb</span>: out=<span class="number">8'he9</span>;</div><div class="line">          <span class="number">8'hec</span>: out=<span class="number">8'hce</span>;</div><div class="line">          <span class="number">8'hed</span>: out=<span class="number">8'h55</span>;</div><div class="line">          <span class="number">8'hee</span>: out=<span class="number">8'h28</span>;</div><div class="line">          <span class="number">8'hef</span>: out=<span class="number">8'hdf</span>;</div><div class="line"></div><div class="line">          <span class="number">8'hf0</span>: out=<span class="number">8'h8c</span>;</div><div class="line">          <span class="number">8'hf1</span>: out=<span class="number">8'ha1</span>;</div><div class="line">          <span class="number">8'hf2</span>: out=<span class="number">8'h89</span>;</div><div class="line">          <span class="number">8'hf3</span>: out=<span class="number">8'h0d</span>;</div><div class="line">          <span class="number">8'hf4</span>: out=<span class="number">8'hbf</span>;</div><div class="line">          <span class="number">8'hf5</span>: out=<span class="number">8'he6</span>;</div><div class="line">          <span class="number">8'hf6</span>: out=<span class="number">8'h42</span>;</div><div class="line">          <span class="number">8'hf7</span>: out=<span class="number">8'h68</span>;</div><div class="line">          <span class="number">8'hf8</span>: out=<span class="number">8'h41</span>;</div><div class="line">          <span class="number">8'hf9</span>: out=<span class="number">8'h99</span>;</div><div class="line">          <span class="number">8'hfa</span>: out=<span class="number">8'h2d</span>;</div><div class="line">          <span class="number">8'hfb</span>: out=<span class="number">8'h0f</span>;</div><div class="line">          <span class="number">8'hfc</span>: out=<span class="number">8'hb0</span>;</div><div class="line">          <span class="number">8'hfd</span>: out=<span class="number">8'h54</span>;</div><div class="line">          <span class="number">8'hfe</span>: out=<span class="number">8'hbb</span>;</div><div class="line">          <span class="number">8'hff</span>: out=<span class="number">8'h16</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> rcon(clk,rst,write,rconout);</div><div class="line"></div><div class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line">    <span class="keyword">input</span>  clk,rst,write;</div><div class="line">    <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] rconout;</div><div class="line"></div><div class="line">    <span class="keyword">always</span> @ (<span class="keyword">posedge</span> clk)</div><div class="line">        <span class="keyword">begin</span></div><div class="line">            <span class="keyword">if</span>(rst)</div><div class="line">      rconout&lt;=<span class="number">8'h01</span>;</div><div class="line">             <span class="keyword">else</span> <span class="keyword">if</span>(write)</div><div class="line">      rconout&lt;=(rconout[<span class="number">7</span>]==<span class="number">0</span>)? (rconout&lt;&lt;<span class="number">1</span>):((rconout&lt;&lt;<span class="number">1</span>)^&#123;<span class="number">8'h1b</span>&#125;);</div><div class="line">             <span class="keyword">else</span></div><div class="line">      rconout&lt;=rconout;</div><div class="line">        <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> crydap(clk,wrsben,wrsbaddr,sbdata,keyadsel,</div><div class="line">mixsel,reginsel,wrregen,intxt,roundkey,outtxt);</div><div class="line"><span class="keyword">output</span> [<span class="number">127</span>:<span class="number">0</span>] outtxt;</div><div class="line"><span class="keyword">input</span> clk,wrsben,wrregen,mixsel,reginsel;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] keyadsel;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] wrsbaddr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] sbdata,intxt,roundkey;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] sb0out,sb1out,sb2out,sb3out,sb4out,sb5out,sb6out,sb7out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] sb8out,sb9out,sb10out,sb11out,sb12out,sb13out,</div><div class="line">sb14out,sb15out;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a0,b0,c0,a1,b1,c1,a2,b2,c2,a3,b3,c3,a4,b4,c4,a5,b5,c5;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a6,b6,c6,a7,b7,c7,a8,b8,c8,a9,b9,c9,a10,b10,c10,a11,</div><div class="line">b11,c11;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a12,b12,c12,a13,b13,c13,a14,b14,c14,a15,b15,c15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f0,f1,f2,f3,f4,f5,f6,f7,f8,f9,f10,f11,f12,f13,f14,f15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] i0,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,i14,i15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] j0,j1,j2,j3,j4,j5,j6,j7,j8,j9,j10,j11,j12,j13,j14,j15;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f002,f003,f009,f00b,f00d,f00e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f102,f103,f109,f10b,f10d,f10e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f202,f203,f209,f20b,f20d,f20e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f302,f303,f309,f30b,f30d,f30e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f402,f403,f409,f40b,f40d,f40e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f502,f503,f509,f50b,f50d,f50e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f602,f603,f609,f60b,f60d,f60e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f702,f703,f709,f70b,f70d,f70e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f802,f803,f809,f80b,f80d,f80e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f902,f903,f909,f90b,f90d,f90e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1002,f1003,f1009,f100b,f100d,f100e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1102,f1103,f1109,f110b,f110d,f110e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1202,f1203,f1209,f120b,f120d,f120e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1302,f1303,f1309,f130b,f130d,f130e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1402,f1403,f1409,f140b,f140d,f140e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] f1502,f1503,f1509,f150b,f150d,f150e;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] d,e,g,h;</div><div class="line">sbox  sbox0(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">127</span>:<span class="number">120</span>],sb0out);</div><div class="line">sbox  sbox1(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">119</span>:<span class="number">112</span>],sb1out);</div><div class="line">sbox  sbox2(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">111</span>:<span class="number">104</span>],sb2out);</div><div class="line">sbox  sbox3(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">103</span>:<span class="number">96</span>],sb3out);</div><div class="line">sbox  sbox4(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">95</span>:<span class="number">88</span>],sb4out);</div><div class="line">sbox  sbox5(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">87</span>:<span class="number">80</span>],sb5out);</div><div class="line">sbox  sbox6(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">79</span>:<span class="number">72</span>],sb6out);</div><div class="line">sbox  sbox7(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">71</span>:<span class="number">64</span>],sb7out);</div><div class="line">sbox  sbox8(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">63</span>:<span class="number">56</span>],sb8out);</div><div class="line">sbox  sbox9(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">55</span>:<span class="number">48</span>],sb9out);</div><div class="line">sbox  sbox10(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">47</span>:<span class="number">40</span>],sb10out);</div><div class="line">sbox  sbox11(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">39</span>:<span class="number">32</span>],sb11out);</div><div class="line">sbox  sbox12(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">31</span>:<span class="number">24</span>],sb12out);</div><div class="line">sbox  sbox13(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">23</span>:<span class="number">16</span>],sb13out);</div><div class="line">sbox  sbox14(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">15</span>:<span class="number">8</span>],sb14out);</div><div class="line">sbox  sbox15(clk,wrsben,wrsbaddr,sbdata,outtxt[<span class="number">7</span>:<span class="number">0</span>],sb15out);</div><div class="line">mux21_8  mux21_8_0(mixsel,sb0out,e0,f0);</div><div class="line">mux21_8  mux21_8_1(mixsel,sb1out,e1,f1);</div><div class="line">mux21_8  mux21_8_2(mixsel,sb2out,e2,f2);</div><div class="line">mux21_8  mux21_8_3(mixsel,sb3out,e3,f3);</div><div class="line">mux21_8  mux21_8_4(mixsel,sb4out,e4,f4);</div><div class="line">mux21_8  mux21_8_5(mixsel,sb5out,e5,f5);</div><div class="line">mux21_8  mux21_8_6(mixsel,sb6out,e6,f6);</div><div class="line">mux21_8  mux21_8_7(mixsel,sb7out,e7,f7);</div><div class="line">mux21_8  mux21_8_8(mixsel,sb8out,e8,f8);</div><div class="line">mux21_8  mux21_8_9(mixsel,sb9out,e9,f9);</div><div class="line">mux21_8  mux21_8_10(mixsel,sb10out,e10,f10);</div><div class="line">mux21_8  mux21_8_11(mixsel,sb11out,e11,f11);</div><div class="line">mux21_8  mux21_8_12(mixsel,sb12out,e12,f12);</div><div class="line">mux21_8  mux21_8_13(mixsel,sb13out,e13,f13);</div><div class="line">mux21_8  mux21_8_14(mixsel,sb14out,e14,f14);</div><div class="line">mux21_8  mux21_8_15(mixsel,sb15out,e15,f15);</div><div class="line">byte0203 byte0203_0(f0,f002,f003);</div><div class="line">byte0203 byte0203_1(f1,f102,f103);</div><div class="line">byte0203 byte0203_2(f2,f202,f203);</div><div class="line">byte0203 byte0203_3(f3,f302,f303);</div><div class="line">byte0203 byte0203_4(f4,f402,f403);</div><div class="line">byte0203 byte0203_5(f5,f502,f503);</div><div class="line">byte0203 byte0203_6(f6,f602,f603);</div><div class="line">byte0203 byte0203_7(f7,f702,f703);</div><div class="line">byte0203 byte0203_8(f8,f802,f803);</div><div class="line">byte0203 byte0203_9(f9,f902,f903);</div><div class="line">byte0203 byte0203_10(f10,f1002,f1003);</div><div class="line">byte0203 byte0203_11(f11,f1102,f1103);</div><div class="line">byte0203 byte0203_12(f12,f1202,f1203);</div><div class="line">byte0203 byte0203_13(f13,f1302,f1303);</div><div class="line">byte0203 byte0203_14(f14,f1402,f1403);</div><div class="line">byte0203 byte0203_15(f15,f1502,f1503);</div><div class="line">byte9bde byte9bde_0(f0,f002,f003,f009,f00b,f00d,f00e);</div><div class="line">byte9bde byte9bde_1(f1,f102,f103,f109,f10b,f10d,f10e);</div><div class="line">byte9bde byte9bde_2(f2,f202,f203,f209,f20b,f20d,f20e);</div><div class="line">byte9bde byte9bde_3(f3,f302,f303,f309,f30b,f30d,f30e);</div><div class="line">byte9bde byte9bde_4(f4,f402,f403,f409,f40b,f40d,f40e);</div><div class="line">byte9bde byte9bde_5(f5,f502,f503,f509,f50b,f50d,f50e);</div><div class="line">byte9bde byte9bde_6(f6,f602,f603,f609,f60b,f60d,f60e);</div><div class="line">byte9bde byte9bde_7(f7,f702,f703,f709,f70b,f70d,f70e);</div><div class="line">byte9bde byte9bde_8(f8,f802,f803,f809,f80b,f80d,f80e);</div><div class="line">byte9bde byte9bde_9(f9,f902,f903,f909,f90b,f90d,f90e);</div><div class="line">byte9bde byte9bde_10(f10,f1002,f1003,f1009,f100b,f100d,f100e);</div><div class="line">byte9bde byte9bde_11(f11,f1102,f1103,f1109,f110b,f110d,f110e);</div><div class="line">byte9bde byte9bde_12(f12,f1202,f1203,f1209,f120b,f120d,f120e);</div><div class="line">byte9bde byte9bde_13(f13,f1302,f1303,f1309,f130b,f130d,f130e);</div><div class="line">byte9bde byte9bde_14(f14,f1402,f1403,f1409,f140b,f140d,f140e);</div><div class="line">byte9bde byte9bde_15(f15,f1502,f1503,f1509,f150b,f150d,f150e);</div><div class="line"><span class="keyword">assign</span> a0=f002^f503;</div><div class="line"><span class="keyword">assign</span> b0=sb10out^sb15out;</div><div class="line"><span class="keyword">assign</span> c0=a0^b0;</div><div class="line">mux41_8  mux41_8_0(keyadsel,intxt[<span class="number">127</span>:<span class="number">120</span>],c0,sb0out,sb0out,d0);</div><div class="line"><span class="keyword">assign</span> a1=sb0out^f502;</div><div class="line"><span class="keyword">assign</span> b1=f1003^sb15out;</div><div class="line"><span class="keyword">assign</span> c1=a1^b1;</div><div class="line">mux41_8  mux41_8_1(keyadsel,intxt[<span class="number">119</span>:<span class="number">112</span>],c1,sb5out,sb13out,d1);</div><div class="line"><span class="keyword">assign</span> a2=sb0out^sb5out;</div><div class="line"><span class="keyword">assign</span> b2=f1002^f1503;</div><div class="line"><span class="keyword">assign</span> c2=a2^b2;</div><div class="line">mux41_8  mux41_8_2(keyadsel,intxt[<span class="number">111</span>:<span class="number">104</span>],c2,sb10out,sb10out,d2);</div><div class="line"><span class="keyword">assign</span> a3=f003^sb5out;</div><div class="line"><span class="keyword">assign</span> b3=sb10out^f1502;</div><div class="line"><span class="keyword">assign</span> c3=a3^b3;</div><div class="line">mux41_8  mux41_8_3(keyadsel,intxt[<span class="number">103</span>:<span class="number">96</span>],c3,sb15out,sb7out,d3);</div><div class="line"><span class="keyword">assign</span> a4=f402^f903;</div><div class="line"><span class="keyword">assign</span> b4=sb14out^sb3out;</div><div class="line"><span class="keyword">assign</span> c4=a4^b4;</div><div class="line">mux41_8  mux41_8_4(keyadsel,intxt[<span class="number">95</span>:<span class="number">88</span>],c4,sb4out,sb4out,d4);</div><div class="line"><span class="keyword">assign</span> a5=sb4out^f902;</div><div class="line"><span class="keyword">assign</span> b5=f1403^sb3out;</div><div class="line"><span class="keyword">assign</span> c5=a5^b5;</div><div class="line">mux41_8  mux41_8_5(keyadsel,intxt[<span class="number">87</span>:<span class="number">80</span>],c5,sb9out,sb1out,d5);</div><div class="line"><span class="keyword">assign</span> a6=sb4out^sb9out;</div><div class="line"><span class="keyword">assign</span> b6=f1402^f303;</div><div class="line"><span class="keyword">assign</span> c6=a6^b6;</div><div class="line">mux41_8  mux41_8_6(keyadsel,intxt[<span class="number">79</span>:<span class="number">72</span>],c6,sb14out,sb14out,d6);</div><div class="line"><span class="keyword">assign</span> a7=f403^sb9out;</div><div class="line"><span class="keyword">assign</span> b7=sb14out^f302;</div><div class="line"><span class="keyword">assign</span> c7=a7^b7;</div><div class="line">mux41_8  mux41_8_7(keyadsel,intxt[<span class="number">71</span>:<span class="number">64</span>],c7,sb3out,sb11out,d7);</div><div class="line"><span class="keyword">assign</span> a8=f802^f1303;</div><div class="line"><span class="keyword">assign</span> b8=sb2out^sb7out;</div><div class="line"><span class="keyword">assign</span> c8=a8^b8;</div><div class="line">mux41_8  mux41_8_8(keyadsel,intxt[<span class="number">63</span>:<span class="number">56</span>],c8,sb8out,sb8out,d8);</div><div class="line"><span class="keyword">assign</span> a9=sb8out^f1302;</div><div class="line"><span class="keyword">assign</span> b9=f203^sb7out;</div><div class="line"><span class="keyword">assign</span> c9=a9^b9;</div><div class="line">mux41_8  mux41_8_9(keyadsel,intxt[<span class="number">55</span>:<span class="number">48</span>],c9,sb13out,sb5out,d9);</div><div class="line"><span class="keyword">assign</span> a10=sb8out^sb13out;</div><div class="line"><span class="keyword">assign</span> b10=f202^f703;</div><div class="line"><span class="keyword">assign</span> c10=a10^b10;</div><div class="line">mux41_8  mux41_8_10(keyadsel,intxt[<span class="number">47</span>:<span class="number">40</span>],c10,sb2out,sb2out,d10);</div><div class="line"><span class="keyword">assign</span> a11=f803^sb13out;</div><div class="line"><span class="keyword">assign</span> b11=sb2out^f702;</div><div class="line"><span class="keyword">assign</span> c11=a11^b11;</div><div class="line">mux41_8  mux41_8_11(keyadsel,intxt[<span class="number">39</span>:<span class="number">32</span>],c11,sb7out,sb15out,d11);</div><div class="line"><span class="keyword">assign</span> a12=f1202^f103;</div><div class="line"><span class="keyword">assign</span> b12=sb6out^sb11out;</div><div class="line"><span class="keyword">assign</span> c12=a12^b12;</div><div class="line">mux41_8  mux41_8_12(keyadsel,intxt[<span class="number">31</span>:<span class="number">24</span>],c12,sb12out,sb12out,d12);</div><div class="line"><span class="keyword">assign</span> a13=sb12out^f102;</div><div class="line"><span class="keyword">assign</span> b13=f603^sb11out;</div><div class="line"><span class="keyword">assign</span> c13=a13^b13;</div><div class="line">mux41_8  mux41_8_13(keyadsel,intxt[<span class="number">23</span>:<span class="number">16</span>],c13,sb1out,sb9out,d13);</div><div class="line"><span class="keyword">assign</span> a14=sb12out^sb1out;</div><div class="line"><span class="keyword">assign</span> b14=f602^f1103;</div><div class="line"><span class="keyword">assign</span> c14=a14^b14;</div><div class="line">mux41_8  mux41_8_14(keyadsel,intxt[<span class="number">15</span>:<span class="number">8</span>],c14,sb6out,sb6out,d14);</div><div class="line"><span class="keyword">assign</span> a15=f1203^sb1out;</div><div class="line"><span class="keyword">assign</span> b15=sb6out^f1102;</div><div class="line"><span class="keyword">assign</span> c15=a15^b15;</div><div class="line">mux41_8  mux41_8_15(keyadsel,intxt[<span class="number">7</span>:<span class="number">0</span>],c15,sb11out,sb3out,d15);</div><div class="line"><span class="keyword">assign</span> d=&#123;d0,d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,d11,d12,d13,d14,d15&#125;;</div><div class="line"><span class="keyword">assign</span> e=&#123;e0,e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15&#125;;</div><div class="line"><span class="keyword">assign</span> g=&#123;g0,g1,g2,g3,g4,g5,g6,g7,g8,g9,g10,g11,g12,g13,g14,g15&#125;;</div><div class="line"><span class="keyword">assign</span> e=d^roundkey;</div><div class="line"><span class="keyword">assign</span> i0=f00e^f10b;</div><div class="line"><span class="keyword">assign</span> j0=f20d^f309;</div><div class="line"><span class="keyword">assign</span> g0=i0^j0;</div><div class="line"><span class="keyword">assign</span> i1=f009^f10e;</div><div class="line"><span class="keyword">assign</span> j1=f20b^f30d;</div><div class="line"><span class="keyword">assign</span> g1=i1^j1;</div><div class="line"><span class="keyword">assign</span> i2=f00d^f109;</div><div class="line"><span class="keyword">assign</span> j2=f20e^f30b;</div><div class="line"><span class="keyword">assign</span> g2=i2^j2;</div><div class="line"><span class="keyword">assign</span> i3=f00b^f10d;</div><div class="line"><span class="keyword">assign</span> j3=f209^f30e;</div><div class="line"><span class="keyword">assign</span> g3=i3^j3;</div><div class="line"><span class="keyword">assign</span> i4=f40e^f50b;</div><div class="line"><span class="keyword">assign</span> j4=f60d^f709;</div><div class="line"><span class="keyword">assign</span> g4=i4^j4;</div><div class="line"><span class="keyword">assign</span> i5=f409^f50e;</div><div class="line"><span class="keyword">assign</span> j5=f60b^f70d;</div><div class="line"><span class="keyword">assign</span> g5=i5^j5;</div><div class="line"><span class="keyword">assign</span> i6=f40d^f509;</div><div class="line"><span class="keyword">assign</span> j6=f60e^f70b;</div><div class="line"><span class="keyword">assign</span> g6=i6^j6;</div><div class="line"><span class="keyword">assign</span> i7=f40b^f50d;</div><div class="line"><span class="keyword">assign</span> j7=f609^f70e;</div><div class="line"><span class="keyword">assign</span> g7=i7^j7;</div><div class="line"><span class="keyword">assign</span> i8=f80e^f90b;</div><div class="line"><span class="keyword">assign</span> j8=f100d^f1109;</div><div class="line"><span class="keyword">assign</span> g8=i8^j8;</div><div class="line"><span class="keyword">assign</span> i9=f809^f90e;</div><div class="line"><span class="keyword">assign</span> j9=f100b^f110d;</div><div class="line"><span class="keyword">assign</span> g9=i9^j9;</div><div class="line"><span class="keyword">assign</span> i10=f80d^f909;</div><div class="line"><span class="keyword">assign</span> j10=f100e^f110b;</div><div class="line"><span class="keyword">assign</span> g10=i10^j10;</div><div class="line"><span class="keyword">assign</span> i11=f80b^f90d;</div><div class="line"><span class="keyword">assign</span> j11=f1009^f110e;</div><div class="line"><span class="keyword">assign</span> g11=i11^j11;</div><div class="line"><span class="keyword">assign</span> i12=f120e^f130b;</div><div class="line"><span class="keyword">assign</span> j12=f140d^f1509;</div><div class="line"><span class="keyword">assign</span> g12=i12^j12;</div><div class="line"><span class="keyword">assign</span> i13=f1209^f130e;</div><div class="line"><span class="keyword">assign</span> j13=f140b^f150d;</div><div class="line"><span class="keyword">assign</span> g13=i13^j13;</div><div class="line"><span class="keyword">assign</span> i14=f120d^f1309;</div><div class="line"><span class="keyword">assign</span> j14=f140e^f150b;</div><div class="line"><span class="keyword">assign</span> g14=i14^j14;</div><div class="line"><span class="keyword">assign</span> i15=f120b^f130d;</div><div class="line"><span class="keyword">assign</span> j15=f1409^f150e;</div><div class="line"><span class="keyword">assign</span> g15=i15^j15;</div><div class="line">mux21_128  mux21_128_0(reginsel,e,g,h);</div><div class="line">reg_128 resultreg(clk,wrregen,h,outtxt);</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> sbox(clk,write,wr_addr,din,rd_addr,dout);</div><div class="line"><span class="keyword">input</span> clk;</div><div class="line"><span class="keyword">input</span> write;</div><div class="line"><span class="keyword">input</span> [<span class="number">3</span>:<span class="number">0</span>] wr_addr;</div><div class="line"><span class="keyword">input</span> [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"><span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] rd_addr;</div><div class="line"><span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">reg</span> [<span class="number">15</span>:<span class="number">0</span>] decout;</div><div class="line"><span class="keyword">wire</span> [<span class="number">15</span>:<span class="number">0</span>] write_reg;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] reg0out,reg1out,reg2out,reg3out,reg4out,reg5out,reg6out,reg7out,reg8out,reg9out,reg10out,reg11out,reg12out,reg13out,reg14out,reg15out;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">always</span> @ (wr_addr)</div><div class="line">  <span class="keyword">case</span>(wr_addr)</div><div class="line">    <span class="number">4'd0</span>: decout=<span class="number">16'b0000_0000_0000_0001</span>;</div><div class="line">    <span class="number">4'd1</span>: decout=<span class="number">16'b0000_0000_0000_0010</span>;</div><div class="line">    <span class="number">4'd2</span>: decout=<span class="number">16'b0000_0000_0000_0100</span>;</div><div class="line">    <span class="number">4'd3</span>: decout=<span class="number">16'b0000_0000_0000_1000</span>;</div><div class="line">    <span class="number">4'd4</span>: decout=<span class="number">16'b0000_0000_0001_0000</span>;</div><div class="line">    <span class="number">4'd5</span>: decout=<span class="number">16'b0000_0000_0010_0000</span>;</div><div class="line">    <span class="number">4'd6</span>: decout=<span class="number">16'b0000_0000_0100_0000</span>;</div><div class="line">    <span class="number">4'd7</span>: decout=<span class="number">16'b0000_0000_1000_0000</span>;</div><div class="line">    <span class="number">4'd8</span>: decout=<span class="number">16'b0000_0001_0000_0000</span>;</div><div class="line">    <span class="number">4'd9</span>: decout=<span class="number">16'b0000_0010_0000_0000</span>;</div><div class="line">    <span class="number">4'd10</span>: decout=<span class="number">16'b0000_0100_0000_0000</span>;</div><div class="line">    <span class="number">4'd11</span>: decout=<span class="number">16'b0000_1000_0000_0000</span>;</div><div class="line">    <span class="number">4'd12</span>: decout=<span class="number">16'b0001_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd13</span>: decout=<span class="number">16'b0010_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd14</span>: decout=<span class="number">16'b0100_0000_0000_0000</span>;</div><div class="line">    <span class="number">4'd15</span>: decout=<span class="number">16'b1000_0000_0000_0000</span>;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">assign</span> write_reg=decout &amp; &#123;write,write,write,write,write,write,write,write,write,write,write,write,write,write,write,write&#125;;</div><div class="line"></div><div class="line">reg_128 reg0(clk,write_reg[<span class="number">0</span>],din,reg0out);</div><div class="line">reg_128 reg1(clk,write_reg[<span class="number">1</span>],din,reg1out);</div><div class="line">reg_128 reg2(clk,write_reg[<span class="number">2</span>],din,reg2out);</div><div class="line">reg_128 reg3(clk,write_reg[<span class="number">3</span>],din,reg3out);</div><div class="line">reg_128 reg4(clk,write_reg[<span class="number">4</span>],din,reg4out);</div><div class="line">reg_128 reg5(clk,write_reg[<span class="number">5</span>],din,reg5out);</div><div class="line">reg_128 reg6(clk,write_reg[<span class="number">6</span>],din,reg6out);</div><div class="line">reg_128 reg7(clk,write_reg[<span class="number">7</span>],din,reg7out);</div><div class="line">reg_128 reg8(clk,write_reg[<span class="number">8</span>],din,reg8out);</div><div class="line">reg_128 reg9(clk,write_reg[<span class="number">9</span>],din,reg9out);</div><div class="line">reg_128 reg10(clk,write_reg[<span class="number">10</span>],din,reg10out);</div><div class="line">reg_128 reg11(clk,write_reg[<span class="number">11</span>],din,reg11out);</div><div class="line">reg_128 reg12(clk,write_reg[<span class="number">12</span>],din,reg12out);</div><div class="line">reg_128 reg13(clk,write_reg[<span class="number">13</span>],din,reg13out);</div><div class="line">reg_128 reg14(clk,write_reg[<span class="number">14</span>],din,reg14out);</div><div class="line">reg_128 reg15(clk,write_reg[<span class="number">15</span>],din,reg15out);</div><div class="line"><span class="keyword">always</span> @(rd_addr <span class="keyword">or</span> reg0out <span class="keyword">or</span> reg1out <span class="keyword">or</span> reg2out <span class="keyword">or</span> reg3out <span class="keyword">or</span> reg4out <span class="keyword">or</span> reg5out <span class="keyword">or</span> reg6out <span class="keyword">or</span> reg7out <span class="keyword">or</span> reg8out <span class="keyword">or</span> reg9out <span class="keyword">or</span> reg10out <span class="keyword">or</span> reg11out <span class="keyword">or</span> reg12out <span class="keyword">or</span> reg13out <span class="keyword">or</span> reg14out <span class="keyword">or</span> reg15out)</div><div class="line">  <span class="keyword">case</span>(rd_addr)</div><div class="line">    <span class="number">8'd0</span>: dout=reg0out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd1</span>: dout=reg0out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd2</span>: dout=reg0out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd3</span>: dout=reg0out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd4</span>: dout=reg0out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd5</span>: dout=reg0out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd6</span>: dout=reg0out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd7</span>: dout=reg0out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd8</span>: dout=reg0out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd9</span>: dout=reg0out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd10</span>: dout=reg0out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd11</span>: dout=reg0out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd12</span>: dout=reg0out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd13</span>: dout=reg0out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd14</span>: dout=reg0out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd15</span>: dout=reg0out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd16</span>: dout=reg1out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd17</span>: dout=reg1out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd18</span>: dout=reg1out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd19</span>: dout=reg1out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd20</span>: dout=reg1out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd21</span>: dout=reg1out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd22</span>: dout=reg1out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd23</span>: dout=reg1out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd24</span>: dout=reg1out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd25</span>: dout=reg1out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd26</span>: dout=reg1out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd27</span>: dout=reg1out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd28</span>: dout=reg1out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd29</span>: dout=reg1out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd30</span>: dout=reg1out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd31</span>: dout=reg1out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd32</span>: dout=reg2out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd33</span>: dout=reg2out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd34</span>: dout=reg2out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd35</span>: dout=reg2out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd36</span>: dout=reg2out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd37</span>: dout=reg2out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd38</span>: dout=reg2out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd39</span>: dout=reg2out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd40</span>: dout=reg2out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd41</span>: dout=reg2out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd42</span>: dout=reg2out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd43</span>: dout=reg2out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd44</span>: dout=reg2out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd45</span>: dout=reg2out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd46</span>: dout=reg2out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd47</span>: dout=reg2out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd48</span>: dout=reg3out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd49</span>: dout=reg3out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd50</span>: dout=reg3out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd51</span>: dout=reg3out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd52</span>: dout=reg3out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd53</span>: dout=reg3out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd54</span>: dout=reg3out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd55</span>: dout=reg3out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd56</span>: dout=reg3out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd57</span>: dout=reg3out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd58</span>: dout=reg3out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd59</span>: dout=reg3out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd60</span>: dout=reg3out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd61</span>: dout=reg3out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd62</span>: dout=reg3out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd63</span>: dout=reg3out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd64</span>: dout=reg4out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd65</span>: dout=reg4out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd66</span>: dout=reg4out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd67</span>: dout=reg4out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd68</span>: dout=reg4out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd69</span>: dout=reg4out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd70</span>: dout=reg4out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd71</span>: dout=reg4out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd72</span>: dout=reg4out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd73</span>: dout=reg4out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd74</span>: dout=reg4out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd75</span>: dout=reg4out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd76</span>: dout=reg4out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd77</span>: dout=reg4out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd78</span>: dout=reg4out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd79</span>: dout=reg4out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd80</span>: dout=reg5out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd81</span>: dout=reg5out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd82</span>: dout=reg5out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd83</span>: dout=reg5out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd84</span>: dout=reg5out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd85</span>: dout=reg5out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd86</span>: dout=reg5out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd87</span>: dout=reg5out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd88</span>: dout=reg5out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd89</span>: dout=reg5out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd90</span>: dout=reg5out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd91</span>: dout=reg5out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd92</span>: dout=reg5out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd93</span>: dout=reg5out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd94</span>: dout=reg5out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd95</span>: dout=reg5out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd96</span>: dout=reg6out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd97</span>: dout=reg6out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd98</span>: dout=reg6out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd99</span>: dout=reg6out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd100</span>: dout=reg6out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd101</span>: dout=reg6out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd102</span>: dout=reg6out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd103</span>: dout=reg6out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd104</span>: dout=reg6out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd105</span>: dout=reg6out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd106</span>: dout=reg6out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd107</span>: dout=reg6out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd108</span>: dout=reg6out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd109</span>: dout=reg6out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd110</span>: dout=reg6out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd111</span>: dout=reg6out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd112</span>: dout=reg7out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd113</span>: dout=reg7out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd114</span>: dout=reg7out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd115</span>: dout=reg7out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd116</span>: dout=reg7out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd117</span>: dout=reg7out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd118</span>: dout=reg7out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd119</span>: dout=reg7out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd120</span>: dout=reg7out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd121</span>: dout=reg7out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd122</span>: dout=reg7out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd123</span>: dout=reg7out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd124</span>: dout=reg7out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd125</span>: dout=reg7out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd126</span>: dout=reg7out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd127</span>: dout=reg7out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd128</span>: dout=reg8out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd129</span>: dout=reg8out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd130</span>: dout=reg8out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd131</span>: dout=reg8out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd132</span>: dout=reg8out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd133</span>: dout=reg8out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd134</span>: dout=reg8out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd135</span>: dout=reg8out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd136</span>: dout=reg8out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd137</span>: dout=reg8out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd138</span>: dout=reg8out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd139</span>: dout=reg8out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd140</span>: dout=reg8out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd141</span>: dout=reg8out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd142</span>: dout=reg8out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd143</span>: dout=reg8out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd144</span>: dout=reg9out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd145</span>: dout=reg9out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd146</span>: dout=reg9out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd147</span>: dout=reg9out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd148</span>: dout=reg9out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd149</span>: dout=reg9out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd150</span>: dout=reg9out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd151</span>: dout=reg9out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd152</span>: dout=reg9out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd153</span>: dout=reg9out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd154</span>: dout=reg9out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd155</span>: dout=reg9out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd156</span>: dout=reg9out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd157</span>: dout=reg9out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd158</span>: dout=reg9out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd159</span>: dout=reg9out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd160</span>: dout=reg10out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd161</span>: dout=reg10out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd162</span>: dout=reg10out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd163</span>: dout=reg10out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd164</span>: dout=reg10out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd165</span>: dout=reg10out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd166</span>: dout=reg10out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd167</span>: dout=reg10out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd168</span>: dout=reg10out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd169</span>: dout=reg10out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd170</span>: dout=reg10out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd171</span>: dout=reg10out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd172</span>: dout=reg10out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd173</span>: dout=reg10out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd174</span>: dout=reg10out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd175</span>: dout=reg10out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd176</span>: dout=reg11out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd177</span>: dout=reg11out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd178</span>: dout=reg11out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd179</span>: dout=reg11out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd180</span>: dout=reg11out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd181</span>: dout=reg11out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd182</span>: dout=reg11out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd183</span>: dout=reg11out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd184</span>: dout=reg11out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd185</span>: dout=reg11out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd186</span>: dout=reg11out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd187</span>: dout=reg11out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd188</span>: dout=reg11out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd189</span>: dout=reg11out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd190</span>: dout=reg11out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd191</span>: dout=reg11out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd192</span>: dout=reg12out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd193</span>: dout=reg12out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd194</span>: dout=reg12out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd195</span>: dout=reg12out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd196</span>: dout=reg12out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd197</span>: dout=reg12out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd198</span>: dout=reg12out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd199</span>: dout=reg12out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd200</span>: dout=reg12out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd201</span>: dout=reg12out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd202</span>: dout=reg12out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd203</span>: dout=reg12out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd204</span>: dout=reg12out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd205</span>: dout=reg12out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd206</span>: dout=reg12out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd207</span>: dout=reg12out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd208</span>: dout=reg13out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd209</span>: dout=reg13out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd210</span>: dout=reg13out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd211</span>: dout=reg13out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd212</span>: dout=reg13out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd213</span>: dout=reg13out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd214</span>: dout=reg13out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd215</span>: dout=reg13out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd216</span>: dout=reg13out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd217</span>: dout=reg13out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd218</span>: dout=reg13out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd219</span>: dout=reg13out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd220</span>: dout=reg13out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd221</span>: dout=reg13out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd222</span>: dout=reg13out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd223</span>: dout=reg13out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd224</span>: dout=reg14out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd225</span>: dout=reg14out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd226</span>: dout=reg14out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd227</span>: dout=reg14out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd228</span>: dout=reg14out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd229</span>: dout=reg14out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd230</span>: dout=reg14out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd231</span>: dout=reg14out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd232</span>: dout=reg14out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd233</span>: dout=reg14out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd234</span>: dout=reg14out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd235</span>: dout=reg14out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd236</span>: dout=reg14out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd237</span>: dout=reg14out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd238</span>: dout=reg14out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd239</span>: dout=reg14out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line"></div><div class="line">    <span class="number">8'd240</span>: dout=reg15out[<span class="number">127</span>:<span class="number">120</span>];</div><div class="line">    <span class="number">8'd241</span>: dout=reg15out[<span class="number">119</span>:<span class="number">112</span>];</div><div class="line">    <span class="number">8'd242</span>: dout=reg15out[<span class="number">111</span>:<span class="number">104</span>];</div><div class="line">    <span class="number">8'd243</span>: dout=reg15out[<span class="number">103</span>:<span class="number">96</span>];</div><div class="line">    <span class="number">8'd244</span>: dout=reg15out[<span class="number">95</span>:<span class="number">88</span>];</div><div class="line">    <span class="number">8'd245</span>: dout=reg15out[<span class="number">87</span>:<span class="number">80</span>];</div><div class="line">    <span class="number">8'd246</span>: dout=reg15out[<span class="number">79</span>:<span class="number">72</span>];</div><div class="line">    <span class="number">8'd247</span>: dout=reg15out[<span class="number">71</span>:<span class="number">64</span>];</div><div class="line">    <span class="number">8'd248</span>: dout=reg15out[<span class="number">63</span>:<span class="number">56</span>];</div><div class="line">    <span class="number">8'd249</span>: dout=reg15out[<span class="number">55</span>:<span class="number">48</span>];</div><div class="line">    <span class="number">8'd250</span>: dout=reg15out[<span class="number">47</span>:<span class="number">40</span>];</div><div class="line">    <span class="number">8'd251</span>: dout=reg15out[<span class="number">39</span>:<span class="number">32</span>];</div><div class="line">    <span class="number">8'd252</span>: dout=reg15out[<span class="number">31</span>:<span class="number">24</span>];</div><div class="line">    <span class="number">8'd253</span>: dout=reg15out[<span class="number">23</span>:<span class="number">16</span>];</div><div class="line">    <span class="number">8'd254</span>: dout=reg15out[<span class="number">15</span>:<span class="number">8</span>];</div><div class="line">    <span class="number">8'd255</span>: dout=reg15out[<span class="number">7</span>:<span class="number">0</span>];</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_8(sel,a,b,c);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">1'b0</span>: c=a;</div><div class="line">    <span class="number">1'b1</span>: c=b;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte0203(a,a02,a03);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a02,a03;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] b,c;</div><div class="line"><span class="keyword">assign</span> b=&#123;a[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1'b0</span>&#125;;</div><div class="line"><span class="keyword">assign</span> c=b^&#123;<span class="number">8'h1b</span>&#125;;</div><div class="line"><span class="keyword">assign</span> a02=(a[<span class="number">7</span>]==<span class="number">0</span>)? b:c;</div><div class="line"><span class="keyword">assign</span> a03=a02^a;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte9bde(a,a02,a03,a09,a0b,a0d,a0e);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a09,a0b,a0d,a0e;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,a02,a03;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] a04,a08,b,c;</div><div class="line">byte02  byte02_0(a02,a04);</div><div class="line">byte02  byte02_1(a04,a08);</div><div class="line"><span class="keyword">assign</span> a09=a08^a;</div><div class="line"><span class="keyword">assign</span> a0b=a08^a03;</div><div class="line"><span class="keyword">assign</span> b=a04^a;</div><div class="line"><span class="keyword">assign</span> c=a04^a02;</div><div class="line"><span class="keyword">assign</span> a0d=a08^b;</div><div class="line"><span class="keyword">assign</span> a0e=a08^c;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> byte02(a,a02);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] a02;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a;</div><div class="line"><span class="keyword">wire</span> [<span class="number">7</span>:<span class="number">0</span>] b,c;</div><div class="line"><span class="keyword">assign</span> b=&#123;a[<span class="number">6</span>:<span class="number">0</span>],<span class="number">1'b0</span>&#125;;</div><div class="line"><span class="keyword">assign</span> c=b^&#123;<span class="number">8'h1b</span>&#125;;</div><div class="line"><span class="keyword">assign</span> a02=(a[<span class="number">7</span>]==<span class="number">0</span>)? b:c;</div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux41_8(sel,a,b,c,d,e);</div><div class="line"><span class="keyword">output</span>[<span class="number">7</span>:<span class="number">0</span>] e;</div><div class="line"><span class="keyword">input</span>[<span class="number">7</span>:<span class="number">0</span>] a,b,c,d;</div><div class="line"><span class="keyword">input</span> [<span class="number">1</span>:<span class="number">0</span>] sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] e;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b <span class="keyword">or</span> c <span class="keyword">or</span> d)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">2'b00</span>: e=a;</div><div class="line">    <span class="number">2'b01</span>: e=b;</div><div class="line">    <span class="number">2'b10</span>: e=c;</div><div class="line">    <span class="number">2'b11</span>: e=d;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">module</span> mux21_128(sel,a,b,c);</div><div class="line"><span class="keyword">output</span>[<span class="number">127</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">input</span>[<span class="number">127</span>:<span class="number">0</span>] a,b;</div><div class="line"><span class="keyword">input</span> sel;</div><div class="line"><span class="keyword">reg</span> [<span class="number">127</span>:<span class="number">0</span>] c;</div><div class="line"><span class="keyword">always</span>@(sel <span class="keyword">or</span> a <span class="keyword">or</span> b)</div><div class="line">  <span class="keyword">case</span>(sel)</div><div class="line">    <span class="number">1'b0</span>: c=a;</div><div class="line">    <span class="number">1'b1</span>: c=b;</div><div class="line">  <span class="keyword">endcase</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<p><strong>2、建立QuartusII工程，将第1步建立的AES密码处理器的Verilog RTL模型中的全部Verilog文件添加到工程中。</strong></p>
<p><strong>3、设定约束条件，包括……</strong></p>
<p><strong>4、执行全编译，……</strong></p>
<p><strong>5、查看资源占用报告、时序分析报告、……,并进行分析。</strong></p>
<p><strong>6、若电路规模、性能达不到预期目标，则修改约束条件，重新执行编译。</strong></p>
<p><strong>7、进行时序仿真，设计AES密码处理器的测试文件。</strong><br><figure class="highlight verilog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"><span class="meta">`<span class="meta-keyword">timescale</span> 1ns / 1ns</span></div><div class="line"><span class="keyword">module</span> aes_tb;</div><div class="line"><span class="keyword">wire</span> [<span class="number">127</span>:<span class="number">0</span>] dout;</div><div class="line"><span class="keyword">wire</span> keyexprdy,encdecrdy;</div><div class="line"><span class="keyword">reg</span>  clk,rst,load,keyexpen,staenc,stadec;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">4</span>:<span class="number">0</span>] address;</div><div class="line"><span class="keyword">reg</span>  [<span class="number">127</span>:<span class="number">0</span>] din;</div><div class="line"></div><div class="line">aes  aes(clk,rst,load,address,keyexpen,staenc,stadec,</div><div class="line">din,keyexprdy,encdecrdy,dout);</div><div class="line"></div><div class="line"><span class="comment">//clock generation</span></div><div class="line"><span class="keyword">initial</span> clk = <span class="number">1</span>;</div><div class="line"><span class="keyword">always</span> #<span class="number">50</span> clk = ~clk;</div><div class="line"></div><div class="line"><span class="keyword">initial</span></div><div class="line">    <span class="keyword">begin</span></div><div class="line">        #<span class="number">20</span>  rst=<span class="number">1</span>;        <span class="comment">//reset.</span></div><div class="line"></div><div class="line">        #<span class="number">200</span> rst=<span class="number">0</span>;        <span class="comment">//load key.</span></div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>;</div><div class="line">             din=<span class="number">128'h2b7e1516_28aed2a6_abf71588_09cf4f3c</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexpen=<span class="number">1</span>;   <span class="comment">//key expansion.</span></div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> rst=<span class="number">0</span>;</div><div class="line">             load=<span class="number">0</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">        #<span class="number">1000</span> rst=<span class="number">0</span>;       <span class="comment">//encryption sbox configuration.</span></div><div class="line">             load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd0</span>;</div><div class="line">             din=<span class="number">128'h637c777bf26b6fc53001672bfed7ab76</span>;</div><div class="line">             keyexpen=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">0</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd1</span>;</div><div class="line">             din=<span class="number">128'hca82c97dfa5947f0add4a2af9ca472c0</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd2</span>;</div><div class="line">             din=<span class="number">128'hb7fd9326363ff7cc34a5e5f171d83115</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd3</span>;</div><div class="line">             din=<span class="number">128'h04c723c31896059a071280e2eb27b275</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd4</span>;</div><div class="line">             din=<span class="number">128'h09832c1a1b6e5aa0523bd6b329e32f84</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd5</span>;</div><div class="line">             din=<span class="number">128'h53d100ed20fcb15b6acbbe394a4c58cf</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd6</span>;</div><div class="line">             din=<span class="number">128'hd0efaafb434d338545f9027f503c9fa8</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd7</span>;</div><div class="line">             din=<span class="number">128'h51a3408f929d38f5bcb6da2110fff3d2</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd8</span>;</div><div class="line">             din=<span class="number">128'hcd0c13ec5f974417c4a77e3d645d1973</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd9</span>;</div><div class="line">             din=<span class="number">128'h60814fdc222a908846eeb814de5e0bdb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd10</span>;</div><div class="line">             din=<span class="number">128'he0323a0a4906245cc2d3ac629195e479</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd11</span>;</div><div class="line">             din=<span class="number">128'he7c8376d8dd54ea96c56f4ea657aae08</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd12</span>;</div><div class="line">             din=<span class="number">128'hba78252e1ca6b4c6e8dd741f4bbd8b8a</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd13</span>;</div><div class="line">             din=<span class="number">128'h703eb5664803f60e613557b986c11d9e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd14</span>;</div><div class="line">             din=<span class="number">128'he1f8981169d98e949b1e87e9ce5528df</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd15</span>;</div><div class="line">             din=<span class="number">128'h8ca1890dbfe6426841992d0fb054bb16</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>; <span class="comment">//load plain text.</span></div><div class="line">            din=<span class="number">128'h3243f6a8_885a308d_313198a2_e0370734</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">0</span>;</div><div class="line">             staenc=<span class="number">1</span>;   <span class="comment">// start encryption.</span></div><div class="line"></div><div class="line">        #<span class="number">100</span> staenc=<span class="number">0</span>;</div><div class="line">        #<span class="number">1200</span> load=<span class="number">1</span>;   <span class="comment">//decryption sbox configuration.</span></div><div class="line">              address=<span class="number">5'd0</span>;</div><div class="line">              din=<span class="number">128'h52096ad53036a538bf40a39e81f3d7fb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd1</span>;</div><div class="line">             din=<span class="number">128'h7ce339829b2fff87348e4344c4dee9cb</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd2</span>;</div><div class="line">             din=<span class="number">128'h547b9432a6c2233dee4c950b42fac34e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd3</span>;</div><div class="line">             din=<span class="number">128'h082ea16628d924b2765ba2496d8bd125</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd4</span>;</div><div class="line">             din=<span class="number">128'h72f8f66486689816d4a45ccc5d65b692</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd5</span>;</div><div class="line">             din=<span class="number">128'h6c704850fdedb9da5e154657a78d9d84</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd6</span>;</div><div class="line">             din=<span class="number">128'h90d8ab008cbcd30af7e45805b8b34506</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd7</span>;</div><div class="line">             din=<span class="number">128'hd02c1e8fca3f0f02c1afbd0301138a6b</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd8</span>;</div><div class="line">             din=<span class="number">128'h3a9111414f67dcea97f2cfcef0b4e673</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd9</span>;</div><div class="line">             din=<span class="number">128'h96ac7422e7ad3585e2f937e81c75df6e</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd10</span>;</div><div class="line">             din=<span class="number">128'h47f11a711d29c5896fb7620eaa18be1b</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd11</span>;</div><div class="line">             din=<span class="number">128'hfc563e4bc6d279209adbc0fe78cd5af4</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd12</span>;</div><div class="line">             din=<span class="number">128'h1fdda8338807c731b11210592780ec5f</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd13</span>;</div><div class="line">             din=<span class="number">128'h60517fa919b54a0d2de57a9f93c99cef</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd14</span>;</div><div class="line">             din=<span class="number">128'ha0e03b4dae2af5b0c8ebbb3c83539961</span>;</div><div class="line">        #<span class="number">100</span> address=<span class="number">5'd15</span>;</div><div class="line">             din=<span class="number">128'h172b047eba77d626e169146355210c7d</span>;</div><div class="line"></div><div class="line">        #<span class="number">100</span> load=<span class="number">1</span>;</div><div class="line">             address=<span class="number">5'd16</span>; <span class="comment">//load cipher text.</span></div><div class="line">             din=<span class="number">128'h3925841d_02dc09fb_dc118597_196a0b32</span>;</div><div class="line">        #<span class="number">100</span> load=<span class="number">0</span>;</div><div class="line">             stadec=<span class="number">1</span>;   <span class="comment">//start decryption.</span></div><div class="line">        #<span class="number">100</span> stadec=<span class="number">0</span>;</div><div class="line"></div><div class="line">      #<span class="number">1500</span> <span class="built_in">$finish</span>;</div><div class="line">    <span class="keyword">end</span></div><div class="line"><span class="keyword">endmodule</span></div></pre></td></tr></table></figure></p>
<h2 id="五、实验结果-4"><a href="#五、实验结果-4" class="headerlink" title="五、实验结果"></a>五、实验结果</h2><p><strong>1、电路规模和性能指标</strong></p>
<p><strong>2、时序仿真结果</strong><br>　　AES密码处理器时序仿真结果：<br><img src="/sourcefile/[O]VLSI设计之AES密码处理器/771.png" alt=""></p>
<h2 id="六、实验结论-4"><a href="#六、实验结论-4" class="headerlink" title="六、实验结论"></a>六、实验结论</h2><p>　　在前面几次的实验积累上整合了整个AES密码处理器的Verilog代码并先用Modelsim进行过综合验证，此次实验使用Quartusii对AES密码处理器进行整体综合与仿真，并对综合后的电路及其他数据进行分析，同时进行时序仿真，以验证AES密码处理器的正确性。<br>　　此次实验比较全面的整合了前面所学过的知识，并对Quartusii软件的操作进行了重温练习，并回顾各方面数据的分析方法。</p>
<p><br></p>
<blockquote>
<p>　　能看到这里的兄弟也是很不容易了….加油！未来的世界需要你！</p>
</blockquote>
<p>　</p>
<blockquote>
<p>　　附件1：<a href="/sourcefile/[O]VLSI设计之AES密码处理器/VHDL_AES_WholeCode.v">整体源码 - VHDL_AES_WholeCode.v</a><br>　　附件2：<a href="/sourcefile/[O]VLSI设计之AES密码处理器/第9章VLSI设计实例1—AES密码处理器设计.pdf">相关文档</a></p>
</blockquote>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://mengze.top/[O]VLSI设计之AES密码处理器/" title="【O】VLSI设计之AES密码处理器" target="_blank" rel="external">https://mengze.top/[O]VLSI设计之AES密码处理器/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本站所有文章除特别声明外，均遵循 <u><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a></u> 及 <u><a href="https://mengze.top/MZ-ATY_VCJS/" target="_blank" rel="external">MZ-ATY VCJS</a></u> 协议。转载请附上原文出处链接和本声明。
    </li>
  </ul>
</blockquote>

    </div>
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/[L]英语单词常见词缀/" title="【L】英语单词常见词缀"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/[K]Brenneman综合征/" title="【K】Brenneman综合征"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,qzone,wechat,douban,linkedin" data-mobile-sites="weibo,qq,qzone,wechat,douban,linkedin"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
    
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/AaronTYin" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/6148427895" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
        
        &copy; 2017-2020 <a href="https://mengze.top">MengZeATY</a>
        
        <div class="publishby">
            <p>Theme <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a> by <a href="https://github.com/cofess" target="_blank"> cofess </a><br>
            Hosted by <a href="https://pages.coding.me" style="font-weight: bold" rel="external nofollow">Coding Pages</a></p>
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.min.js"></script>
<script src="/js/application.js"></script>

    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>





   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   


  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    $('article img').not('[hidden]').not('.panel-body img').each(function() {
      var $image = $(this);
      var imageCaption = $image.attr('alt');
      var $imageWrapLink = $image.parent('a');
      if ($imageWrapLink.length < 1) {
        var src = this.getAttribute('src');
        var idx = src.lastIndexOf('?');
        if (idx != -1) {
          src = src.substring(0, idx);
        }
        $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
      }
      $imageWrapLink.attr('data-fancybox', 'images');
      if (imageCaption) {
        $imageWrapLink.attr('data-caption', imageCaption);
      }
    });
    $().fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
    });
  });
  </script>





</body>
</html>